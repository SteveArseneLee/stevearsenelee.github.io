+++
title = "Kafkaì˜ ë°ì´í„° êµ¬ì¡°"
draft = false
bookHidden = true
+++

Kafkaì˜ ë©”ì„¸ì§€ ì €ì¥ êµ¬ì¡°ëŠ” **ë…¼ë¦¬ì  êµ¬ì¡°**ì™€ **ë¬¼ë¦¬ì  êµ¬ì¡°**ë¡œ ë‚˜ëˆ ì„œ ìƒê°í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. KafkaëŠ” ë‹¨ìˆœí•œ message queueë¥¼ ë„˜ì–´ì„œ ***Log-structured Storage***ë¡œ ì„¤ê³„ë˜ì–´, ë©”ì„¸ì§€ì˜ ì €ì¥ ë° ì¡°íšŒ ë°©ì‹ì´ ì¼ë°˜ì ì¸ RDBMSë‚˜ ë‹¨ìˆœ queueing systemê³¼ëŠ” ë‹¤ë¥´ë‹¤.

### ë…¼ë¦¬ì  êµ¬ì¡°
```sh
Kafka Cluster
 â””â”€ Topic
     â””â”€ Partition (ë³µìˆ˜ ê°œ ê°€ëŠ¥)
         â””â”€ Offset ê¸°ë°˜ ë©”ì‹œì§€ ë¡œê·¸ (Append-Only)
```
ğŸ”¹ Topic
- ë…¼ë¦¬ì ì¸ ë©”ì‹œì§€ ìŠ¤íŠ¸ë¦¼ ë‹¨ìœ„ (ì˜ˆ: sensor-temperature, chat-logs ë“±)
- ì‹¤ì œ ì €ì¥ì€ partition ë‹¨ìœ„ë¡œ ì´ë£¨ì–´ì§

ğŸ”¹ Partition
- ë©”ì‹œì§€ì˜ ë³‘ë ¬ ì²˜ë¦¬ ë‹¨ìœ„
- ê° íŒŒí‹°ì…˜ì€ ë‚´ë¶€ì ìœ¼ë¡œ append-only logë¡œ êµ¬í˜„ë¨
- ê° ë©”ì‹œì§€ëŠ” Offsetì„ ê¸°ì¤€ìœ¼ë¡œ ìˆœì°¨ì ìœ¼ë¡œ ì €ì¥ë¨
- í•˜ë‚˜ì˜ íŒŒí‹°ì…˜ì€ í•œ ë²ˆì— í•˜ë‚˜ì˜ consumerì—ê²Œë§Œ í• ë‹¹ë¨ (Consumer Group ê¸°ì¤€)


### ë¬¼ë¦¬ì  êµ¬ì¡°
```sh
/log.dirs/<topic>-<partition>/
 â”œâ”€ 00000000000000000000.log
 â”œâ”€ 00000000000000000000.index
 â”œâ”€ 00000000000000000000.timeindex
 â”œâ”€ 00000000000000010000.log
 â”œâ”€ 00000000000000010000.index
 â”œâ”€ ...
```
ğŸ”¹ Segment (ì„¸ê·¸ë¨¼íŠ¸)
- íŒŒí‹°ì…˜ì€ ì‹¤ì œë¡œ ì—¬ëŸ¬ ê°œì˜ segment íŒŒì¼ë¡œ êµ¬ì„±ë¨
- ê¸°ë³¸ì ìœ¼ë¡œ log.segment.bytes ì„¤ì • (ê¸°ë³¸ê°’: 1GB)ë§ˆë‹¤ ìƒˆë¡œìš´ ì„¸ê·¸ë¨¼íŠ¸ íŒŒì¼ ìƒì„±
- Partitionë‹¹ ì˜¤ì§ í•˜ë‚˜ì˜ Segmentê°€ Active ë˜ì–´ ìˆìŒ
- ê° ì„¸ê·¸ë¨¼íŠ¸ëŠ” ë‹¤ìŒ 3ê°€ì§€ íŒŒì¼ë¡œ êµ¬ì„±ë¨:

|File name| Description|
|-|-|
|.log| ë©”ì„¸ì§€ ë³¸ë¬¸ì´ ì €ì¥ëœ íŒŒì¼|
|.index| offset -> file ìœ„ì¹˜ ë§¤í•‘(binary)|
|.timeindex| timestamp -> offset ë§¤í•‘(ì‹œê°„ ê¸°ì¤€ ì¡°íšŒìš©)|

![kafka segment](/dataengineering/kafka/kafka-segment.png)

---
title:  "[Django] Django-Login 페이지 만들기"
excerpt: "Login 페이지"

categories:
  - Django
tags:
  - [Programming, python, Backend]

toc: true
toc_sticky: true
 
date: 2021-08-25
last_modified_at: 2021-08-25
---
### Login Page
회원가입 페이지처럼 먼저 **login.html**을 만들고 **urls.py**에 ```path('login/', views.login)```로 연결해준뒤 login의 함수를 만들어준다.

```python
def login(request):
    if request.method == 'GET':
        return render(request, 'login.html')
    elif request.method == 'POST':
        username = request.POST.get('username', None)
        password = request.POST.get('password', None)
        
        res_data = {}
        if not (username and password):
            res_data['error'] = '모든 값을 입력해야합니다.'
        else:
            # 다시 Fcuser라는 모델에서 정보를 가져옴
            fcuser = Fcuser.objects.get(username=username)
            if check_password(password, fcuser.password):
                # 비밀번호가 일치, 로그인 처리
                # 세션!
                request.session['user'] = fcuser.id
                # redirect로 다시 홈으로 돌아가기
                return redirect('/') # /을 쓰면 현재 쓰는 웹 사이트의 root로 감
            else:
                res_data['error'] = '비밀번호를 틀렸습니다.'
        
        return render(request, 'login.html', res_data)
```
여기서 ```request.session['user'] = fcuser.id```은 로그인할때 입력한 아이디에 대한 session으로 접속할 수 있게 해준다.

views.py에는 login과 함께 home페이지도 만들어줘야하기 때문에 이와 같이 만들었고, 접속시 user_id로 뜨게 된다.
```python
def home(request):
    user_id = request.session.get('user')
    
    if user_id:
        fcuser = Fcuser.objects.get(pk=user_id)
        return HttpResponse(fcuser.username)
        
    return HttpResponse('Home!')
```

#### 세션으로 로그인하는 것이 제일 핵심 포인트!
**home**에서 쓰는 ```user_id = request.session.get('user')```과 **login**에서 쓰는 ```request.session['user'] = fcuser.id```을 명심하자!
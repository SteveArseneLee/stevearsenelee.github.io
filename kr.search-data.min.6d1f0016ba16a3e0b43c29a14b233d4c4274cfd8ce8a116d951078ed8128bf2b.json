[{"id":0,"href":"/docs/infra/kvm/whatswrong/","title":"ì´ê±¸ í•´ë³¼ê¹Œìš”","section":"KVM","content":" Worker Nodeì— Role ë¶€ì—¬í•˜ê¸° # kubectl label node {nodeëª…} node-role.kubernetes.io/worker=worker NFS ì„œë²„ ì—°ê²° ë° PersistentVolume, StorageClass ì„¤ì • # NFS ì„œë²„ í™•ì¸ IP í™•ì¸ ê³µìœ  ë””ë ‰í† ë¦¬ : e.g. /srv/nfs/k8s NFS ì„œë²„ ì„¤ì¹˜í•˜ê¸°\nsudo apt update \u0026amp;\u0026amp; sudo apt install nfs-kernel-server -y sudo mkdir -p /srv/nfs/k8s sudo chown nobody:nogroup /srv/nfs/k8s echo \u0026#34;/srv/nfs/k8s *(rw,sync,no_subtree_check,no_root_squash)\u0026#34; | sudo tee -a /etc/exports sudo exportfs -rav sudo systemctl restart nfs-kernel-server NFS Client ì„¤ì¹˜\nëª¨ë“  ì›Œì»¤ ë…¸ë“œì— ì•„ë˜ ì‹¤í–‰ sudo apt update \u0026amp;\u0026amp; sudo apt install nfs-common -y kubespray # [kube_control_plane] k8s-m1 ansible_host=192.168.0.101 ip=192.168.0.101 etcd_member_name=etcd1 k8s-m2 ansible_host=192.168.0.102 ip=192.168.0.102 etcd_member_name=etcd2 k8s-m3 ansible_host=192.168.0.103 ip=192.168.0.103 etcd_member_name=etcd3 [etcd] k8s-m1 k8s-m2 k8s-m3 [kube_node] k8s-w1 ansible_host=192.168.0.104 ip=192.168.0.104 k8s-w2 ansible_host=192.168.0.105 ip=192.168.0.105 k8s-w3 ansible_host=192.168.0.106 ip=192.168.0.106 [k8s_cluster:children] kube_control_plane kube_node "},{"id":1,"href":"/docs/%EC%BB%B4%ED%93%A8%ED%84%B0%EC%9D%B4%EB%A1%A0/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C/1-process-thread/","title":"1. Process \u0026 Thread","section":"ìš´ì˜ì²´ì œ","content":" 1. ì •ì˜ # í”„ë¡œì„¸ìŠ¤ (Process) # ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œê·¸ë¨ì˜ ì¸ìŠ¤í„´ìŠ¤ ìš´ì˜ì²´ì œë¡œë¶€í„° ë…ë¦½ëœ ë©”ëª¨ë¦¬ ê³µê°„, ìì›ì„ í• ë‹¹ë°›ìŒ ìì²´ ì£¼ì†Œ ê³µê°„, ì½”ë“œ ì˜ì—­, ë°ì´í„°, í™, ìŠ¤íƒì„ ê°€ì§ ê° í”„ë¡œì„¸ìŠ¤ëŠ” **PCB(Process Control Block)**ë¡œ ì»¤ë„ì´ ê´€ë¦¬ ìŠ¤ë ˆë“œ (Thread) # í”„ë¡œì„¸ìŠ¤ ë‚´ë¶€ì—ì„œ ì‹¤í–‰ë˜ëŠ” ì‘ì—…ì˜ íë¦„ ë‹¨ìœ„ ì½”ë“œ, ë°ì´í„°, í™, íŒŒì¼ ë””ìŠ¤í¬ë¦½í„° ë“±ì„ í”„ë¡œì„¸ìŠ¤ ë‚´ ë‹¤ë¥¸ ìŠ¤ë ˆë“œì™€ ê³µìœ  ìŠ¤íƒê³¼ ë ˆì§€ìŠ¤í„°ëŠ” ë…ë¦½ì ìœ¼ë¡œ ê°€ì§ **TCB(Thread Control Block)**ë¡œ ì»¤ë„/ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ê´€ë¦¬ 2. êµ¬ì¡° ë° ì°¨ì´ì  # í•­ëª© í”„ë¡œì„¸ìŠ¤ ìŠ¤ë ˆë“œ ì •ì˜ ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œê·¸ë¨ì˜ ì¸ìŠ¤í„´ìŠ¤ í”„ë¡œì„¸ìŠ¤ ë‚´ ì‘ì—… íë¦„ ë‹¨ìœ„ ë©”ëª¨ë¦¬ êµ¬ì¡° ì½”ë“œ, ë°ì´í„°, í™, ìŠ¤íƒ ëª¨ë‘ ë…ë¦½ ìŠ¤íƒë§Œ ë…ë¦½, ë‚˜ë¨¸ì§€ ê³µìœ  ìì› ê³µìœ  ì—†ìŒ (IPC í•„ìš”) ìˆìŒ (ê³µìœ  ë©”ëª¨ë¦¬ ê¸°ë°˜) ìƒì„± ë¹„ìš© í¼ (fork) ì‘ìŒ (pthread_create) ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­ ì£¼ì†Œ ê³µê°„ ì „í™˜ í¬í•¨ â†’ ë¹„ìš© í¼ ì£¼ì†Œ ê³µê°„ ê³µìœ  â†’ ë¹„ìš© ì ìŒ ì•ˆì •ì„± ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì— ì˜í–¥ ì—†ìŒ í•˜ë‚˜ì˜ ì˜¤ë¥˜ê°€ ì „ì²´ì— ì˜í–¥ ê°€ëŠ¥ 3. Context Switching # CPUê°€ ì‹¤í–‰ ì¤‘ì¸ ì‘ì—…ì„ ì¤‘ë‹¨í•˜ê³  ë‹¤ë¥¸ ì‹¤í–‰ ë‹¨ìœ„ë¡œ ì „í™˜í•˜ëŠ” ê³¼ì • í•„ìš”í•œ ì •ë³´: PC, ë ˆì§€ìŠ¤í„°, ìŠ¤íƒ í¬ì¸í„° ë“± ìŠ¤ë ˆë“œ ê°„ ì „í™˜ì€ ì£¼ì†Œ ê³µê°„ì´ ê°™ì•„ ë¹ ë¥´ì§€ë§Œ, ë™ê¸°í™” ë¬¸ì œ ë°œìƒ ê°€ëŠ¥ í”„ë¡œì„¸ìŠ¤ ê°„ ì „í™˜ì€ ë³´í˜¸ëŠ” ë›°ì–´ë‚˜ì§€ë§Œ, ì˜¤ë²„í—¤ë“œ í¼ 4. ì‹¤ë¬´ í™œìš© ì˜ˆì‹œ # ë¶„ì•¼ ì„¤ëª… ì›¹ ì„œë²„ Nginx, Tomcat ë“±ì€ í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ì„ ìŠ¤ë ˆë“œ ë‹¨ìœ„ë¡œ ë¶„ë¦¬ ì²˜ë¦¬ (ìŠ¤ë ˆë“œ í’€ ê¸°ë°˜) ë¸Œë¼ìš°ì € Chrome: íƒ­ì€ í”„ë¡œì„¸ìŠ¤, íƒ­ ë‚´ ë™ì‘ì€ ìŠ¤ë ˆë“œë¡œ ë¶„ë¦¬ (ì•ˆì •ì„±ê³¼ ë³‘ë ¬ì„± ëª¨ë‘ í™•ë³´) ë©€í‹°ì½”ì–´ CPU í™œìš© Pythonì€ GILë¡œ ë©€í‹° ìŠ¤ë ˆë”© ì„±ëŠ¥ í•œê³„ â†’ ë©€í‹°í”„ë¡œì„¸ì‹± ì‚¬ìš© (ì˜ˆ: multiprocessing ëª¨ë“ˆ) ê²Œì„ ì—”ì§„ ë Œë”ë§/ë„¤íŠ¸ì›Œí¬/ë¬¼ë¦¬ ê³„ì‚°ì„ ê°œë³„ ìŠ¤ë ˆë“œë¡œ ë³‘ë ¬ ì²˜ë¦¬ 5. ê´€ë ¨ ëª…ë ¹ì–´ ë° ì‹¤ìŠµ # ëª…ë ¹ì–´ ì„¤ëª… ps -ef, top í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ í™•ì¸ htop F2 â†’ Threads í‘œì‹œ ì˜µì…˜ìœ¼ë¡œ ìŠ¤ë ˆë“œ í™•ì¸ strace -p í•´ë‹¹ í”„ë¡œì„¸ìŠ¤ì˜ ì‹œìŠ¤í…œ ì½œ íë¦„ ì¶”ì  pthread_create() POSIX ìŠ¤ë ˆë“œ ìƒì„± (C/C++) java.lang.Thread, Runnable Javaì—ì„œì˜ ìŠ¤ë ˆë“œ ì‘ì„± ë°©ì‹ 6. ìì£¼ ë¬»ëŠ” ë©´ì ‘ ì§ˆë¬¸ # Q1. í”„ë¡œì„¸ìŠ¤ì™€ ìŠ¤ë ˆë“œì˜ ì°¨ì´ë¥¼ ì„¤ëª…í•´ì£¼ì„¸ìš”.\nA. í”„ë¡œì„¸ìŠ¤ëŠ” ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œê·¸ë¨ì˜ ë…ë¦½ì ì¸ ë‹¨ìœ„ë¡œ, ìš´ì˜ì²´ì œë¡œë¶€í„° ë³„ë„ì˜ ë©”ëª¨ë¦¬ ê³µê°„ì„ í• ë‹¹ë°›ëŠ”ë‹¤. ë°˜ë©´, ìŠ¤ë ˆë“œëŠ” í”„ë¡œì„¸ìŠ¤ ë‚´ë¶€ì—ì„œ ì‹¤í–‰ë˜ëŠ” íë¦„ ë‹¨ìœ„ë¡œ, ê°™ì€ í”„ë¡œì„¸ìŠ¤ì˜ ë‹¤ë¥¸ ìŠ¤ë ˆë“œë“¤ê³¼ ë©”ëª¨ë¦¬ ê³µê°„ì„ ê³µìœ í•œë‹¤.\ní•­ëª© í”„ë¡œì„¸ìŠ¤ ìŠ¤ë ˆë“œ ë©”ëª¨ë¦¬ ê³µê°„ ë…ë¦½ (ì½”ë“œ, ë°ì´í„°, í™, ìŠ¤íƒ) ìŠ¤íƒë§Œ ë…ë¦½, ë‚˜ë¨¸ì§€ ê³µìœ  ìƒì„± ë¹„ìš© ìƒëŒ€ì ìœ¼ë¡œ ë†’ìŒ ê°€ë²¼ì›€ (ë¹ ë¥¸ ìƒì„±, ìŠ¤ìœ„ì¹­) í†µì‹  ë°©ì‹ IPC í•„ìš” ê³µìœ  ë©”ëª¨ë¦¬ë¡œ ë¹ ë¦„ -\u0026gt; ìŠ¤ë ˆë“œëŠ” ë¹„ìš©ì´ ì ê³  í†µì‹ ì´ ë¹ ë¥´ì§€ë§Œ, í•˜ë‚˜ê°€ ë¬¸ì œë¥¼ ì¼ìœ¼í‚¤ë©´ ì „ì²´ í”„ë¡œì„¸ìŠ¤ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆì–´ ë™ê¸°í™”ì™€ ì˜ˆì™¸ ì²˜ë¦¬ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤.\nQ2. í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œê°€ ì£½ìœ¼ë©´ ì „ì²´ í”„ë¡œì„¸ìŠ¤ì— ì–´ë–¤ ì˜í–¥ì„ ì£¼ë‚˜ìš”?\nA. ìŠ¤ë ˆë“œëŠ” ë™ì¼í•œ í”„ë¡œì„¸ìŠ¤ ê³µê°„ ë‚´ì—ì„œ ìì›ì„ ê³µìœ í•˜ê¸° ë•Œë¬¸ì—, í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•˜ê±°ë‚˜ ë©”ëª¨ë¦¬ë¥¼ ì˜¤ì—¼ì‹œí‚¤ë©´, ì „ì²´ í”„ë¡œì„¸ìŠ¤ê°€ ë¹„ì •ìƒì ìœ¼ë¡œ ì¢…ë£Œë  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, Javaì—ì„œ í•œ ìŠ¤ë ˆë“œê°€ NullPointerExceptionìœ¼ë¡œ ì£½ì„ ê²½ìš°, ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ í•˜ì§€ ì•Šìœ¼ë©´ ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì¢…ë£Œëœë‹¤. ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ try-catch, uncaughtExceptionHandler, ë˜ëŠ” ì„œí‚· ë¸Œë ˆì´ì»¤ ê°™ì€ ì „ëµì„ ì‚¬ìš©í•œë‹¤.\nQ3. ë©€í‹° í”„ë¡œì„¸ì‹±ê³¼ ë©€í‹° ìŠ¤ë ˆë”© ì¤‘ ì–¸ì œ ì–´ë–¤ ê²ƒì„ ì„ íƒí•  ê±´ê°€ìš”?\nA.\në©€í‹° ìŠ¤ë ˆë”©: I/O ì¤‘ì‹¬ ì‘ì—…, ì›¹ ì„œë²„ ë“± ë¹ ë¥¸ ì‘ë‹µì´ ì¤‘ìš”í•˜ê³ , ìì› ê³µìœ ê°€ í•„ìš”í•œ ê²½ìš° ë©€í‹° í”„ë¡œì„¸ì‹±: ê³„ì‚° ì§‘ì•½ì (CPU-bound) ì‘ì—…, ë³‘ë ¬ ì²˜ë¦¬ì— ì í•©. ì˜ˆ: ì´ë¯¸ì§€ ì²˜ë¦¬, ë¨¸ì‹ ëŸ¬ë‹ í•™ìŠµ íŠ¹íˆ Pythonì€ GIL(Global Interpreter Lock) ë•Œë¬¸ì— CPU-bound ì‘ì—…ì€ ë©€í‹° í”„ë¡œì„¸ì‹±ì´ ë” ì í•©íˆë‹¤. ë°˜ëŒ€ë¡œ Javaë‚˜ Go ê°™ì€ ì–¸ì–´ëŠ” ë©€í‹° ìŠ¤ë ˆë”©ì´ ê°•ë ¥í•˜ê²Œ ì§€ì›ëœë‹¤.\n"},{"id":2,"href":"/docs/%EC%BB%B4%ED%93%A8%ED%84%B0%EC%9D%B4%EB%A1%A0/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C/2-cpu-scheduling/","title":"2. CPU Scheduling","section":"ìš´ì˜ì²´ì œ","content":" 1. ì •ì˜ # CPU ìŠ¤ì¼€ì¤„ë§ì€ Ready Queueì— ìˆëŠ” í”„ë¡œì„¸ìŠ¤ë“¤ ì¤‘ ì–´ë–¤ í”„ë¡œì„¸ìŠ¤ì—ê²Œ CPUë¥¼ í• ë‹¹í• ì§€ ê²°ì •í•˜ëŠ” ì •ì±…. ë©€í‹°íƒœìŠ¤í‚¹ OSì—ì„œ í”„ë¡œì„¸ìŠ¤ ê°„ CPUë¥¼ ê³µìœ í•˜ê¸° ìœ„í•œ í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜. OSì˜ í•µì‹¬ ê¸°ëŠ¥ ì¤‘ í•˜ë‚˜ë¡œ, ìŠ¤ì¼€ì¤„ëŸ¬ëŠ” ë‹¤ì–‘í•œ ì •ì±…ì— ë”°ë¼ í”„ë¡œì„¸ìŠ¤ë¥¼ ì„ íƒí•¨. ì£¼ìš” ëª©ì  # ì‹œìŠ¤í…œ ìì›ì˜ ê³µì •í•œ ë¶„ë°° CPU ì‚¬ìš©ë¥ (Throughput) ê·¹ëŒ€í™” ëŒ€ê¸° ì‹œê°„, ì‘ë‹µ ì‹œê°„ ìµœì†Œí™” ì „ë°˜ì ì¸ ì‹œìŠ¤í…œ ë°˜ì‘ì„± í–¥ìƒ 2. ìŠ¤ì¼€ì¥´ë§ì´ í•„ìš”í•œ ì‹œì  # í”„ë¡œì„¸ìŠ¤ê°€ CPU burstë¥¼ ë§ˆì¹˜ê³  I/O ìš”ì²­ â†’ CPU ë°˜í™˜ í”„ë¡œì„¸ìŠ¤ê°€ ì¢…ë£Œë¨ ì„ ì í˜• ìŠ¤ì¼€ì¤„ëŸ¬ì˜ ê²½ìš°, ë” ë†’ì€ ìš°ì„ ìˆœìœ„ì˜ í”„ë¡œì„¸ìŠ¤ê°€ ë„ì°© sleep(), wait() í˜¸ì¶œ í›„ wake upë  ë•Œ 3. ì£¼ìš” ìŠ¤ì¼€ì¥´ë§ ê¸°ì¤€ # ê¸°ì¤€ ì„¤ëª… CPU burst time ì–¼ë§ˆë‚˜ ì§§ê²Œ CPUë¥¼ ì ìœ í• ì§€ ìš°ì„ ìˆœìœ„ (Priority) ì‚¬ìš©ì/ì‹œìŠ¤í…œ ì§€ì • ë„ì°© ì‹œê°„ (Arrival Time) ë¨¼ì € ì˜¨ ìˆœì„œ ëŒ€ê¸° ì‹œê°„ / ì‘ë‹µ ì‹œê°„ ìœ ì €ê°€ ì²´ê°í•˜ëŠ” ë°˜ì‘ ì†ë„ Aging ê¸°ì•„(Starvation) ë°©ì§€ ëª©ì  4. ìŠ¤ì¼€ì¥´ë§ ì•Œê³ ë¦¬ì¦˜ # FCFS (First-Come, First-Served) ë¨¼ì € ì˜¨ ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬ (Queue ê¸°ë°˜) ë‹¨ìˆœí•˜ì§€ë§Œ Convoy í˜„ìƒ ë°œìƒ ê°€ëŠ¥ (ê¸´ ì‘ì—…ì´ ì§§ì€ ì‘ì—…ì„ ë§‰ìŒ) SJF (Shortest Job First) CPU burstê°€ ê°€ì¥ ì§§ì€ ì‘ì—… ìš°ì„  ì´ë¡ ìƒ ê°€ì¥ íš¨ìœ¨ì  (ëŒ€ê¸°ì‹œê°„ ìµœì†Œ), í•˜ì§€ë§Œ ì˜ˆì¸¡ì´ ì–´ë µë‹¤ ë¹„ì„ ì í˜•(ê¸°ë³¸) ë˜ëŠ” **ì„ ì í˜•(SRTF)**ìœ¼ë¡œ êµ¬í˜„ ê°€ëŠ¥ Round Robin (RR) ê° í”„ë¡œì„¸ìŠ¤ì— Time Quantum ë¶€ì—¬ ì‹œê°„ í• ë‹¹ì´ ëë‚˜ë©´ ì„ ì  ë°œìƒ â†’ ê³µì •ì„± â†‘ ì‘ë‹µì„±ì´ ì¤‘ìš”í•  ë•Œ ìœ ìš© (ì¸í„°ë™í‹°ë¸Œ ì‹œìŠ¤í…œ) Priority Scheduling ìš°ì„ ìˆœìœ„ ë†’ì€ ì‘ì—…ë¶€í„° ì‹¤í–‰ Starvation ë°œìƒ ê°€ëŠ¥ â†’ Aging ê¸°ë²•ìœ¼ë¡œ ì™„í™” Multi-Level Queue (MLQ) í”„ë¡œì„¸ìŠ¤ë¥¼ ì„±ê²©ì— ë”°ë¼ ì—¬ëŸ¬ íë¡œ ë¶„ë¥˜ (ex. interactive, batch) íë§ˆë‹¤ ë³„ë„ ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš© í ê°„ ìš°ì„ ìˆœìœ„ ì¡´ì¬ (low queueëŠ” starvation ê°€ëŠ¥) Multi-Level Feedback Queue (MLFQ) MLQ í™•ì¥í˜•, í”„ë¡œì„¸ìŠ¤ê°€ ë‹¤ë¥¸ íë¡œ ì´ë™ ê°€ëŠ¥ ì´ˆê¸°ì—” ë†’ì€ ìš°ì„ ìˆœìœ„ì—ì„œ ì‹œì‘, CPU ì˜¤ë˜ ì“°ë©´ ì ì  ë‚®ì€ ìš°ì„ ìˆœìœ„ë¡œ ì´ë™ í˜„ëŒ€ OSê°€ ì±„íƒí•˜ëŠ” í˜„ì‹¤ì ì¸ ì •ì±… 5. ì„ ì í˜• vs ë¹„ì„ ì í˜• # êµ¬ë¶„ ë¹„ì„ ì í˜• ì„ ì í˜• ì„¤ëª… CPUë¥¼ í• ë‹¹ë°›ìœ¼ë©´ ìë°œì ìœ¼ë¡œ ë°˜í™˜í•  ë•Œê¹Œì§€ ìœ ì§€ ìš°ì„ ìˆœìœ„ ë“± ì¡°ê±´ì— ë”°ë¼ ì¤‘ê°„ì— ì„ ì  ê°€ëŠ¥ ì˜ˆì‹œ ì•Œê³ ë¦¬ì¦˜ FCFS, SJF RR, Priority(ì„ ì í˜•), SRTF íŠ¹ì§• ë‹¨ìˆœ, context switch ì ìŒ ì‘ë‹µì„± ìš°ìˆ˜, ë³µì¡ë„ â†‘ 6. ì„±ëŠ¥ ì§€í‘œ # ì§€í‘œ ì„¤ëª… CPU ì‚¬ìš©ë¥  CPUê°€ ë†€ì§€ ì•Šê³  ì¼í•˜ëŠ” ë¹„ìœ¨ Throughput ë‹¨ìœ„ ì‹œê°„ë‹¹ ì™„ë£Œëœ í”„ë¡œì„¸ìŠ¤ ìˆ˜ Turnaround Time í”„ë¡œì„¸ìŠ¤ ì‹œì‘ ~ ì¢…ë£Œê¹Œì§€ ê±¸ë¦° ì‹œê°„ Waiting Time Ready Queueì—ì„œ ê¸°ë‹¤ë¦° ì‹œê°„ Response Time ìš”ì²­ í›„ ì²« ë°˜ì‘ê¹Œì§€ ê±¸ë¦° ì‹œê°„ 7. ì‹¤ë¬´ ì˜ˆì‹œ # OS ìŠ¤ì¼€ì¤„ëŸ¬ Linux (CFS) Completely Fair Scheduler â€“ ì‹œê°„ ë‹¨ìœ„ë¥¼ Weightë¡œ ë³€í™˜í•´ ê³µì •í•˜ê²Œ ë¶„ë°° Windows Multilevel Feedback Queue ê¸°ë°˜ ì„ ì í˜• RTOS Priority-based preemptive scheduling (ì‹¤ì‹œê°„ì„± ê°•ì¡°) =\u0026gt; ğŸ“Œ Linux CFSëŠ” ê°€ìƒ ëŸ°íƒ€ì„(VRuntime) ê¸°ë°˜ìœ¼ë¡œ, ê° íƒœìŠ¤í¬ì˜ ì‹¤í–‰ ì‹œê°„ì„ ì¶”ì í•˜ë©° ê°€ì¥ â€œëœ ì‚¬ìš©í•œâ€ í”„ë¡œì„¸ìŠ¤ì—ê²Œ CPUë¥¼ í• ë‹¹.\n8. ìì£¼ ë¬»ëŠ” ë©´ì ‘ ì§ˆë¬¸ # Q1. SJFê°€ ì´ìƒì ìœ¼ë¡œ íš¨ìœ¨ì ì¸ ì´ìœ ëŠ”?\nA.\nSJFëŠ” í‰ê·  ëŒ€ê¸° ì‹œê°„ì„ ìˆ˜í•™ì ìœ¼ë¡œ ìµœì†Œí™”í•˜ëŠ” ìµœì  ì•Œê³ ë¦¬ì¦˜. í•˜ì§€ë§Œ ì‹¤ì œ CPU burst timeì„ ì •í™•íˆ ì˜ˆì¸¡í•˜ëŠ” ê±´ ì–´ë µê¸° ë•Œë¬¸ì— ì‹¤ë¬´ ì ìš©ì´ ì œí•œì . Q2. Round Robinì˜ íƒ€ì„í€€í…€ í¬ê¸°ëŠ” ì–´ë–»ê²Œ ê²°ì •í•´ì•¼ í•˜ë‚˜ìš”?\nA.\në„ˆë¬´ ì‘ìœ¼ë©´ context switching ì˜¤ë²„í—¤ë“œ ì¦ê°€ ë„ˆë¬´ í¬ë©´ FCFSì²˜ëŸ¼ ë³€í•¨ ì¼ë°˜ì ìœ¼ë¡œ 10~100ms ìˆ˜ì¤€ Q3. ì„ ì í˜• ìŠ¤ì¼€ì¤„ë§ì´ í•„ìš”í•œ ì´ìœ ëŠ”?\nA.\nì‹¤ì‹œê°„ ë°˜ì‘ì´ í•„ìš”í•œ í™˜ê²½ (GUI, ì¸í„°ë™í‹°ë¸Œ shell ë“±) ì§§ì€ ì‘ì—…ì´ ê¸´ ì‘ì—…ì— ì˜í•´ ë°€ë¦¬ëŠ” ê²ƒì„ ë°©ì§€ Q4. ë©€í‹°ì½”ì–´ í™˜ê²½ì—ì„œ ìŠ¤ì¼€ì¤„ë§ì€ ì–´ë–»ê²Œ ë™ì‘í•˜ë‚˜ìš”?\nê° CPUì— Run Queueë¥¼ ë‘ëŠ” per-CPU ëª¨ë¸ ì‚¬ìš© ë¶€í•˜ ë¶„ì‚°ì„ ìœ„í•œ load balancing ë˜ëŠ” task migration ì „ëµ í•„ìš” LinuxëŠ” SMP(Symmetric Multi Processing) ìŠ¤ì¼€ì¤„ëŸ¬ë¡œ ì²˜ë¦¬ "},{"id":3,"href":"/docs/%EC%BB%B4%ED%93%A8%ED%84%B0%EC%9D%B4%EB%A1%A0/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C/3-process-synchronization/","title":"3. í”„ë¡œì„¸ìŠ¤ ë™ê¸°í™”(Process Synchronization)","section":"ìš´ì˜ì²´ì œ","content":" 1. ì •ì˜ # í”„ë¡œì„¸ìŠ¤ ë™ê¸°í™”ë€ ë‘˜ ì´ìƒì˜ í”„ë¡œì„¸ìŠ¤(ë˜ëŠ” ìŠ¤ë ˆë“œ)ê°€ ê³µìœ  ìì›ì— ì ‘ê·¼í•  ë•Œ ì¶©ëŒ ì—†ì´ ì•ˆì „í•˜ê²Œ ì‘ì—…í•  ìˆ˜ ìˆë„ë¡ ë³´ì¥í•˜ëŠ” ë°©ë²•. ì£¼ë¡œ ì„ê³„ êµ¬ì—­(Critical Section) ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ë™ê¸°í™” ë©”ì»¤ë‹ˆì¦˜ì„ ì˜ë¯¸. ğŸ”¹ ì„ê³„ êµ¬ì—­ (Critical Section) # ë™ì‹œì— í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ë§Œ ì ‘ê·¼í•´ì•¼ í•˜ëŠ” ê³µìœ  ìì› ì²˜ë¦¬ êµ¬ê°„. ì˜ˆ: ì „ì—­ ë³€ìˆ˜, ê³µìœ ëœ íŒŒì¼, ë„¤íŠ¸ì›Œí¬ ì†Œì¼“ ë“± ğŸ”¹ ë™ê¸°í™”ì˜ ëª©ì  # Race Condition ë°©ì§€: ë‘˜ ì´ìƒì˜ í”„ë¡œì„¸ìŠ¤ê°€ ë°ì´í„°ë¥¼ ë™ì‹œì— ì½ê³  ì“°ë©´ ë¹„ì •ìƒì ì¸ ê²°ê³¼ ë°œìƒ ì¼ê´€ì„± ìœ ì§€: ë°ì´í„° ë¬´ê²°ì„± ë³´ì¥ 2. ë™ê¸°í™”ì˜ 3ê°€ì§€ ìš”êµ¬ ì¡°ê±´(ì„ê³„ êµ¬ì—­ ë¬¸ì œ í•´ê²° ì¡°ê±´) # ìƒí˜¸ ë°°ì œ (Mutual Exclusion): í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ë§Œ ì„ê³„ êµ¬ì—­ ì‹¤í–‰ ê°€ëŠ¥ ì§„í–‰ (Progress): ì„ê³„ êµ¬ì—­ì— ì§„ì…í•˜ì§€ ì•Šì€ í”„ë¡œì„¸ìŠ¤ëŠ” ì§„ì… ì—¬ë¶€ ê²°ì •ì— ê´€ì—¬ X í•œì • ëŒ€ê¸° (Bounded Waiting): ë¬´í•œì • ëŒ€ê¸° ì—†ì´ ìˆœì°¨ì ìœ¼ë¡œ ê¸°íšŒ ë¶€ì—¬ 3. ë™ê¸°í™” ì£¼ìš” ê¸°ë²• # ë®¤í…ìŠ¤(Mutex, Mutual Exclusion Lock) í•œ ë²ˆì— í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œë§Œ ë½ì„ íšë“ ê°€ëŠ¥ íšë“í•œ ìŠ¤ë ˆë“œë§Œ ì„ê³„ êµ¬ì—­ ì§„ì… â†’ ì™„ë£Œ í›„ unlock ì†Œìœ  ê°œë… ìˆìŒ: ë½ì„ ê±¸ê³  í•´ì œí•  ìˆ˜ ìˆëŠ” ì£¼ì²´ëŠ” ë™ì¼í•´ì•¼ í•¨ ì‚¬ìš© ì˜ˆì‹œ: pthread_mutex, Java synchronized, C++ std::mutex pthread_mutex_t lock; pthread_mutex_lock(\u0026amp;lock); // ì„ê³„ êµ¬ì—­ pthread_mutex_unlock(\u0026amp;lock); ì„¸ë§ˆí¬ì–´(Semaphore) ì¹´ìš´íŒ… ê°€ëŠ¥í•œ ë™ê¸°í™” ë„êµ¬ ë‘ ê°€ì§€ ì—°ì‚°: P() ë˜ëŠ” wait() â†’ ìì› ìš”ì²­ (countâ€“) V() ë˜ëŠ” signal() â†’ ìì› ë°˜ë‚© (count++) ìŒìˆ˜ê°€ ë˜ë©´ ëŒ€ê¸° íì— ë¸”ë¡ë¨ ì†Œìœ  ê°œë… ì—†ìŒ â†’ ë‹¤ë¥¸ ìŠ¤ë ˆë“œê°€ í•´ì œ ê°€ëŠ¥ ì¢…ë¥˜ ì„¤ëª… Binary Semaphore 0 or 1 (ë®¤í…ìŠ¤ì™€ ìœ ì‚¬) Counting Semaphore íŠ¹ì • ìˆ˜ ì´ìƒì˜ ë™ì‹œ ì ‘ê·¼ í—ˆìš© ê°€ëŠ¥ ìŠ¤í•€ë½(Spinlock) ë½ì„ íšë“í•  ë•Œê¹Œì§€ CPUë¥¼ ì ìœ í•œ ì±„ ë¬´í•œ ë£¨í”„(ë°”ìœ ëŒ€ê¸°). ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹˜ê°€ ë¹„ì‹¼ ì»¤ë„ ê³µê°„ì´ë‚˜ ì§§ì€ ë½ ì†Œìœ  ì‹œ ìœ ë¦¬ ì£¼ì˜: ë©€í‹°ì½”ì–´ í™˜ê²½ì—ì„œë§Œ ìœ íš¨í•˜ë©°, ì‹±ê¸€ì½”ì–´ì—ì„œ ì‚¬ìš©í•˜ë©´ CPU ë‚­ë¹„ ëª¨ë‹ˆí„°(Monitor) ì–¸ì–´ ìˆ˜ì¤€ì˜ ë™ê¸°í™” ì¶”ìƒí™” ë‚´ë¶€ì— Lock + Condition Variable í¬í•¨ Java, C#, Go ë“±ì—ì„œ ì‚¬ìš© (synchronized, wait/notify, etc.) ì¡°ê±´ ë³€ìˆ˜ (Condition Variable) ì–´ë–¤ ì¡°ê±´ì´ ë§Œì¡±ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ëŠ” ë° ì‚¬ìš© ì£¼ë¡œ ë®¤í…ìŠ¤ì™€ í•¨ê»˜ ì‚¬ìš© ì˜ˆì‹œ: pthread_cond_wait() Java Object.wait() / Object.notify() 4. Race COndition ì˜ˆì œì™€ í•´ê²° ë°©ë²• # int counter = 0; void* increment(void* arg) { for (int i = 0; i \u0026lt; 1000000; i++) { counter++; } } ìœ„ ì½”ë“œì—ì„œ ë‘ ê°œì˜ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— counter++ë¥¼ ìˆ˜í–‰í•˜ë©´ Race Condition ë°œìƒ í•´ê²°ì±…: mutex ì‚¬ìš© 5. ì‹¤ë¬´ ì˜ˆì‹œ # ë¶„ì•¼ ë™ê¸°í™” ë°©ì‹ ë‹¤ì¤‘ ìš”ì²­ ì²˜ë¦¬ ì„œë²„ (ex. Tomcat) Thread Pool + ë®¤í…ìŠ¤ / ì„¸ë§ˆí¬ì–´ ìƒì‚°ì-ì†Œë¹„ì íŒ¨í„´ Circular Buffer + ì¡°ê±´ ë³€ìˆ˜ DB connection pool Counting Semaphore ì»¤ë„ ì˜ì—­ (ë½ ì—†ëŠ” í”„ë¡œê·¸ë˜ë° í¬í•¨) Spinlock, ì›ì ì—°ì‚°, CAS(Compare-And-Swap) 6. ìì£¼ ë¬»ëŠ” ë©´ì ‘ ì§ˆë¬¸ # Q1. ì„¸ë§ˆí¬ì–´ì™€ ë®¤í…ìŠ¤ì˜ ì°¨ì´ëŠ”? A.\në®¤í…ìŠ¤ëŠ” 1ê°œì˜ ìì›ì„ ë³´í˜¸í•˜ë©° ì†Œìœ  ê°œë…ì´ ìˆë‹¤. ì„¸ë§ˆí¬ì–´ëŠ” ê°œìˆ˜(count)ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆê³ , ì†Œìœ  ê°œë…ì´ ì—†ë‹¤. ë˜í•œ ì„¸ë§ˆí¬ì–´ëŠ” í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œê°€ wait, ë‹¤ë¥¸ ìŠ¤ë ˆë“œê°€ signal ê°€ëŠ¥. Q2. ìŠ¤í•€ë½ì€ ì–¸ì œ ì‚¬ìš©í•˜ë‚˜ìš”? A.\në½ ì†Œìœ  ì‹œê°„ì´ ë§¤ìš° ì§§ê³ , ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­ ë¹„ìš©ì´ í° ì»¤ë„ ê³µê°„ ë˜ëŠ” ë©€í‹°ì½”ì–´ í™˜ê²½ì—ì„œ ì‚¬ìš©. ì‹±ê¸€ì½”ì–´ì—ì„œëŠ” ì˜¤íˆë ¤ ì„±ëŠ¥ ì €í•˜. Q3. ë®¤í…ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ”ë°ë„ ë°ë“œë½ì´ ë°œìƒí•˜ëŠ” ì´ìœ ëŠ”? A.\në½ì˜ íšë“ ìˆœì„œê°€ ê¼¬ì´ë©´ ë°ë“œë½ ë°œìƒ ê°€ëŠ¥. ë‹¤ì¤‘ ìì› ìš”ì²­ ì‹œ ë½ íšë“ ìˆœì„œ í†µì¼ì´ ì¤‘ìš”. í•´ê²°ì±…: íƒ€ì„ì•„ì›ƒ, ì •ë ¬ëœ ìˆœì„œë¡œ ìš”ì²­, ë½ ìˆœì„œ ì •ì±… ë“± "},{"id":4,"href":"/docs/%EC%BB%B4%ED%93%A8%ED%84%B0%EC%9D%B4%EB%A1%A0/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C/4-deadlock/","title":"4. Deadlock","section":"ìš´ì˜ì²´ì œ","content":" 1. ì •ì˜ # ë°ë“œë½(êµì°© ìƒíƒœ, Deadlock) ì´ë€ ì—¬ëŸ¬ í”„ë¡œì„¸ìŠ¤(ë˜ëŠ” ìŠ¤ë ˆë“œ)ê°€ ì„œë¡œ ìì›ì´ í’€ë¦¬ê¸°ë¥¼ ê¸°ë‹¤ë¦¬ë©° ë¬´í•œíˆ ë¸”ë¡œí‚¹ë˜ì–´, ë” ì´ìƒ ì§„í–‰ë˜ì§€ ëª»í•˜ëŠ” ìƒíƒœë¥¼ ì˜ë¯¸í•œë‹¤.\nAëŠ” Bì˜ ìì›ì„ ê¸°ë‹¤ë¦¬ê³ , BëŠ” Aì˜ ìì›ì„ ê¸°ë‹¤ë¦¬ëŠ” ìˆœí™˜ì  ëŒ€ê¸° ìƒíƒœ.\n2. ë°ë“œë½ ë°œìƒ ì¡°ê±´(Coffman\u0026rsquo;s Conditions) # ë°ë“œë½ì€ ë‹¤ìŒ 4ê°€ì§€ ì¡°ê±´ì´ ë™ì‹œì— ì„±ë¦½í•  ë•Œ ë°œìƒ\nì¡°ê±´ ì„¤ëª… ìƒí˜¸ ë°°ì œ (Mutual Exclusion) ìì›ì€ í•œ ë²ˆì— í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ë§Œ ì‚¬ìš© ê°€ëŠ¥ ì ìœ  ëŒ€ê¸° (Hold and Wait) ìì›ì„ ë³´ìœ í•œ ìƒíƒœì—ì„œ ë‹¤ë¥¸ ìì›ì„ ê¸°ë‹¤ë¦¼ ë¹„ì„ ì  (No Preemption) ì´ë¯¸ í• ë‹¹ëœ ìì›ì„ ê°•ì œë¡œ ëºì„ ìˆ˜ ì—†ìŒ ìˆœí™˜ ëŒ€ê¸° (Circular Wait) ìì› ëŒ€ê¸° ê´€ê³„ê°€ ìˆœí™˜ êµ¬ì¡°ë¥¼ ì´ë£¸ (P1â†’P2â†’â€¦â†’Pnâ†’P1) =\u0026gt; ë°ë“œë½ì„ ë°©ì§€í•˜ë ¤ë©´ ì´ ì¤‘ í•˜ë‚˜ë¼ë„ ê¹¨ì•¼ í•¨ 3. ë°ë“œë½ ì˜ˆì‹œ # Thread A: lock(a) â†’ lock(b) Thread B: lock(b) â†’ lock(a) -\u0026gt; AëŠ” aë¥¼, BëŠ” bë¥¼ ë¨¼ì € ì–»ê³  ì„œë¡œ ìƒëŒ€ë°©ì˜ ìì›ì„ ê¸°ë‹¤ë¦¼ â†’ êµì°© ìƒíƒœ ë°œìƒ\n4. í•´ê²° ì „ëµ(4ê°€ì§€ ì ‘ê·¼ë²•) # ì „ëµ ì„¤ëª… í•µì‹¬ ì•„ì´ë””ì–´ ì˜ˆë°© (Prevention) Coffman ì¡°ê±´ ì¤‘ í•˜ë‚˜ ì´ìƒì„ ì‚¬ì „ì— ì œê±° ex: ìì› ìš”ì²­ ì „ì— ëª¨ë‘ í™•ë³´ íšŒí”¼ (Avoidance) ë°ë“œë½ ë°œìƒ ê°€ëŠ¥ì„±ì„ ì‚¬ì „ì— ì˜ˆì¸¡í•˜ê³  ìš°íšŒ ex: ì€í–‰ì› ì•Œê³ ë¦¬ì¦˜ íƒì§€ ë° ë³µêµ¬ (Detection \u0026amp; Recovery) ë°ë“œë½ ë°œìƒì„ í—ˆìš©í•˜ê³  ì‚¬í›„ ë³µêµ¬ ex: ìì› í• ë‹¹ ê·¸ë˜í”„ ìˆœí™˜ íƒì§€ ë¬´ì‹œ (Ignore) ê·¸ëƒ¥ ëƒ…ë‘  (â€œOstrich Algorithmâ€) ex: Linux ëŒ€ë¶€ë¶„ ê²½ìš° ë¬´ì‹œ ì˜ˆë°© ì „ëµ êµ¬ì²´í™” # ì œê±° ì¡°ê±´ ë°©ë²• ìƒí˜¸ ë°°ì œ ìì›ì„ ê³µìœ  ê°€ëŠ¥í•˜ê²Œ ì„¤ê³„ (ë¶ˆê°€ëŠ¥í•œ ê²½ìš° ë§ìŒ) ì ìœ  ëŒ€ê¸° ëª¨ë“  ìì›ì„ í•œ ë²ˆì— ìš”ì²­í•˜ê²Œ ê°•ì œ ë¹„ì„ ì  ìì› ì„ ì  ê°€ëŠ¥í•˜ë„ë¡ ì„¤ê³„ (ì¤‘ë‹¨ í›„ ë¡¤ë°±) ìˆœí™˜ ëŒ€ê¸° ìì›ì— ê³ ì •ëœ ìˆœì„œë¥¼ ë¶€ì—¬í•˜ê³  ìˆœì„œëŒ€ë¡œë§Œ ìš”ì²­ í—ˆìš© íšŒí”¼ ì „ëµ â€“ ì€í–‰ì› ì•Œê³ ë¦¬ì¦˜ (Bankerâ€™s Algorithm) # í”„ë¡œì„¸ìŠ¤ê°€ ìì› ìš”ì²­ ì‹œ ìµœì•…ì˜ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ê°€ì •í•˜ê³ ë„ ì‹œìŠ¤í…œì´ ì•ˆì • ìƒíƒœ(safe state)ë¥¼ ìœ ì§€í•  ìˆ˜ ìˆìœ¼ë©´ ìì›ì„ í• ë‹¹ ìì› í• ë‹¹ ìƒíƒœë¥¼ ë²¡í„°/í–‰ë ¬ë¡œ í‘œí˜„ ì‹¤ë¬´ ì ìš©ì€ ì–´ë ¤ì›€ (ìì› ìš”êµ¬ëŸ‰ ì˜ˆì¸¡ì´ í•„ìš”) íƒì§€ ë° ë³µêµ¬ # ìì› í• ë‹¹ ê·¸ë˜í”„(Resource Allocation Graph)ì—ì„œ ìˆœí™˜(Cycle) ì¡´ì¬ ì—¬ë¶€ë¡œ ë°ë“œë½ ê°ì§€ ë³µêµ¬ ë°©ë²•: í”„ë¡œì„¸ìŠ¤ ê°•ì œ ì¢…ë£Œ ìì› ì„ ì  â†’ ì´ì „ ìƒíƒœë¡œ ë¡¤ë°± (ì¤‘ë‹¨ ê°€ëŠ¥í•´ì•¼ í•¨) FIFO ìˆœìœ¼ë¡œ kill, ìµœì†Œ ë¹„ìš© ê¸°ì¤€ kill ë“± 5. ì‹¤ë¬´ ì˜ˆì‹œ # ë¶„ì•¼ ëŒ€ì‘ ë°©ì‹ DB íŠ¸ëœì­ì…˜ (ì˜ˆ: MySQL, PostgreSQL) Lock wait timeout / Deadlock detection (ìˆœí™˜ ê°ì§€) Java Thread synchronized ë¸”ë¡ êµì°© ê°€ëŠ¥ â†’ íƒ€ì„ì•„ì›ƒ/ë½ ìˆœì„œ ê°•ì œ Go / C++ ë®¤í…ìŠ¤ ì²´ì¸ ë½ ì‹œ êµì°© ìœ„í—˜ â†’ ë½ ì •ë ¬ ì •ì±… í•„ìš” ì»¤ë„/ë“œë¼ì´ë²„ Deadlock ë°©ì§€ ë¡œì§ ì‚½ì…, ìŠ¤í•€ë½ ìˆœì„œ ê³ ì • 6. ìì£¼ ë¬»ëŠ” ë©´ì ‘ ì§ˆë¬¸ # Q1. ë°ë“œë½ì´ ë°œìƒí•˜ë ¤ë©´ ì–´ë–¤ ì¡°ê±´ì´ í•„ìš”í•œê°€ìš”?\nA.\nìƒí˜¸ ë°°ì œ ì ìœ  ëŒ€ê¸° ë¹„ì„ ì  ìˆœí™˜ ëŒ€ê¸° â†’ ë„¤ ê°€ì§€ ì¡°ê±´ì´ ëª¨ë‘ ë§Œì¡±ë  ë•Œë§Œ ë°ë“œë½ ë°œìƒ\nQ2. ë°ë“œë½ì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ì–´ë–¤ ì „ëµì´ ìˆë‚˜ìš”?\nA.\nì˜ˆë°©: ë„¤ ê°€ì§€ ì¡°ê±´ ì¤‘ í•˜ë‚˜ ì´ìƒì„ ê¹¨ëœ¨ë¦¼ íšŒí”¼: ì•ˆì „ ìƒíƒœ ìœ ì§€ ë³´ì¥ (ex. Bankerâ€™s Algorithm) íƒì§€: ìˆœí™˜ ê´€ê³„ ë°œê²¬ í›„ í•´ê²° ë¬´ì‹œ: ì„±ëŠ¥ ìš°ì„  ì‹œìŠ¤í…œì—ì„  ê°ìˆ˜í•˜ê³  ë°©ì¹˜ Q3. ì‹¤ë¬´ì—ì„œ ë°ë“œë½ì„ ì–´ë–»ê²Œ ì˜ˆë°©í•˜ë‚˜ìš”?\nA.\nìì› íšë“ ìˆœì„œ ê³ ì • ë½ íšë“ ì‹œ íƒ€ì„ì•„ì›ƒ ì„¤ì • ë½ ìˆ˜ ì œí•œ íŠ¸ëœì­ì…˜ êµ¬ì¡° ìµœì†Œí™” "},{"id":5,"href":"/docs/%EC%BB%B4%ED%93%A8%ED%84%B0%EC%9D%B4%EB%A1%A0/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C/5-memory-manage/","title":"5. ë©”ëª¨ë¦¬ ê´€ë¦¬","section":"ìš´ì˜ì²´ì œ","content":" 1. ë©”ëª¨ë¦¬ì˜ ê³„ì¸µ êµ¬ì¡° ë° ì£¼ì†Œ ì²´ê³„ # ë©”ëª¨ë¦¬ ê³„ì¸µ êµ¬ì¡° # CPU -\u0026gt; register -\u0026gt; cache -\u0026gt; main memory(RAM) -\u0026gt; SSD/HDD OS ì…ì¥ì—ì„œëŠ” **main memory(RAM)**ì„ ê´€ë¦¬í•˜ëŠ” ê²Œ í•µì‹¬ ì£¼ì†Œ ì²´ê³„ # êµ¬ë¶„ ì„¤ëª… ë…¼ë¦¬ ì£¼ì†Œ(Logical Address) CPUê°€ ìƒì„±í•œ ì£¼ì†Œ (í”„ë¡œì„¸ìŠ¤ ì…ì¥ì—ì„œì˜ ì£¼ì†Œ) ë¬¼ë¦¬ ì£¼ì†Œ(Physical Address) ì‹¤ì œ ë©”ëª¨ë¦¬ í•˜ë“œì›¨ì–´ ìƒì˜ ì£¼ì†Œ ê°€ìƒ ì£¼ì†Œ(Virtual Address) ë…¼ë¦¬ ì£¼ì†Œì™€ ê°™ìœ¼ë©°, MMUê°€ ë¬¼ë¦¬ ì£¼ì†Œë¡œ ë³€í™˜ =\u0026gt; MMU (Memory Management Unit): ë…¼ë¦¬ ì£¼ì†Œë¥¼ ë¬¼ë¦¬ ì£¼ì†Œë¡œ ë³€í™˜í•˜ëŠ” í•˜ë“œì›¨ì–´. í˜ì´ì§• ê¸°ë°˜ ì‹œìŠ¤í…œì—ì„œ í•µì‹¬ ì—­í• .\n2. ë©”ëª¨ë¦¬ ë‹¨í¸í™”(Fragmentation) # ë‚´ë¶€ ë‹¨í¸í™” (Internal Fragmentation) # í”„ë¡œì„¸ìŠ¤ê°€ í• ë‹¹ë°›ì€ ë©”ëª¨ë¦¬ë³´ë‹¤ ì ì€ ì–‘ë§Œ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ex) 12KB í•„ìš”í•œë° 16KB ë‹¨ìœ„ë¡œë§Œ í• ë‹¹ â†’ 4KB ë‚­ë¹„ ì™¸ë¶€ ë‹¨í¸í™” (External Fragmentation) # ì´ ë©”ëª¨ë¦¬ëŠ” ì¶©ë¶„í•˜ì§€ë§Œ ì—°ì†ëœ ê³µê°„ì´ ë¶€ì¡±í•´ì„œ í• ë‹¹ ë¶ˆê°€ ex) 5KB, 3KB, 4KB, â€¦ ì‹ìœ¼ë¡œ ìª¼ê°œì ¸ ìˆì–´ 10KB ìš”ì²­ ì‹¤íŒ¨ í•´ê²° ì „ëµ # ë¬¸ì œ í•´ê²° ë°©ì‹ ë‚´ë¶€ ë‹¨í¸í™” ê°€ë³€ í¬ê¸° í• ë‹¹ (slab, buddy, paging ë“±) ì™¸ë¶€ ë‹¨í¸í™” í˜ì´ì§•, ì„¸ê·¸ë©˜í…Œì´ì…˜, ì••ì¶•(compaction) ë“± 3. ë©”ëª¨ë¦¬ í• ë‹¹ ê¸°ë²• # ì—°ì† í• ë‹¹ (Contiguous Allocation) # í”„ë¡œì„¸ìŠ¤ëŠ” í•˜ë‚˜ì˜ ì—°ì†ëœ ë©”ëª¨ë¦¬ ë¸”ë¡ì„ í• ë‹¹ë°›ìŒ ë‹¨ìˆœí•˜ì§€ë§Œ ì™¸ë¶€ ë‹¨í¸í™” ë°œìƒ ê°€ëŠ¥ ë°©ì‹ ì„¤ëª… ë‹¨ìˆœ ë¶„í•  (Fixed) ë™ì¼ í¬ê¸°ì˜ íŒŒí‹°ì…˜ ê°€ë³€ ë¶„í•  (Dynamic) í”„ë¡œì„¸ìŠ¤ í¬ê¸°ì— ë”°ë¼ ë™ì  í• ë‹¹ í• ë‹¹ ì „ëµ (First Fit, Best Fit, Worst Fit)\nFirst Fit: ì²« ë²ˆì§¸ë¡œ ë§ëŠ” ê³µê°„ Best Fit: ê°€ì¥ í¬ê¸°ê°€ ê·¼ì ‘í•œ ê³µê°„ (ì™¸ë¶€ ë‹¨í¸í™” â†‘) Worst Fit: ê°€ì¥ í° ê³µê°„ (íŒŒí¸ ë°©ì§€ ëª©ì ) í˜ì´ì§• (Paging) # ë¬¼ë¦¬ ë©”ëª¨ë¦¬ë¥¼ ê³ ì •ëœ í¬ê¸°(Frame)ë¡œ ë‚˜ëˆ„ê³ , í”„ë¡œì„¸ìŠ¤ë„ ë™ì¼í•œ í¬ê¸°(Page)ë¡œ ë‚˜ëˆ” í˜ì´ì§€ ë‹¨ìœ„ë¡œ ë¶„ì‚° ì €ì¥ ê°€ëŠ¥ -\u0026gt; ì™¸ë¶€ ë‹¨í¸í™” ì œê±° ìš”ì†Œ ì„¤ëª… Page ë…¼ë¦¬ ì£¼ì†Œ ê³µê°„ì˜ ë‹¨ìœ„ Frame ë¬¼ë¦¬ ì£¼ì†Œ ê³µê°„ì˜ ë‹¨ìœ„ Page Table Page ë²ˆí˜¸ â†’ Frame ë²ˆí˜¸ ë§¤í•‘ ì •ë³´ ì €ì¥ MMU ì£¼ì†Œ ë³€í™˜ ì‹œ Page Table ì°¸ì¡° =\u0026gt; ë‹¨ì : Page Table í¬ê¸° ì¦ê°€, TLB ë¯¸ìŠ¤ ë°œìƒ ê°€ëŠ¥\nì„¸ê·¸ë©˜í…Œì´ì…˜ (Segmentation) # í”„ë¡œì„¸ìŠ¤ë¥¼ ì˜ë¯¸ ìˆëŠ” ë…¼ë¦¬ ë‹¨ìœ„(ì½”ë“œ, ë°ì´í„°, ìŠ¤íƒ ë“±)ë¡œ ë‚˜ëˆ” ê° ì„¸ê·¸ë¨¼íŠ¸ëŠ” í¬ê¸°/ì‹œì‘ ì£¼ì†Œê°€ ë‹¤ë¦„ ì£¼ì†Œ = (ì„¸ê·¸ë¨¼íŠ¸ ë²ˆí˜¸, ì˜¤í”„ì…‹) í˜•íƒœ ì¥ì  : ë…¼ë¦¬ì  êµ¬ì¡° ë°˜ì˜\në‹¨ì  : ì™¸ë¶€ ë‹¨í¸í™” ë°œìƒ ê°€ëŠ¥\n4. ë…¼ë¦¬ ì£¼ì†Œ -\u0026gt; ë¬¼ë¦¬ ì£¼ì†Œ ë³€í™˜ ê³¼ì • # ë°©ì‹ ë³€í™˜ ë°©ì‹ íŠ¹ì§• ì—°ì† í• ë‹¹ Base + offset êµ¬ì¡° ë‹¨ìˆœ í˜ì´ì§• Page Number + Offset â†’ Frame ê³ ì • í¬ê¸° ë¸”ë¡, ë‚´ë¶€ ë‹¨í¸í™” ê°€ëŠ¥ ì„¸ê·¸ë©˜í…Œì´ì…˜ Segment + Offset â†’ Physical ë…¼ë¦¬ êµ¬ì¡° ë°˜ì˜, ì™¸ë¶€ ë‹¨í¸í™” ë°œìƒ 5. ì‹¤ë¬´ ì˜ˆì‹œ # ì‚¬ë¡€ ì„¤ëª… Linux í˜ì´ì§• ê¸°ë°˜, ê°€ìƒ ë©”ëª¨ë¦¬ + TLB ì‚¬ìš© Embedded ì‹œìŠ¤í…œ ì—°ì† í• ë‹¹ ë˜ëŠ” ì„¸ê·¸ë©˜í…Œì´ì…˜ êµ¬ì¡° Heap Allocator ë‚´ë¶€ ë‹¨í¸í™” ë°©ì§€ ìœ„í•´ Slab, Buddy Allocator ì‚¬ìš© Docker/VM ê°€ìƒ ì£¼ì†Œ ê³µê°„ì„ ê²©ë¦¬í•˜ê¸° ìœ„í•´ í˜ì´ì§€ í…Œì´ë¸” ê´€ë¦¬ í•„ìˆ˜ 6. ìì£¼ ë¬»ëŠ” ë©´ì ‘ ì§ˆë¬¸ # Q1. í˜ì´ì§•ê³¼ ì„¸ê·¸ë©˜í…Œì´ì…˜ì˜ ì°¨ì´ëŠ”?\nA.\ní•­ëª© í˜ì´ì§• ì„¸ê·¸ë©˜í…Œì´ì…˜ ë‹¨ìœ„ ê³ ì • í¬ê¸° Page ê°€ë³€ í¬ê¸° Segment ë‹¨í¸í™” ë‚´ë¶€ ë‹¨í¸í™” ì™¸ë¶€ ë‹¨í¸í™” êµ¬ì¡° ë‹¨ìˆœ, ì¶”ìƒë„ ë‚®ìŒ ë…¼ë¦¬ êµ¬ì¡° í‘œí˜„ ê°€ëŠ¥ ì£¼ì†Œ í˜•ì‹ Page No + Offset Segment No + Offset Q2. ì™¸ë¶€ ë‹¨í¸í™”ì™€ ë‚´ë¶€ ë‹¨í¸í™”ëŠ” ë¬´ì—‡ì´ê³ , ê°ê° ì–´ë–»ê²Œ í•´ê²°í•˜ë‚˜ìš”?\nA.\në‚´ë¶€ ë‹¨í¸í™”: ê³ ì • í¬ê¸° í• ë‹¹ ì‹œ, ì¼ë¶€ ë¯¸ì‚¬ìš© ê³µê°„ â†’ í˜ì´ì§•, slab allocator ì™¸ë¶€ ë‹¨í¸í™”: ê°€ë³€ í• ë‹¹ ì‹œ, ì‘ì€ ì¡°ê°ë“¤ â†’ í˜ì´ì§•, ì••ì¶•, ì„¸ê·¸ë©˜í…Œì´ì…˜ Q3. Page Tableì´ ë„ˆë¬´ ì»¤ì§€ë©´ ì–´ë–»ê²Œ í•´ê²°í•˜ë‚˜ìš”?\nA.\në‹¤ë‹¨ê³„ í˜ì´ì§€ í…Œì´ë¸” TLB (Translation Lookaside Buffer): ìºì‹œ ì—­í•  í˜ì´ì§•+ì„¸ê·¸ë©˜í…Œì´ì…˜ í˜¼í•© êµ¬ì¡° "},{"id":6,"href":"/docs/%EC%BB%B4%ED%93%A8%ED%84%B0%EC%9D%B4%EB%A1%A0/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C/6-virtual-memory/","title":"6. ê°€ìƒ ë©”ëª¨ë¦¬","section":"ìš´ì˜ì²´ì œ","content":" 1. ì •ì˜ # ê°€ìƒ ë©”ëª¨ë¦¬(Virtual Memory) ëŠ” í”„ë¡œì„¸ìŠ¤ê°€ ì‹¤ì œ ë¬¼ë¦¬ ë©”ëª¨ë¦¬ë³´ë‹¤ ë” í° ì£¼ì†Œ ê³µê°„ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜\në…¼ë¦¬ ì£¼ì†Œ â†” ë¬¼ë¦¬ ì£¼ì†Œ ë³€í™˜ì„ í†µí•´, í”„ë¡œì„¸ìŠ¤ëŠ” ë…ë¦½ëœ ë©”ëª¨ë¦¬ ê³µê°„ì„ ê°€ì§„ ê²ƒì²˜ëŸ¼ ë™ì‘í•  ìˆ˜ ìˆìŒ.\nëª©ì  # í”„ë¡œì„¸ìŠ¤ ê°„ ë©”ëª¨ë¦¬ ê²©ë¦¬ ë° ë³´í˜¸ ì‹¤ì œ ë©”ëª¨ë¦¬ë³´ë‹¤ í° ê³µê°„ ì§€ì› (ì£¼ì†Œ ì¶”ìƒí™”) í”„ë¡œê·¸ë¨ì˜ íš¨ìœ¨ì  ë¡œë”© ë° ì‹¤í–‰ (ë¶€ë¶„ ì ì¬, Demand Paging) 2. ì£¼ì†Œ ë³€í™˜ íë¦„ (Page ê¸°ë°˜) # ì£¼ì†Œ êµ¬ì¡°\n[ë…¼ë¦¬ ì£¼ì†Œ] = [í˜ì´ì§€ ë²ˆí˜¸] + [í˜ì´ì§€ ì˜¤í”„ì…‹] â†’ MMUê°€ í˜ì´ì§€ ë²ˆí˜¸ë¥¼ Page Table í†µí•´ ë¬¼ë¦¬ ë©”ëª¨ë¦¬ì˜ Frameìœ¼ë¡œ ë³€í™˜ â†’ ìµœì¢… ë¬¼ë¦¬ ì£¼ì†Œ = Frame ì‹œì‘ ì£¼ì†Œ + Offset e.g.\nê°€ìƒ ì£¼ì†Œ : 0x1234 (4KB í˜ì´ì§€ í¬ê¸°) -\u0026gt; í˜ì´ì§€ ë²ˆí˜¸ : 0x1, ì˜¤í”„ì…‹ : 0x234 -\u0026gt; Page Tableì—ì„œ Page 1ì´ Frame 5ì— ë§¤í•‘ë˜ì–´ ìˆìœ¼ë©´ -\u0026gt; ë¬¼ë¦¬ ì£¼ì†Œ = 5 * 4KB + 0x234 3. TLB(Translation Lookaside Buffer) # Page Tableì„ ë§¤ë²ˆ ì¡°íšŒí•˜ë©´ ì„±ëŠ¥ ì €í•˜ â†’ TLBëŠ” MMU ë‚´ë¶€ì— ìˆëŠ” ìºì‹œ ìµœê·¼ ì‚¬ìš©ëœ í˜ì´ì§€ ë²ˆí˜¸ì™€ í”„ë ˆì„ ë§¤í•‘ ì •ë³´ë¥¼ ì €ì¥ ìƒí™© ì„¤ëª… TLB Hit TLBì—ì„œ ë°”ë¡œ í”„ë ˆì„ ì£¼ì†Œ ì¡°íšŒ TLB Miss Page Table ì¡°íšŒ í•„ìš” â†’ TLB ê°±ì‹  =\u0026gt; TLBëŠ” ë§¤ìš° ë¹ ë¥´ì§€ë§Œ ìš©ëŸ‰ ì œí•œ ìˆìŒ -\u0026gt; LRU ê¸°ë°˜ ìºì‹œ ì •ì±… ì ìš©\n4. Demand Paging # ì‹¤ì œ í•„ìš”í•œ í˜ì´ì§€ë§Œ ë©”ëª¨ë¦¬ì— ë¡œë“œí•˜ëŠ” ë°©ì‹ (â†’ ì „ì²´ í”„ë¡œê·¸ë¨ì„ ì²˜ìŒë¶€í„° ë©”ëª¨ë¦¬ì— ì˜¬ë¦¬ì§€ ì•ŠìŒ)\níë¦„ # í”„ë¡œì„¸ìŠ¤ê°€ ì•„ì§ ë¡œë“œë˜ì§€ ì•Šì€ í˜ì´ì§€ ì ‘ê·¼ Page Fault ë°œìƒ (í•´ë‹¹ í˜ì´ì§€ ì—†ìŒ) ë””ìŠ¤í¬ì—ì„œ í•´ë‹¹ í˜ì´ì§€ ë¡œë“œ Page Table ë° TLB ê°±ì‹  í›„ ì¬ì‹œë„ ì¥ì  : ë©”ëª¨ë¦¬ ì ˆì•½, ë¹ ë¥¸ í”„ë¡œì„¸ìŠ¤ ì‹œì‘ ë‹¨ì  : Page Fault ì‹œ ë””ìŠ¤í¬ ì ‘ê·¼ -\u0026gt; ì‹¬ê°í•œ ì„±ëŠ¥ ì €í•˜\n5. í˜ì´ì§€ êµì²´ ì•Œê³ ë¦¬ì¦˜ # FIFO (First-In First-Out) ê°€ì¥ ì˜¤ë˜ëœ í˜ì´ì§€ë¥¼ ì œê±° êµ¬í˜„ì€ ì‰½ì§€ë§Œ, Belady\u0026rsquo;s anomaly ë°œìƒ ê°€ëŠ¥ (í˜ì´ì§€ ìˆ˜ â†‘ â†’ ì˜¤íˆë ¤ Miss â†‘) LRU (Least Recently Used) ê°€ì¥ ì˜¤ë«ë™ì•ˆ ì‚¬ìš©ë˜ì§€ ì•Šì€ í˜ì´ì§€ ì œê±° í˜„ì‹¤ì ì¸ ì„±ëŠ¥ ìš°ìˆ˜ â†’ êµ¬í˜„ì€ ìƒëŒ€ì ìœ¼ë¡œ ë³µì¡ Optimal (OPT) ì•ìœ¼ë¡œ ê°€ì¥ ì˜¤ë«ë™ì•ˆ ì‚¬ìš©ë˜ì§€ ì•Šì„ í˜ì´ì§€ ì œê±° ì´ìƒì ì¸ ì•Œê³ ë¦¬ì¦˜ (ì‹¤ì œë¡œ êµ¬í˜„ ë¶ˆê°€ â†’ ë²¤ì¹˜ë§ˆí¬ìš©) Clock ì•Œê³ ë¦¬ì¦˜ (Second Chance) LRU ê·¼ì‚¬ ë°©ì‹. ê° í˜ì´ì§€ì— reference bit ì‚¬ìš© ì›í˜• í ìˆœíšŒí•˜ë©° bit=0ì¸ í˜ì´ì§€ ì œê±° ì•Œê³ ë¦¬ì¦˜ íŠ¹ì§• ì„±ëŠ¥ êµ¬í˜„ ë‚œì´ë„ FIFO ë‹¨ìˆœ ë‚®ìŒ ì‰¬ì›€ LRU ì‹¤ì œ ìƒí™©ì— ì í•© ì¢‹ìŒ ì–´ë ¤ì›€ (stack/counter í•„ìš”) OPT ìµœì  ìµœê³  ë¶ˆê°€ëŠ¥ Clock LRU ê·¼ì‚¬ ì¤‘ìƒ ì¤‘ê°„ 6. Working Set \u0026amp; Thrashing # Working Set # ì§€ì—­ì„±ì„ ê¸°ë°˜ìœ¼ë¡œ ê°€ì¥ ë§ì´ ì‚¬ìš©í•˜ëŠ” í˜ì´ì§€ë¥¼ ë¯¸ë¦¬ ì €ì¥í•´ë‘” ê²ƒ ì¼ì • ì‹œê°„ ë™ì•ˆ ì°¸ì¡°ë˜ëŠ” í˜ì´ì§€ ì§‘í•© Thrashing # Working Setë³´ë‹¤ í• ë‹¹ëœ ë©”ëª¨ë¦¬ í”„ë ˆì„ì´ ì ì„ ë•Œ ë°œìƒ í˜ì´ì§€ êµì²´ê°€ ë¹ˆë²ˆíˆ ì¼ì–´ë‚˜ë©´ì„œ ì‹œìŠ¤í…œ ì „ì²´ ì„±ëŠ¥ ì €í•˜ í•´ê²° # í”„ë¡œì„¸ìŠ¤ ë³„ Working Set ê¸°ë°˜ í”„ë ˆì„ ë™ì  í• ë‹¹ í˜ì´ì§€ êµì²´ ì•Œê³ ë¦¬ì¦˜ ê°œì„  í”„ë¡œì„¸ìŠ¤ ìˆ˜ ì¡°ì ˆ 7. ì‹¤ë¬´ ì˜ˆì‹œ # ì‹œìŠ¤í…œ ê°€ìƒ ë©”ëª¨ë¦¬ ë™ì‘ Linux Demand Paging + Clock-based replacement (Clock-Pro) Windows Working Set ê¸°ë°˜ í”„ë ˆì„ ê´€ë¦¬ + Aging ì •ì±… Docker/Container Namespace ë° CGroup ê¸°ë°˜ ë©”ëª¨ë¦¬ ê²©ë¦¬, ê°€ìƒ ì£¼ì†Œ ì‚¬ìš© JVM Heap ì˜ì—­ì´ ë…¼ë¦¬ ì£¼ì†Œ â†’ ì‹¤ì œ ë¬¼ë¦¬ í• ë‹¹ì€ GCì™€ OSê°€ ê²°ì • 8. ìì£¼ ë¬»ëŠ” ë©´ì ‘ ì§ˆë¬¸ # Q1. í˜ì´ì§€ êµì²´ ì•Œê³ ë¦¬ì¦˜ ì¤‘ ê°€ì¥ ì¢‹ì€ ê±´?\nA.\nì´ë¡ ì ìœ¼ë¡œëŠ” OPTê°€ ê°€ì¥ ìš°ìˆ˜í•˜ë‚˜ ì‹¤ì œ êµ¬í˜„ ë¶ˆê°€. LRUê°€ í˜„ì‹¤ì ìœ¼ë¡œ ê°€ì¥ ê· í˜• ì¡í˜. Clock ì•Œê³ ë¦¬ì¦˜ì€ êµ¬í˜„ê³¼ ì„±ëŠ¥ì˜ íŠ¸ë ˆì´ë“œì˜¤í”„ë¥¼ ì˜ ë°˜ì˜í•œ ë°©ì‹. Q2. TLB Missê°€ ìì£¼ ë°œìƒí•˜ëŠ” ì´ìœ ì™€ í•´ê²° ë°©ë²•ì€?\nA.\ní”„ë¡œì„¸ìŠ¤ ì „í™˜ ì‹œ TLB ë‚´ìš©ì´ ë¬´íš¨í™”ë˜ê¸° ë•Œë¬¸ â†’ Context Switch + Address Space Identifier(ASID) ì‚¬ìš©ìœ¼ë¡œ ì™„í™” ê°€ëŠ¥. Q3. Thrashingì´ ë°œìƒí•˜ëŠ” ì´ìœ ëŠ”?\nA. Working Setë³´ë‹¤ ì‘ì€ ìˆ˜ì˜ í”„ë ˆì„ í• ë‹¹ â†’ ê³„ì† í˜ì´ì§€ êµì²´ ë°œìƒ â†’ CPUë³´ë‹¤ I/Oê°€ ë°”ë¹ ì§ â†’ ì‹œìŠ¤í…œ ì •ì²´\nQ4. Page Faultê°€ ë°œìƒí–ˆì„ ë•Œ ì²˜ë¦¬ ê³¼ì •ì€?\nMMUê°€ Page Table í™•ì¸ â†’ ì—†ëŠ” í˜ì´ì§€ OSê°€ ë””ìŠ¤í¬ì—ì„œ í˜ì´ì§€ ë¡œë”© Page Table ê°±ì‹  TLB ê°±ì‹  í”„ë¡œì„¸ìŠ¤ ì¬ì‹œë„ "},{"id":7,"href":"/docs/%EC%BB%B4%ED%93%A8%ED%84%B0%EC%9D%B4%EB%A1%A0/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C/7-file-system/","title":"7. File System","section":"ìš´ì˜ì²´ì œ","content":" 1. íŒŒì¼ ì‹œìŠ¤í…œì˜ ì—­í•  # ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³ , íƒìƒ‰í•˜ê³ , ë³´í˜¸í•˜ëŠ” ê³„ì¸µ ì €ì¥ ì¥ì¹˜(HDD, SSD ë“±)ì˜ ì¶”ìƒí™” ê³„ì¸µì„ ì œê³µ ìš´ì˜ì²´ì œëŠ” íŒŒì¼ ì‹œìŠ¤í…œì„ í†µí•´ íŒŒì¼/ë””ë ‰í† ë¦¬ë¥¼ ê´€ë¦¬í•¨ 2. inodeì™€ ë””ë ‰í„°ë¦¬ êµ¬ì¡° # inode (Index Node) # íŒŒì¼ì˜ metadataë¥¼ ì €ì¥í•˜ëŠ” êµ¬ì¡°ì²´ ê° íŒŒì¼ì€ ê³ ìœ í•œ inode ë²ˆí˜¸ë¥¼ ê°€ì§ (inode tableì— ì €ì¥) í¬í•¨ ì •ë³´ ì˜ˆì‹œ íŒŒì¼ í¬ê¸° 512KB ìƒì„±/ìˆ˜ì •/ì ‘ê·¼ ì‹œê°„ stat ëª…ë ¹ìœ¼ë¡œ í™•ì¸ ì ‘ê·¼ ê¶Œí•œ rwxr-xrâ€“ ë§í¬ ìˆ˜ hard link ê°œìˆ˜ ë””ìŠ¤í¬ ë¸”ë¡ ìœ„ì¹˜ ì •ë³´ ì§ì ‘/ê°„ì ‘ ë¸”ë¡ ì£¼ì†Œ í¬í•¨ =\u0026gt; inodeëŠ” filenameì€ ì €ì¥í•˜ì§€ ì•ŠìŒ -\u0026gt; directory entryê°€ filenameê³¼ inode ë²ˆí˜¸ë¥¼ ë§¤í•‘\në””ë ‰í„°ë¦¬ êµ¬ì¡° # ë””ë ‰í„°ë¦¬ = (íŒŒì¼ëª… \u0026lt;-\u0026gt; inode ë²ˆí˜¸)ì˜ ëª©ë¡ ê³„ì¸µì  íŠ¸ë¦¬ êµ¬ì¡° (/, /home, /home/user/file.txt) 3. íŒŒì¼ í• ë‹¹ ë°©ì‹ # 1) ì—°ì† í• ë‹¹ (Continguous Allocation) # ì—°ì†ëœ ë””ìŠ¤í¬ ë¸”ë¡ì— íŒŒì¼ ì €ì¥\nì¥ì  ë‹¨ì  ë¹ ë¥¸ ì ‘ê·¼ íŒŒì¼ í¬ê¸° ë³€ê²½ ì–´ë ¤ì›€, ì™¸ë¶€ ë‹¨í¸í™” -\u0026gt; CD-ROM ë“± ì½ê¸° ì „ìš© ë¯¸ë””ì–´ì— ì í•©\n2) ì—°ê²° í• ë‹¹ (Linked Allocation) # ê° ë¸”ë¡ì´ ë‹¤ìŒ ë¸”ë¡ì˜ í¬ì¸í„°ë¥¼ í¬í•¨ ì¥ì  ë‹¨ì  íŒŒì¼ í¬ê¸° ë™ì  ë³€ê²½ ê°€ëŠ¥ ì„ì˜ ì ‘ê·¼ ì†ë„ ëŠë¦¼ (ëœë¤ ì•¡ì„¸ìŠ¤ ë¶ˆê°€) -\u0026gt; FAT (File Allocation Table)ì´ ëŒ€í‘œì ì¸ ì˜ˆ\n3) ì¸ë±ìŠ¤ í• ë‹¹ (Indexed Allocation) # ë³„ë„ì˜ ì¸ë±ìŠ¤ ë¸”ë¡ì— ëª¨ë“  ë°ì´í„° ë¸”ë¡ ì£¼ì†Œ ì €ì¥ ì¥ì  ë‹¨ì  ë¹ ë¥¸ ì„ì˜ ì ‘ê·¼ ì¸ë±ìŠ¤ ë¸”ë¡ì˜ í¬ê¸° ì œí•œ ìˆìŒ -\u0026gt; Unix íŒŒì¼ ì‹œìŠ¤í…œì´ ëŒ€í‘œì  (inode ë‚´ë¶€ê°€ ì¸ë±ìŠ¤ ì—­í• )\nUnix inode êµ¬ì¡° - ì§ì ‘/ê°„ì ‘ ë¸”ë¡ # ë¸”ë¡ ì„¤ëª… ì§ì ‘ ë¸”ë¡ (0~11) ë°”ë¡œ ë°ì´í„° ë¸”ë¡ ì£¼ì†Œ ë‹¨ì¼ ê°„ì ‘ ë¸”ë¡ í¬ì¸í„° â†’ ë°ì´í„° ë¸”ë¡ ì£¼ì†Œë“¤ ì´ì¤‘ ê°„ì ‘ ë¸”ë¡ í¬ì¸í„° â†’ í¬ì¸í„° â†’ ë°ì´í„° ë¸”ë¡ ì‚¼ì¤‘ ê°„ì ‘ ë¸”ë¡ í¬ì¸í„° Ã—3 â†’ ë§¤ìš° í° íŒŒì¼ ì§€ì› ğŸ“Œ ìˆ˜ë°± MB ~ ìˆ˜ì‹­ GB í¬ê¸° íŒŒì¼ë„ í™•ì¥ ê°€ëŠ¥\n4. íŒŒì¼ ì ‘ê·¼ ê¶Œí•œ ë° ì ‘ê·¼ ì œì–´ # Unix í¼ë¯¸ì…˜ êµ¬ì¡° (rwx) # ì„¸ ê·¸ë£¹ìœ¼ë¡œ ë¶„ë¦¬: ì†Œìœ ì / ê·¸ë£¹ / ê¸°íƒ€ ì‚¬ìš©ì ê° ê·¸ë£¹ì— ëŒ€í•´ read(r), write(w), execute(x) ê¶Œí•œ ë¶€ì—¬ ì˜ˆì‹œ ì˜ë¯¸ -rwxr-xr\u0026ndash; ì†Œìœ ì: rwx, ê·¸ë£¹: r-x, ê¸°íƒ€: râ€“ chmod 755 file rwxr-xr-x ê¶Œí•œ ì„¤ì • ì ‘ê·¼ ì œì–´ í™•ì¥ (ACL, Capability) # ACL: íŒŒì¼ë³„ë¡œ ì‚¬ìš©ìë§ˆë‹¤ ì„¸ë°€í•œ ê¶Œí•œ ì„¤ì • Capabilities: ì»¤ë„ì—ì„œ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ë™ì‘ ë‹¨ìœ„ ê¶Œí•œí™” 5. ì‹¤ë¬´ ì˜ˆì‹œ # ì‹œìŠ¤í…œ íŠ¹ì§• ext4 (Linux) inode ê¸°ë°˜, ì €ë„ë§ ì§€ì›, ì„±ìˆ™í•œ ì•ˆì •ì„± FAT32 (USB ë“±) ì—°ê²° í• ë‹¹ ë°©ì‹, ë‹¨ìˆœí•˜ì§€ë§Œ í•œê³„ ìˆìŒ NTFS (Windows) ì¸ë±ìŠ¤ + ACL ê¸°ë°˜, ëŒ€ìš©ëŸ‰/ë³´ì•ˆ ì§€ì› ZFS / Btrfs Copy-on-Write, ìŠ¤ëƒ…ìƒ·, ì²´í¬ì„¬ í¬í•¨ 6. ìì£¼ ë¬»ëŠ” ë©´ì ‘ ì§ˆë¬¸ # Q1. inodeëŠ” ì–´ë–¤ ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆë‚˜ìš”?\nA.\níŒŒì¼ì˜ ë©”íƒ€ë°ì´í„°(í¬ê¸°, ìƒì„±/ìˆ˜ì • ì‹œê°, ê¶Œí•œ, ë§í¬ ìˆ˜, ë””ìŠ¤í¬ ë¸”ë¡ ìœ„ì¹˜)ë¥¼ ì €ì¥í•˜ë©°, íŒŒì¼ëª…ì€ í¬í•¨ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. íŒŒì¼ëª…ì€ ë””ë ‰í† ë¦¬ ì—”íŠ¸ë¦¬ì—ì„œ inode ë²ˆí˜¸ì™€ ë§¤í•‘ë©ë‹ˆë‹¤. Q2. ì—°ì†/ì—°ê²°/ì¸ë±ìŠ¤ í• ë‹¹ì˜ ì°¨ì´ë¥¼ ì„¤ëª…í•´ì£¼ì„¸ìš”.\nA.\në°©ì‹ ì ‘ê·¼ ì„±ëŠ¥ íŒŒì¼ í¬ê¸° ìœ ì—°ì„± ë‹¨í¸í™” ì—°ì† ë¹ ë¦„ (ì„ì˜ ì ‘ê·¼ ê°€ëŠ¥) ë‚®ìŒ ì™¸ë¶€ ë‹¨í¸í™” ì—°ê²° ëŠë¦¼ (ìˆœì°¨ ì ‘ê·¼ë§Œ) ë†’ìŒ ì—†ìŒ ì¸ë±ìŠ¤ ë¹ ë¦„ (ì„ì˜ ì ‘ê·¼ ê°€ëŠ¥) ë†’ìŒ ê±°ì˜ ì—†ìŒ Q3. ëŒ€ìš©ëŸ‰ íŒŒì¼ì„ inodeë¡œ ì–´ë–»ê²Œ ì €ì¥í•˜ë‚˜ìš”?\nA.\nUnix inodeëŠ” ì§ì ‘ ë¸”ë¡ìœ¼ë¡œ ì‹œì‘í•˜ì—¬, ë‹¨ì¼ â†’ ì´ì¤‘ â†’ ì‚¼ì¤‘ ê°„ì ‘ ë¸”ë¡ìœ¼ë¡œ í™•ì¥í•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¥¼ í†µí•´ ìˆ˜ì‹­ GBê¹Œì§€ì˜ ëŒ€ìš©ëŸ‰ íŒŒì¼ì„ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Q4. íŒŒì¼ ì‹œìŠ¤í…œì—ì„œ â€˜íŒŒì¼ëª…â€™ì€ ì–´ë””ì— ì €ì¥ë˜ë‚˜ìš”?\nA.\në””ë ‰í† ë¦¬ ì—”íŠ¸ë¦¬ì— ì €ì¥ë©ë‹ˆë‹¤. ë””ë ‰í† ë¦¬ëŠ” (íŒŒì¼ëª… â†’ inode ë²ˆí˜¸) ë§¤í•‘ í…Œì´ë¸”ì´ë©°, ì‹¤ì œ íŒŒì¼ ì •ë³´ëŠ” í•´ë‹¹ inodeì— ìˆìŒ. "},{"id":8,"href":"/docs/data-lake-platform/ceph/rbd-sc/","title":"Ceph RBD ì„¤ì •í•˜ê¸°(Block Storage)","section":"Ceph","content":" Ceph RBDë¥¼ Kubernetes PVCë¡œ ì—°ë™í•˜ê¸° # ìˆœì„œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.\nRBDìš© Pool ìƒì„± StorageClass ìƒì„± PVC ìƒì„± PVCë¥¼ ì‚¬ìš©í•˜ëŠ” í…ŒìŠ¤íŠ¸ Pod ìƒì„± ì •ìƒ Mount ì—¬ë¶€ í™•ì¸ 1. RDBìš© Pool ìƒì„± # kubectl -n rook-ceph exec -it deploy/rook-ceph-tools -- bash ë¡œ rook-ceph-toolsì— ì ‘ì†í•´ì„œ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ìˆ˜í–‰í•œë‹¤.\nceph osd pool create {Poolëª…} {PG ìˆ˜} PGë€?\nPlacement Groupì˜ ì•½ì Cephì—ì„œëŠ” ë°ì´í„°ë¥¼ ê³§ë°”ë¡œ OSDì— ì €ì¥í•˜ëŠ” ê²Œ ì•„ë‹Œ, ì¤‘ê°„ì— PGë¥¼ ê±°ì³ ì €ì¥í•¨ ë°ì´í„°ë¥¼ ì—¬ëŸ¬ OSDì— ë¶„ì‚° ì €ì¥í•  ë•Œ \u0026ldquo;ë¶„ì‚°ì˜ ë‹¨ìœ„\u0026rdquo; ì—­í• ì„ í•¨ ë°ì´í„°ê°€ ì €ì¥ë  ìœ„ì¹˜ë¥¼ ê²°ì •í•  ë•Œ, \u0026ldquo;Pool -\u0026gt; PG -\u0026gt; OSD\u0026quot;ë¼ëŠ” ê²½ë¡œë¥¼ í†µí•´ ê²°ì •í•¨ ë³µì œë„ PG ë‹¨ìœ„ë¡œ ê´€ë¦¬í•¨ êµ¬ë¶„ ì„¤ëª… OSD ì‹¤ì œ ë””ìŠ¤í¬ì— ì €ì¥í•˜ëŠ” ë‹¨ìœ„ (Object Storage Daemon) PG (Placement Group) ì—¬ëŸ¬ OSD ì‚¬ì´ì—ì„œ ë°ì´í„°ë¥¼ ë°°ì¹˜(placement)í•˜ê³  ê·¸ë£¹í•‘í•˜ëŠ” ë…¼ë¦¬ ë‹¨ìœ„ Object ì‚¬ìš©ì ë°ì´í„° (íŒŒì¼, ë¸”ë¡ ë“±)ë¥¼ ìª¼ê°  ì‹¤ì œ ì €ì¥ ë‹¨ìœ„ ì¦‰, ë°ì´í„°ì˜ íë¦„ì€ ë‹¤ìŒê³¼ ê°™ë‹¤\nClient -\u0026gt; Pool -\u0026gt; Placement Group (PG) -\u0026gt; OSD PG ìˆ˜ ì •í•˜ê¸° # PG ìˆ˜ëŠ” OSD ê°œìˆ˜ì™€ Replication Factor(ë³µì œë³¸ ê°œìˆ˜)ë¥¼ ê³ ë ¤í•´ì„œ ì •í•´ì•¼í•œë‹¤. ê¸°ë³¸ì ì¸ ê³µì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.\n$PGÂ ìˆ˜â‰ˆ(OSDÂ ê°œìˆ˜)Ã—100Ã·ë³µì œë³¸Â ìˆ˜Â (replica)$\ní˜„ì¬ ë‚´ ì„œë²„ì˜ ìƒí™©ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.\nOSD 3ê°œ ë³µì œë³¸(replica) ê¸°ë³¸ 3ê°œ ~\u0026gt; 100ê°œ ì •ë„ê°€ ê¶Œì¥ë¨\n-\u0026gt; ë”°ë¼ì„œ Cephì˜ ê¸°ë³¸ ê¶Œì¥ì¹˜ ì¤‘ í•˜ë‚˜ì¸ 128ê°œë¡œ ì„ íƒí•¨ PG ìˆ˜ëŠ” ë„ˆë¬´ ì ìœ¼ë©´ ë°ì´í„° ë¶„ì‚°ì´ ë¹„íš¨ìœ¨ì ì´ê³ , ë„ˆë¬´ ë§ìœ¼ë©´ OSD ê´€ë¦¬ ë¶€í•˜ê°€ ì»¤ì§„ë‹¤. (3~5ê°œ OSDë¡œ ì‹œì‘í•  ë• 128 ì •ë„ê°€ ì ë‹¹í•¨)\n2. RBD StorageClass ìƒì„±í•˜ê¸° # Ceph POol(replicapool)ì„ k8sì—ì„œ ì“¸ ìˆ˜ ìˆë„ë¡ StorageClassë¥¼ ë§Œë“¤ì–´ì•¼ í•œë‹¤.\napiVersion: storage.k8s.io/v1 kind: StorageClass metadata: name: rook-ceph-block provisioner: rook-ceph.rbd.csi.ceph.com parameters: clusterID: rook-ceph pool: replicapool imageFormat: \u0026#34;2\u0026#34; imageFeatures: layering csi.storage.k8s.io/provisioner-secret-name: rook-csi-rbd-provisioner csi.storage.k8s.io/provisioner-secret-namespace: rook-ceph csi.storage.k8s.io/node-stage-secret-name: rook-csi-rbd-node csi.storage.k8s.io/node-stage-secret-namespace: rook-ceph reclaimPolicy: Delete allowVolumeExpansion: true 3. PVC + PVCë¥¼ ì‚¬ìš©í•˜ëŠ” í…ŒìŠ¤íŠ¸ Pod ìƒì„± # # rbd-pvc-test.yaml apiVersion: v1 kind: PersistentVolumeClaim metadata: name: rbd-pvc namespace: default spec: storageClassName: rook-ceph-block accessModes: - ReadWriteOnce resources: requests: storage: 1Gi --- apiVersion: v1 kind: Pod metadata: name: rbd-pod namespace: default spec: containers: - name: rbd-container image: busybox command: [\u0026#34;/bin/sh\u0026#34;, \u0026#34;-c\u0026#34;, \u0026#34;sleep 3600\u0026#34;] volumeMounts: - mountPath: \u0026#34;/mnt/rbd\u0026#34; name: rbd-vol volumes: - name: rbd-vol persistentVolumeClaim: claimName: rbd-pvc 4. ì •ìƒ Mount ì—¬ë¶€ í™•ì¸ # kubectl -n test exec -it rbd-pod -- sh # ë‚´ë¶€ ì§„ì… í›„ ls /mnt/rbd # =\u0026gt; ì •ìƒì ìœ¼ë¡œ ë””ë ‰í† ë¦¬ ì ‘ê·¼ ê°€ëŠ¥ "},{"id":9,"href":"/docs/data-lake-platform/ceph/ceph-installation/","title":"Ceph ê°œìš” ë° êµ¬ì¶•í•˜ê¸°","section":"Ceph","content":" Cephì´ë€? # ì™„ì „íˆ ë¶„ì‚°ë˜ê³ , í™•ì¥ì„±ê³¼ ê³ ê°€ìš©ì„±ì„ ì§€í–¥í•˜ëŠ” storage platform\ní•µì‹¬ ëª©í‘œ\në‹¨ì¼ í´ëŸ¬ìŠ¤í„°ì—ì„œ Object Storage, Block Storage, File System ëª¨ë‘ ì œê³µ ë¶„ì‚°ì„±, Self-Healing, ë¬´ì¤‘ë‹¨ í™•ì¥ì„ ê¸°ë³¸ ì„¤ê³„ ì² í•™ìœ¼ë¡œ ë‘  í•˜ë“œì›¨ì–´ì— ì¢…ì†ë˜ì§€ ì•Šê³  x86 ì„œë²„ + disk ì¡°í•©ìœ¼ë¡œ ëŒ€ê·œëª¨ ìŠ¤í† ë¦¬ì§€ ì‹œìŠ¤í…œ êµ¬ì¶• ê°€ëŠ¥ ì£¼ìš” íŠ¹ì§•\nCRUSH ì•Œê³ ë¦¬ì¦˜(Controlled Replication Under Scalable Hashing) ê¸°ë°˜ ë¶„ì‚° ë°ì´í„° ë§µí•‘. ë³„ë„ì˜ ì¤‘ì•™ ë©”íƒ€ë°ì´í„° ì„œë²„ ì—†ì´ ë°ì´í„° ìœ„ì¹˜ ê²°ì • (Object Storage). ì¥ì•  ë°œìƒ ì‹œ ìë™ ë³µêµ¬(Self Healing). ìˆ˜í‰ í™•ì¥(linear scalability) ê°€ëŠ¥ (ë…¸ë“œ ì¶”ê°€ë§Œìœ¼ë¡œ í™•ì¥). ë‹¤ì–‘í•œ ì¸í„°í˜ì´ìŠ¤ ì œê³µ: S3 í˜¸í™˜(Object), RBD(Block), CephFS(File System). Cephì˜ êµ¬ì„±ìš”ì†Œ # ì»´í¬ë„ŒíŠ¸ ì„¤ëª… MON (Monitor) Ceph í´ëŸ¬ìŠ¤í„°ì˜ ë§µ ê´€ë¦¬ì™€ Quorum(í•©ì˜)ì„ ë‹´ë‹¹.\n- ëª¨ë“  í´ëŸ¬ìŠ¤í„° ìƒíƒœ(MAP) ì €ì¥\n- 3ê°œ ì´ìƒ ì¶”ì²œ (í•­ìƒ í™€ìˆ˜) MGR (Manager) Cephì˜ ìƒíƒœ ëª¨ë‹ˆí„°ë§, ëª¨ë“ˆ ê´€ë¦¬ ë‹´ë‹¹.\n- ëŒ€ì‹œë³´ë“œ, ëª¨ë‹ˆí„°ë§ í†µí•©, Prometheus Exporter ì œê³µ\n- 1 active + 1 standby í˜•íƒœë¡œ êµ¬ì„± ì¶”ì²œ OSD (Object Storage Daemon) ì‹¤ì œ ë°ì´í„° ì €ì¥.\n- ë¬¼ë¦¬ ë””ìŠ¤í¬ í•˜ë‚˜ë‹¹ 1 OSD í”„ë¡œì„¸ìŠ¤\n- Ceph Pool ë³µì œ(replication), ë°ì´í„° ë³µêµ¬, ë¦¬ë°¸ëŸ°ì‹± ë‹´ë‹¹ MDS (Metadata Server) CephFS(íŒŒì¼ì‹œìŠ¤í…œ) ë©”íƒ€ë°ì´í„° ê´€ë¦¬.\n- ë¸”ë¡/ì˜¤ë¸Œì íŠ¸ëŠ” í•„ìš” ì—†ìŒ. CephFS ì“¸ ë•Œë§Œ í•„ìš” RGW (Rados Gateway) S3, Swift APIë¥¼ ì œê³µí•˜ëŠ” ê²Œì´íŠ¸ì›¨ì´.\n- ì˜¤ë¸Œì íŠ¸ ìŠ¤í† ë¦¬ì§€ ì ‘ì†ìš© ì„œë¹„ìŠ¤ CSI Driver Kubernetes PVCë¥¼ Ceph RBD, CephFSì™€ ì—°ê²°í•˜ëŠ” ì—­í• .\n- Rook Operatorê°€ ìë™ìœ¼ë¡œ ì„¤ì¹˜ ì €ì¥ ë°©ì‹ í•„ìš”í•œ ì»´í¬ë„ŒíŠ¸ Block Storage (RBD) MON, MGR, OSD Object Storage (S3) MON, MGR, OSD, RGW File Storage (CephFS) MON, MGR, OSD, MDS helm repo add {rook_repoëª…} https://charts.rook.io/release helm install {rook-ceph_chartëª…} rook/rook-ceph --version 1.17.0 Ceph êµ¬ì¶•í•˜ê¸° # ceph-cluster.yaml apiVersion: ceph.rook.io/v1 kind: CephCluster metadata: name: rook-ceph namespace: rook-ceph spec: cephVersion: image: quay.io/ceph/ceph:v19.2.2 allowUnsupported: false dataDirHostPath: /var/lib/rook skipUpgradeChecks: false continueUpgradeAfterChecksEvenIfNotHealthy: false mon: count: 3 allowMultiplePerNode: false mgr: count: 2 allowMultiplePerNode: false dashboard: enabled: true ssl: false monitoring: enabled: false network: connections: encryption: enabled: false compression: enabled: false requireMsgr2: false crashCollector: disable: false logCollector: enabled: true periodicity: daily maxLogSize: 500M cleanupPolicy: confirmation: \u0026#34;\u0026#34; sanitizeDisks: method: quick dataSource: zero iteration: 1 allowUninstallWithVolumes: false removeOSDsIfOutAndSafeToRemove: false priorityClassNames: mon: system-node-critical osd: system-node-critical mgr: system-cluster-critical storage: useAllNodes: true useAllDevices: true config: # í•„ìš”í•œ ê²½ìš° ì—¬ê¸°ì— ì¶”ê°€ ì„¤ì • ê°€ëŠ¥ (ex. databaseSizeMB) allowDeviceClassUpdate: false allowOsdCrushWeightUpdate: false scheduleAlways: false onlyApplyOSDPlacement: false disruptionManagement: managePodBudgets: true osdMaintenanceTimeout: 30 csi: readAffinity: enabled: false cephfs: # fuseMountOptions, kernelMountOptions ì„¤ì • ê°€ëŠ¥ (ê¸°ë³¸ì€ ë¹„ì›Œë‘ ) healthCheck: daemonHealth: mon: disabled: false interval: 45s osd: disabled: false interval: 60s status: disabled: false interval: 60s livenessProbe: mon: disabled: false mgr: disabled: false osd: disabled: false startupProbe: mon: disabled: false mgr: disabled: false osd: disabled: false ì¢€ ë” ê°„ë‹¨í•˜ê²Œ í•˜ê³ ì‹¶ë‹¤ë©´,\nceph-cluster-short.yaml apiVersion: ceph.rook.io/v1 kind: CephCluster metadata: name: rook-ceph namespace: rook-ceph spec: cephVersion: image: quay.io/ceph/ceph:v19.2.2 dataDirHostPath: /var/lib/rook mon: count: 3 allowMultiplePerNode: false dashboard: enabled: true ssl: false storage: useAllNodes: true useAllDevices: true config: {} disruptionManagement: managePodBudgets: true í•˜ì§€ë§Œ í˜„ì¬ ìƒí™©ì—ì„œ ë¦¬ì†ŒìŠ¤ê°€ ì—¬ìœ ë¡­ì§„ ì•Šìœ¼ë‹ˆ,\nceph-cluster-limit.yaml apiVersion: ceph.rook.io/v1 kind: CephCluster metadata: name: rook-ceph namespace: rook-ceph spec: cephVersion: image: quay.io/ceph/ceph:v18.2.2 allowUnsupported: false dataDirHostPath: /var/lib/rook mon: count: 3 allowMultiplePerNode: false mgr: count: 1 allowMultiplePerNode: false dashboard: enabled: true ssl: false crashCollector: # ğŸ”» ë¹„í™œì„±í™” disable: true logCollector: enabled: true periodicity: daily maxLogSize: 500M storage: useAllNodes: true useAllDevices: false deviceFilter: \u0026#34;vdb\u0026#34; config: osdsPerDevice: \u0026#34;1\u0026#34; disruptionManagement: managePodBudgets: true osdMaintenanceTimeout: 30 priorityClassNames: mon: system-node-critical osd: system-node-critical mgr: system-cluster-critical healthCheck: daemonHealth: mon: disabled: false interval: 45s osd: disabled: false interval: 60s status: disabled: false interval: 60s resources: # ğŸ”§ ê° ë°ëª¬ë³„ ë¦¬ì†ŒìŠ¤ ì œí•œ mgr: limits: cpu: \u0026#34;250m\u0026#34; memory: \u0026#34;256Mi\u0026#34; requests: cpu: \u0026#34;100m\u0026#34; memory: \u0026#34;128Mi\u0026#34; mon: limits: cpu: \u0026#34;500m\u0026#34; memory: \u0026#34;512Mi\u0026#34; requests: cpu: \u0026#34;250m\u0026#34; memory: \u0026#34;256Mi\u0026#34; osd: limits: cpu: \u0026#34;1000m\u0026#34; memory: \u0026#34;2Gi\u0026#34; requests: cpu: \u0026#34;500m\u0026#34; memory: \u0026#34;1Gi\u0026#34; ì ìš© í¬ì¸íŠ¸ # í•­ëª© ì„¤ì • ë‚´ìš© Namespace rook-ceph Ceph Version v19.2.2 (Squid ìµœì‹  ì•ˆì •íŒ) Mon Count 3ê°œ Mgr Count 2ê°œ (Active + Standby) OSD êµ¬ì„± useAllDevices: true (vdb ìë™ ì¸ì‹) Dashboard í™œì„±í™”, SSL ë„ê¸° (HTTP) Disk Encryption ì‚¬ìš© ì•ˆ í•¨ (ë‚´ë¶€ë§ ê³ ë ¤) Monitoring ë¹„í™œì„±í™” (Prometheus ì•„ì§ ì„¤ì¹˜ ì•ˆ ë˜ì–´ ìˆìŒ) CrashCollector/LogCollector í™œì„±í™” Disruption Management í™œì„±í™” (PodDisruptionBudget ì ìš©) CleanUp Policy ê¸°ë³¸ê°’ (ë°ì´í„° ë³´ì¡´) Future Expansion Worker, OSD ì¶”ê°€ ìš©ì´í•˜ê²Œ ì„¤ì • \u0026ldquo;If you want all nodes and all available devices to be used automatically, set useAllNodes: true and useAllDevices: true. Specifying nodes: list is only necessary when you want fine-grained control over device selection.\u0026rdquo;\u0026quot;\ní˜„ì¬ worker 3,4,5ë§Œ vdbê°€ ì¶”ê°€ë˜ì–´ìˆì–´ì„œ ìë™ìœ¼ë¡œ w3,w4,w5ì—ë§Œ OSDê°€ ìƒì„±ë¨ ì¶”ê°€ë¡œ w6, w7ì— vdb ì¶”ê°€í•˜ë©´ ìë™ìœ¼ë¡œ OSDë„ í™•ì¥ë¨ í•­ëª© ì¼ë°˜ ì„¤ì • ì´ìœ  skipUpgradeChecks: false ì—…ê·¸ë ˆì´ë“œ ì‹œ cluster health ì²´í¬í•¨ (ì•ˆì •ì„±) allowMultiplePerNode: false ê°™ì€ ë…¸ë“œì— MON 2ê°œ ìƒì„± ë°©ì§€ (HA ë³´ì¥) dashboard.ssl: false ë‚´ë¶€ë§ì´ë©´ SSL ë¶ˆí•„ìš”, ìš´ì˜ í¸ì˜ì„± useAllDevices: true ìë™ ë””ë°”ì´ìŠ¤ ì¸ì‹, ë””ìŠ¤í¬ ì¶”ê°€ì‹œ í™•ì¥ì„± managePodBudgets: true PodDisruptionBudget ì ìš©, ì¥ì• /ë…¸ë“œDrain ì‹œ ì•ˆì •ì„± logCollector: enabled: true ì¥ì•  ë¶„ì„ ìœ„í•´ daemon ë¡œê·¸ íŒŒì¼ ì €ì¥ crashCollector: disable: false crash ë°œìƒ ì‹œ crash report ìˆ˜ì§‘ healthCheck: í™œì„±í™” MON, OSD, MGR ì£¼ê¸°ì ìœ¼ë¡œ ìƒíƒœ ì ê²€ "},{"id":10,"href":"/docs/data-lake-platform/ceph/ceph-install-guide-short/","title":"Ceph êµ¬ì¶•í•˜ê¸° - ìš”ì•½ë³¸","section":"Ceph","content":" 1. Rook Operator ë°°í¬ # # ê³µì‹ Helm ì°¨íŠ¸ë¡œ ì„¤ì¹˜ helm repo add rook-release https://charts.rook.io/release helm repo update # ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„± kubectl create ns rook-ceph # Operator ì„¤ì¹˜ helm install rook-ceph rook-release/rook-ceph --namespace rook-ceph 2. CephCluster ë¦¬ì†ŒìŠ¤ ë°°í¬ # ceph-cluster.yaml apiVersion: ceph.rook.io/v1 kind: CephCluster metadata: name: rook-ceph namespace: rook-ceph spec: cephVersion: image: quay.io/ceph/ceph:v18.2.2 allowUnsupported: false dataDirHostPath: /var/lib/rook mon: count: 3 allowMultiplePerNode: false mgr: count: 1 allowMultiplePerNode: false dashboard: enabled: true ssl: false crashCollector: disable: true logCollector: enabled: true periodicity: daily maxLogSize: 500M storage: useAllNodes: true useAllDevices: false deviceFilter: \u0026#34;vdb\u0026#34; config: osdsPerDevice: \u0026#34;1\u0026#34; disruptionManagement: managePodBudgets: true osdMaintenanceTimeout: 30 priorityClassNames: mon: system-node-critical osd: system-node-critical mgr: system-cluster-critical healthCheck: daemonHealth: mon: disabled: false interval: 45s osd: disabled: false interval: 60s status: disabled: false interval: 60s resources: # ğŸ”§ ê° ë°ëª¬ë³„ ë¦¬ì†ŒìŠ¤ ì œí•œ mgr: limits: cpu: \u0026#34;250m\u0026#34; memory: \u0026#34;256Mi\u0026#34; requests: cpu: \u0026#34;100m\u0026#34; memory: \u0026#34;128Mi\u0026#34; mon: limits: cpu: \u0026#34;500m\u0026#34; memory: \u0026#34;512Mi\u0026#34; requests: cpu: \u0026#34;250m\u0026#34; memory: \u0026#34;256Mi\u0026#34; osd: limits: cpu: \u0026#34;1000m\u0026#34; memory: \u0026#34;2Gi\u0026#34; requests: cpu: \u0026#34;500m\u0026#34; memory: \u0026#34;1Gi\u0026#34; k apply -f ceph-cluster.yamlë¥¼ ì‹¤í–‰í•´ ë¦¬ì†ŒìŠ¤ë¥¼ ë°°í¬í•œë‹¤.\nmon, mgr, osd ê°œìˆ˜ì™€ ì„¤ì • deviceFilterë¡œ ì‚¬ìš©í•  ë””ìŠ¤í¬ ì„ íƒ (vdb ë“±) ë¦¬ì†ŒìŠ¤ ì œí•œ health check, priority ì„¤ì • ë“± 3. RBDë¥¼ ìœ„í•œ CephBlockPool \u0026amp; StorageClasss êµ¬ì„± # CephBlockPool.yaml\napiVersion: ceph.rook.io/v1 kind: CephBlockPool metadata: name: replicapool namespace: rook-ceph spec: failureDomain: host replicated: size: 3 StorageClass.yaml\napiVersion: storage.k8s.io/v1 kind: StorageClass metadata: name: rook-ceph-block provisioner: rook-ceph.rbd.csi.ceph.com parameters: clusterID: rook-ceph pool: replicapool imageFormat: \u0026#34;2\u0026#34; imageFeatures: layering csi.storage.k8s.io/provisioner-secret-name: rook-csi-rbd-provisioner csi.storage.k8s.io/provisioner-secret-namespace: rook-ceph csi.storage.k8s.io/node-stage-secret-name: rook-csi-rbd-node csi.storage.k8s.io/node-stage-secret-namespace: rook-ceph reclaimPolicy: Delete allowVolumeExpansion: true mountOptions: - discard ìœ„ scë¥¼ ê¸°ì¤€ìœ¼ë¡œ pvcë¥¼ ìƒì„±í•˜ë©´ ìë™ìœ¼ë¡œ RBD ë³¼ë¥¨ì´ ìƒì„±ë¨.\n"},{"id":11,"href":"/docs/data-lake-platform/ceph/ceph-tools-pod/","title":"Ceph ì´ˆê¸° ì„¤ì •í•˜ê¸°","section":"Ceph","content":"cephê°€ ì •ìƒì ìœ¼ë¡œ ì„¤ì¹˜ëë‹¤ë©´ ë‹¤ìŒì˜ ì„¤ì •ë“¤ì„ ì¶”ê°€í•´ì¤€ë‹¤. ceph-toolsëŠ” ìš´ì˜ìê°€ ë‹¤ë£¨ëŠ” podë¼ì„œ ë”°ë¡œ ì¶”ê°€í•´ì¤˜ì•¼í•œë‹¤.\nrook-ceph-config.yaml\napiVersion: v1 kind: ConfigMap metadata: name: rook-ceph-config namespace: rook-ceph data: ceph.conf: | [global] fsid = cb669020-44b5-4528-bdf8-5f7e082cbf71 mon_host = 10.233.41.119,10.233.10.62,10.233.45.253 mon_initial_members = a,b,c auth_cluster_required = cephx auth_service_required = cephx auth_client_required = cephx log_to_stderr = false err_to_stderr = false log_to_syslog = false log_to_monitors = true fsid ê°’ê³¼ mon_host IPëŠ” ê° í´ëŸ¬ìŠ¤í„° í™˜ê²½ì— ë§ê²Œ ìˆ˜ì • í•„ìš”. rook-ceph-admin-keyring.yaml\napiVersion: v1 kind: Secret metadata: name: rook-ceph-admin-keyring namespace: rook-ceph type: Opaque stringData: ceph.client.admin.keyring: | [client.admin] key = AQAH+wFonT6EHhAAgGph5NeWPyTTO41HkFOpDg== caps mds = \u0026#34;allow *\u0026#34; caps mgr = \u0026#34;allow *\u0026#34; caps mon = \u0026#34;allow *\u0026#34; caps osd = \u0026#34;allow *\u0026#34; key = ~ ê°’ì€ Ceph Dashboard â†’ Admin ê³„ì • Exportë¡œ ê°€ì ¸ì˜¨ ê°’ ì‚¬ìš©. ì£¼ì˜: stringDataë¥¼ ì¨ì•¼ Base64 ì¸ì½”ë”© ì—†ì´ ë°”ë¡œ ì ìš©í•  ìˆ˜ ìˆìŒ.\n=\u0026gt; key ì´ë¦„ ì£¼ì˜: ceph.client.admin.keyring ì´ ì •í™•íˆ í•„ìš”í•¨. rook-ceph-tools.yaml apiVersion: apps/v1 kind: Deployment metadata: name: rook-ceph-tools namespace: rook-ceph spec: replicas: 1 selector: matchLabels: app: rook-ceph-tools template: metadata: labels: app: rook-ceph-tools spec: containers: - name: rook-ceph-tools image: rook/ceph:v1.12.10 command: [\u0026#34;/usr/bin/bash\u0026#34;] args: [\u0026#34;-c\u0026#34;, \u0026#34;sleep infinity\u0026#34;] imagePullPolicy: IfNotPresent securityContext: privileged: true volumeMounts: - name: ceph-conf mountPath: /etc/ceph volumes: - name: ceph-conf projected: sources: - configMap: name: rook-ceph-config items: - key: ceph.conf path: ceph.conf - secret: name: rook-ceph-admin-keyring items: - key: ceph.client.admin.keyring path: ceph.client.admin.keyring ì •ìƒ ë™ì‘ í™•ì¸ ë°©ë²•\nkubectl -n rook-ceph exec -it deploy/rook-ceph-tools -- bash ì— ë“¤ì–´ê°€ì„œ\ncat /etc/ceph/ceph.conf cat /etc/ceph/ceph.client.admin.keyring ceph status í•­ëª© ì„¤ëª… ConfigMap /etc/ceph/ceph.conf íŒŒì¼ì„ ì£¼ì…í•˜ê¸° ìœ„í•¨ Secret /etc/ceph/ceph.client.admin.keyring íŒŒì¼ì„ ì£¼ì…í•˜ê¸° ìœ„í•¨ rook-ceph-tools Deployment Toolbox Pod ìì²´, ìœ„ ConfigMap/Secretì„ /etc/cephì— mount Troubleshooting # ë¬¸ì œ ì›ì¸ í•´ê²° ë°©ë²• RADOS object not found ceph.conf, keyring ë‘˜ ë‹¤ ì—†ì—ˆìŒ ConfigMap, Secret ì£¼ì… Malformed input keyring í¬ë§· ë¬¸ì œ (key ê°’ í‹€ë¦¼) Dashboardì—ì„œ client.admin ë‚´ë³´ë‚´ê¸°ë¡œ key ì¶”ì¶œ í›„ ì ìš© FailedMount ì—ëŸ¬ key ì´ë¦„ mismatch (key ëŒ€ì‹  ceph.client.admin.keyring) Secret ì•ˆì— key ì´ë¦„ ìˆ˜ì • Toolbox ceph status ì‹¤íŒ¨ config, keyring ë‘˜ ì¤‘ í•˜ë‚˜ë¼ë„ ì˜ëª» mountë¨ ë‘˜ ë‹¤ ì œëŒ€ë¡œ ì ìš© í›„ ì„±ê³µ "},{"id":12,"href":"/docs/data-lake-platform/ceph/ceph-fs/","title":"CephFS êµ¬ì¶•í•˜ê¸°","section":"Ceph","content":" 1. CephFS Filesystem ìƒì„± # rook-ceph-filesystem.yaml\napiVersion: ceph.rook.io/v1 kind: CephFilesystem metadata: name: rook-ceph-fs namespace: rook-ceph spec: metadataPool: replicated: size: 3 dataPools: - replicated: size: 3 preserveFilesystemOnDelete: true metadataServer: activeCount: 1 activeStandby: true metadataPool, dataPools ëª¨ë‘ replication 3ê°œë¡œ ì„¤ì •(3 OSD) MDS(Metadata Server)ëŠ” 1 active + 1 standby (HA) 2. CephFSìš© StorageClass ìƒì„± # rook-cephfs-sc.yaml\napiVersion: storage.k8s.io/v1 kind: StorageClass metadata: name: rook-cephfs provisioner: rook-ceph.cephfs.csi.ceph.com parameters: clusterID: rook-ceph fsName: rook-ceph-fs pool: rook-ceph-fs-data0 csi.storage.k8s.io/provisioner-secret-name: rook-csi-cephfs-provisioner csi.storage.k8s.io/provisioner-secret-namespace: rook-ceph csi.storage.k8s.io/node-stage-secret-name: rook-csi-cephfs-node csi.storage.k8s.io/node-stage-secret-namespace: rook-ceph reclaimPolicy: Delete allowVolumeExpansion: true mountOptions: - noatime CephFSëŠ” rook-ceph-fs Filesystemì„ ë°”ë¼ë´„ Ceph CSIê°€ ìë™ìœ¼ë¡œ PV/PVCë¥¼ ìƒì„±í•˜ê³  Mountí•˜ë„ë¡ ì„¤ì •í•¨ noatime ì„¤ì •ìœ¼ë¡œ íŒŒì¼ ì ‘ê·¼ ì‹œê°„ ê¸°ë¡ì„ ë°©ì§€í•˜ì—¬ ì„±ëŠ¥ ìµœì í™” 3. CephFS PVC + Pod í…ŒìŠ¤íŠ¸ # cephfs-pvc-test.yaml\napiVersion: v1 kind: PersistentVolumeClaim metadata: name: cephfs-pvc namespace: test spec: storageClassName: rook-cephfs accessModes: - ReadWriteMany resources: requests: storage: 1Gi --- apiVersion: v1 kind: Pod metadata: name: cephfs-pod namespace: test spec: containers: - name: cephfs-container image: busybox command: [\u0026#34;/bin/sh\u0026#34;, \u0026#34;-c\u0026#34;, \u0026#34;sleep 3600\u0026#34;] volumeMounts: - mountPath: \u0026#34;/mnt/cephfs\u0026#34; name: cephfs-vol volumes: - name: cephfs-vol persistentVolumeClaim: claimName: cephfs-pvc CephFSëŠ” ê¸°ë³¸ì ìœ¼ë¡œ RWX(ReadWriteMany)ë¥¼ ì§€ì›í•¨. (ì—¬ëŸ¬ Podì—ì„œ ë™ì‹œì— Mount ê°€ëŠ¥) ì‚­ì œ # cephFSëŠ” RGWë¥¼ ì”€ìœ¼ë¡œì¨ ë‚´ í™˜ê²½ì—ì„œ ë„ˆë¬´ ê³¼í•˜ê²Œ ë§ì€ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•¨.\nblock storage : Ceph RBD object storage : Minio File System : NFS\nìœ„ì™€ ê°™ì´ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ë¦¬ì†ŒìŠ¤ ë‚­ë¹„ë¥¼ ì¤„ì´ëŠ” ë°©í–¥ìœ¼ë¡œ ê°„ë‹¤. # 1. test ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì—ì„œ cephfs-pvc, cephfs-pod ì‚­ì œ kubectl delete pvc cephfs-pvc -n test kubectl delete pod cephfs-pod -n test # 2. rook-cephfs StorageClass ì‚­ì œ kubectl delete sc rook-cephfs # 3. rook-ceph-fs CephFilesystem ì‚­ì œ kubectl delete cephfilesystem rook-ceph-fs -n rook-ceph # 4. (ìë™) MDS ê´€ë ¨ Deployment ì‚­ì œ í™•ì¸ kubectl get deploy -n rook-ceph | grep mds # 5. rook-ceph-fs ê´€ë ¨ Ceph Pools ì‚­ì œ kubectl -n rook-ceph exec -it deploy/rook-ceph-tools -- bash # rook-ceph-tools ë‚´ë¶€ì—ì„œ ì‹¤í–‰ ceph osd pool ls ceph osd pool delete rook-ceph-fs-metadata rook-ceph-fs-metadata --yes-i-really-really-mean-it ceph osd pool delete rook-ceph-fs-data0 rook-ceph-fs-data0 --yes-i-really-really-mean-it # ì‚­ì œ í›„ cluster ìƒíƒœ ì ê²€ ceph status "},{"id":13,"href":"/docs/troubleshooting/ceph-issue1/","title":"Cephë¥¼ êµ¬ì¶•í•˜ë©° ë°œìƒí•œ cpu ì´ìŠˆ..","section":"íŠ¸ëŸ¬ë¸”ìŠˆíŒ…","content":" ìƒí™© # Ceph í´ëŸ¬ìŠ¤í„°ë¥¼ Kubernetesì— êµ¬ì¶•í•˜ëŠ” ê³¼ì • ì¤‘, csi-rbdplugin, csi-cephfsplugin, csi-snapshotter ë“±ì˜ csi-* ê³„ì—´ Podë“¤ì´ CrashLoopBackOff ë˜ëŠ” Error ìƒíƒœë¡œ ì§€ì†ì ìœ¼ë¡œ ì‹¤íŒ¨í•¨.\në¬¸ì œ ì›ì¸ # Cephê³¼ glibcì˜ ê´€ê³„ Cephì€ ë‚´ë¶€ì ìœ¼ë¡œ glibc(GNU C Library)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹œìŠ¤í…œ í˜¸ì¶œê³¼ ë©”ëª¨ë¦¬ ê´€ë¦¬ë¥¼ ìˆ˜í–‰í•¨. ìµœì‹  Ceph(v18, v19) ë²„ì „ì€, ìµœì‹  glibc(\u0026gt;=2.34) ê¸°ë°˜ìœ¼ë¡œ ë¹Œë“œë˜ì–´ ìˆìŒ. ì´ glibc ë²„ì „ë“¤ì€ CPUê°€ \u0026lsquo;x86-64-v2\u0026rsquo; ëª…ë ¹ì–´ ì§‘í•©ì„ ì§€ì›í•œë‹¤ê³  ê°€ì •í•˜ê³  ìµœì í™”ë˜ì–´ ìˆìŒ. x86-64-v2ë€? x86-64-v2ëŠ” ê¸°ì¡´ x86-64 ì•„í‚¤í…ì²˜ë³´ë‹¤ ë” ë°œì „ëœ ëª…ë ¹ì–´ ì§‘í•©(Instruction Set)ì„ ì˜ë¯¸í•¨.\ní•„ìˆ˜ ì§€ì› ëª…ë ¹ì–´ëŠ” ë‹¤ìŒê³¼ ê°™ìŒ:\ní”Œë˜ê·¸ ì„¤ëª… sse3 ìŠ¤íŠ¸ë¦¬ë° SIMD í™•ì¥(SSE3) ssse3 ë³´ê°•ëœ ìŠ¤íŠ¸ë¦¬ë° SIMD í™•ì¥(SSSE3) sse4_1 ìŠ¤íŠ¸ë¦¬ë° SIMD í™•ì¥(SSE4.1) sse4_2 ìŠ¤íŠ¸ë¦¬ë° SIMD í™•ì¥(SSE4.2) popcnt ë¹„íŠ¸ ì¹´ìš´íŠ¸(Population Count) cx16 16ë°”ì´íŠ¸ ë¹„êµ/êµí™˜(CMPXCHG16B) ì´ ì¤‘ í•˜ë‚˜ë¼ë„ CPUê°€ ì§€ì›í•˜ì§€ ì•Šìœ¼ë©´ glibcê°€ ì˜¤ë¥˜ë¥¼ ë°œìƒì‹œí‚¤ê³ , Ceph ë°ëª¬ì´ í”„ë¡œì„¸ìŠ¤ ë ˆë²¨ì—ì„œ ë°”ë¡œ ì£½ìŒ.\nê°€ìƒí™” í™˜ê²½ì˜ ë¬¸ì œ KVM/QEMU í™˜ê²½ì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ \u0026ldquo;QEMU Virtual CPU\u0026quot;ë¼ëŠ” ì—ë®¬ë ˆì´ì…˜ CPUë¥¼ VMì—ê²Œ ì œê³µí•¨. ì´ ê¸°ë³¸ ì„¤ì •ì€ x86-64-v2 ëª…ë ¹ì–´ ì§€ì›ì´ ì—†ìŒ. ë”°ë¼ì„œ Ceph ë°ëª¬(íŠ¹íˆ mon, mgr, osd ë“±)ì´ ì´ˆê¸°í™”ë  ë•Œ, í•„ìˆ˜ ëª…ë ¹ì–´ë¥¼ ì°¾ì§€ ëª»í•´ ì—ëŸ¬ ë°œìƒ â†’ Pod Crashë¡œ ì´ì–´ì§. í™•ì¸ ë°©ë²• # VM ë˜ëŠ” Kubernetes Nodeì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ ì‹¤í–‰\nlscpu | grep Flags # or cat /proc/cpuinfo | grep flags ì¶œë ¥ ê²°ê³¼ì— sse3, ssse3, sse4_1, sse4_2, popcnt, cx16 ë“±ì´ ë°˜ë“œì‹œ í¬í•¨ë˜ì–´ ìˆì–´ì•¼ í•¨. ë§Œì•½ í¬í•¨ë˜ì§€ ì•Šì•˜ë‹¤ë©´, í•´ë‹¹ VMì€ x86-64-v2 ê¸°ì¤€ì„ ë§Œì¡±í•˜ì§€ ì•ŠìŒ. í•´ê²° ë°©ë²• # í•­ëª© ì„¤ì •ê°’ ì´ìœ  CPU Type Host Passthrough ë¬¼ë¦¬ CPUì˜ ëª¨ë“  ê¸°ëŠ¥ì„ VMì— ì§ì ‘ ì „ë‹¬í•˜ì—¬ x86-64-v2 ëª…ë ¹ì–´ ì§€ì› ë³´ì¥ Emulated Machine ê¸°ì¡´ê³¼ ë™ì¼ (ì˜ˆ: pc-q35-6.2) ë³„ë„ ë³€ê²½ ë¶ˆí•„ìš” ë””ìŠ¤í¬ í¬ë§· qcow2 ì„±ëŠ¥ê³¼ ìŠ¤ëƒ…ìƒ· ê¸°ëŠ¥ì„ ë™ì‹œì— ê³ ë ¤ ë¶€íŒ… ë””ìŠ¤í¬ 30GB ~ 50GB Kubernetes OSìš© ë””ìŠ¤í¬ ì‚¬ì´ì¦ˆ ì¶”ê°€ ë””ìŠ¤í¬ í•„ìš”ì‹œ ì¶”ê°€ Ceph OSD ë””ìŠ¤í¬ìš© ë“± Firmware BIOS ê¸°ì¡´ í™˜ê²½ ìœ ì§€ vCPU ê³„íší•œ ëŒ€ë¡œ (ex: master 3core, worker 4core) Memory ê³„íší•œ ëŒ€ë¡œ (ex: master 8GB, worker 16GB) ë„¤íŠ¸ì›Œí¬ Bridge ì—°ê²° (br0 ë“±) Kubernetes í´ëŸ¬ìŠ¤í„° í†µì‹ ì„ ìœ„í•´ ìš”ì•½ # QEMU ê¸°ë³¸ CPU â†’ x86-64-v2 ëª…ë ¹ì–´ ë¯¸ì§€ì› â†’ ìµœì‹  glibc ê¸°ë°˜ Ceph ë°ëª¬ ì£½ìŒ â†’ csi-*, mon, mgr Pod Crash. â†’ VM ìƒì„± ì‹œ Host Passthrough ì„¤ì • í•„ìˆ˜!\n"},{"id":14,"href":"/docs/data-engineering/modeling/dimensional-modeling/","title":"Dimensional Modeling: ë¶„ì„ì„ ìœ„í•œ ë°ì´í„° ì„¤ê³„ì˜ ë³¸ì§ˆ","section":"Modeling","content":" Factì™€ Dimensionì˜ ê°œë… # Fact : \u0026ldquo;ì¸¡ì •ê°’ / ìˆ˜ì¹˜ ì¤‘ì‹¬ì˜ ì´ë²¤íŠ¸ ë°ì´í„°\u0026rdquo;\nì¼ë°˜ì ìœ¼ë¡œëŠ” ì§‘ê³„(Aggregation) ê°€ ê°€ëŠ¥í•œ ê°’ë“¤ ëŒ€ë¶€ë¶„ ì‹œê°„ì— ë”°ë¼ ë³€í™”í•˜ë©°, íŠ¹ì • ê¸°ì¤€ìœ¼ë¡œ ë¶„ë¥˜í•˜ì—¬ ë¶„ì„í•˜ëŠ” ëŒ€ìƒ í•­ìƒ í•˜ë‚˜ ì´ìƒì˜ Dimensionê³¼ ì—°ê²°ë˜ì–´ ìˆìœ¼ë©°, ë¶„ì„ ì¿¼ë¦¬ì—ì„œëŠ” ì§‘ê³„ í•¨ìˆ˜(SUM, COUNT, AVG ë“±)ì˜ ëŒ€ìƒì´ ë¨ sales_fact â”œâ”€â”€ date_id (FK) â”œâ”€â”€ product_id (FK) â”œâ”€â”€ store_id (FK) â”œâ”€â”€ quantity_sold (Fact) â”œâ”€â”€ total_revenue (Fact) Dimension : \u0026ldquo;Factë¥¼ ì„¤ëª…í•˜ê±°ë‚˜ ë¶„ì„ ê¸°ì¤€ì´ ë˜ëŠ” ë²”ì£¼í˜• ë°ì´í„°\u0026rdquo;\nì¼ë°˜ì ìœ¼ë¡œ ë¶„ì„ìê°€ ë°ì´í„°ë¥¼ \u0026ldquo;ì–´ë–¤ ê¸°ì¤€ìœ¼ë¡œ ë³´ê³  ì‹¶ì€ê°€\u0026quot;ë¥¼ ì •ì˜í•˜ëŠ” ê¸°ì¤€ WHERE, GROUP BY, ORDER BY ì ˆì—ì„œ ìì£¼ ì‚¬ìš©ë¨ ê° Dimensionì€ ì—¬ëŸ¬ ì†ì„±(attribute)ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆê³ , ì´ ì†ì„± ê°„ì—ëŠ” ì¢…ì¢… ê³„ì¸µ(Hierarchy)ì´ ì¡´ì¬í•¨ ì˜ˆë¥¼ ë“¤ì–´, ì‹œê°„ Dimesionì€ ì—°ë„ -\u0026gt; ë¶„ê¸° -\u0026gt; ì›” -\u0026gt; ì¼, ì§€ì—­ Dimensionì€ ëŒ€ë¥™ -\u0026gt; êµ­ê°€ -\u0026gt; ë„ì‹œ ìˆœìœ¼ë¡œ ê³„ì¸µí™”í•  ìˆ˜ ìˆìŒ e.g. ì¹´í…Œê³ ë¦¬, ì§€ì—­, ì‹œê°„ ê³ ê°, ìƒí’ˆ ë“±ì˜ ë²”ì£¼ì (categorical) ë°ì´í„° product_dim â”œâ”€â”€ product_id (PK) â”œâ”€â”€ product_name â”œâ”€â”€ category â”œâ”€â”€ brand FactëŠ” ìˆ˜ì¹˜ ê²°ê³¼, Dimensionì€ ë¶„ì„ ê¸°ì¤€\nDimensional Modelingì´ë€? # ë¶„ì„ì„ ìœ„í•´ ë°ì´í„°ë¥¼ Fact + Dimension êµ¬ì¡°ë¡œ ì„¤ê³„í•˜ëŠ” ë°©ë²•ë¡ \nRDB ê¸°ë°˜ DW êµ¬ì¡° ì„¤ê³„ì— ìµœì í™”ë¨ Star / Snowflake / Galaxy êµ¬ì¡°ë¡œ êµ¬í˜„ë¨ ë¶„ì„ ì¿¼ë¦¬ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ êµ¬ì¡°ì  ê¸°ë°˜ êµ¬ì„± ìš”ì†Œ # Fact Table: ìˆ˜ì¹˜ ì¤‘ì‹¬, ì—¬ëŸ¬ Dimensionì— ì—°ê²°ë¨ Dimension Table: ë¶„ì„ ê¸°ì¤€ ì œê³µ, ê³„ì¸µ í¬í•¨ ê°€ëŠ¥ Grain: í•˜ë‚˜ì˜ Factê°€ ì˜ë¯¸í•˜ëŠ” ë‹¨ìœ„ (ex. 1ê±´ì˜ ì£¼ë¬¸? 1ì¼ ë§¤ì¶œ?) Multidimensional Modeing # Multidimensional Modelingì€ ë°ì´í„°ë¥¼ ë‹¤ì–‘í•œ ë¶„ì„ ì¶•(Dimension)ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ë³´ê³ , ê° ì¶•ì˜ ì¡°í•©ì— ë”°ë¼ í•˜ë‚˜ì˜ ì¸¡ì •ê°’(Fact)ë¥¼ ë„ì¶œí•˜ëŠ” ë°©ì‹ì„. OLAPì˜ ê¸°ë³¸ ëª¨ë¸ë§ ë°©ì‹ìœ¼ë¡œ, ì‚¬ìš©ìëŠ” ë‹¤ì–‘í•œ ì¶•ì„ ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„°ë¥¼ Slice, Dice, Drill-down, Roll-up ë“±ì˜ ë°©ì‹ìœ¼ë¡œ ë¶„ì„ ê°€ëŠ¥. ì´ ëª¨ë¸ì€ íŠ¹íˆ OLAP Cubeë¼ëŠ” ê°œë…ìœ¼ë¡œ ì‹œê°í™”ë˜ë©°, X, Y, Z ì¶•ì— Dimensionì´ ìœ„ì¹˜í•˜ê³ , êµì°¨ì (Cell)ì— í•˜ë‚˜ì˜ Fact ê°’ì´ ì¡´ì¬. ë¶„ì„ ì¤‘ì‹¬ìœ¼ë¡œ ìµœì í™”ë˜ì–´ ìˆìœ¼ë©°, ë¹ ë¥¸ ì‘ë‹µ ì„±ëŠ¥ê³¼ ì‚¬ìš©ìì˜ ì§ê´€ì ì¸ ì´í•´ë¥¼ ìœ„í•´ ì„¤ê³„ë¨. ì‹œê°„ ì°¨ì› ^ | | â— (ì œí’ˆA, 2023ë…„, ì„œìš¸, 100ë§Œì›) | / | / | / | / |/ +------------\u0026gt; ì œí’ˆ ì°¨ì› /| / | / | / | / | v v ì§€ì—­ ì°¨ì› ì¸¡ì •ê°’(íŒë§¤ì•¡) Multidimensional Modelingê³¼ì˜ ê´€ê³„ # í•­ëª© Dimensional Modeling Multidimensional Modeling ê´€ì  êµ¬ì¡°ì  ì„¤ê³„ ë°©ë²•ë¡  ê°œë…ì  ë¶„ì„ ëª¨ë¸ë§ êµ¬í˜„ Star/Snowflake Schema OLAP Cube ê¸°ë°˜ ì¶• í•´ì„ ì‚¬ìš© RDB ê¸°ë°˜ DW ì„¤ê³„ BI/OLAP ë¶„ì„ íˆ´ ì„¤ê³„ ë‘˜ì€ ëª©ì ì´ ë‹¤ë¥´ì§€ë§Œ ì‹¤ë¬´ì—ì„œëŠ” ê±°ì˜ ì—°ë™ë˜ì–´ ì‚¬ìš©ëœë‹¤ê³  í•¨ Cubeë¡œ ë³´ëŠ” ì‹œê°ì€ Multidimensional, í…Œì´ë¸” ì„¤ê³„ëŠ” Dimensional Star, Snowflake Schema # â­ Star Schema # ë¹„ì •ê·œí™”ëœ Dimension í…Œì´ë¸” + ì¤‘ì‹¬ Fact í…Œì´ë¸” ì¿¼ë¦¬ ë‹¨ìˆœ, JOIN ì ìŒ BI ë„êµ¬ì—ì„œ ì„ í˜¸ë¨ [product_dim] â†‘ [store_dim] â† [sales_fact] â†’ [date_dim] â„ï¸ Snowflake Schema # Dimensionì„ ì •ê·œí™”í•˜ì—¬ ê³„ì¸µ êµ¬ì¡° í‘œí˜„ ì¤‘ë³µ ì ê³ , ì •í•©ì„± ë†’ìŒ JOINì´ ë§ì•„ì ¸ ì„±ëŠ¥ ì €í•˜ ê°€ëŠ¥ category_dim â† subcategory_dim â† product_dim â† sales_fact ğŸŒŒ Galaxy Schema # ì—¬ëŸ¬ Fact í…Œì´ë¸” ì¡´ì¬ ê³µí†µ Dimensionì„ ê³µìœ  (í†µí•© ë¶„ì„ìš©) êµ¬ì¡° ë³µì¡í•˜ê³  ì„¤ê³„ ë‚œì´ë„ ë†’ìŒ [product_dim] â†‘ â†‘ [sales_fact] [refund_fact]` ìŠ¤í‚¤ë§ˆ êµ¬ì¡° ë³µì¡ë„ ì„±ëŠ¥ ì •í•©ì„± íŠ¹ì§• Star ë‚®ìŒ ë¹ ë¦„ ì¤‘ê°„ ë‹¨ìˆœ ë¶„ì„ì— ìµœì í™” Snowflake ì¤‘ê°„ ëŠë¦´ ìˆ˜ ìˆìŒ ë†’ìŒ ê³„ì¸µ í‘œí˜„ì— ìœ ë¦¬ Galaxy ë†’ìŒ ë³µí•© ë†’ìŒ í†µí•© ë¶„ì„ + í™•ì¥ì„± ìŠ¤í‚¤ë§ˆ ì„ íƒ ê¸°ì¤€ # ë°ì´í„° ì¤‘ë³µì„ ê°ìˆ˜í•˜ë”ë¼ë„ ë¶„ì„ í¸ì˜ì„±/ì†ë„ê°€ ìš°ì„  â†’ â­ Star ê³„ì¸µ êµ¬ì¡° í‘œí˜„, ì •í•©ì„± ìœ ì§€ê°€ ì¤‘ìš” â†’ â„ï¸ Snowflake ì—¬ëŸ¬ ì´ë²¤íŠ¸ í…Œì´ë¸”(ì£¼ë¬¸, ë°˜í’ˆ, ë°°ì†¡ ë“±)ì„ í•¨ê»˜ ë¶„ì„ â†’ ğŸŒŒ Galaxy ğŸ’¬ í•µì‹¬: êµ¬ì¡°ëŠ” ë„ë©”ì¸ë³´ë‹¤ \u0026ldquo;ë¶„ì„ ëª©ì  + ìœ ì§€ ì „ëµ\u0026rdquo; ê¸°ì¤€ìœ¼ë¡œ ì„ íƒí•¨\n"},{"id":15,"href":"/docs/data-processing/flink/flink-to-gcs/","title":"Flink to GCS","section":"Flink","content":" 1. GCP ì¤€ë¹„ # Bucket ìƒì„± Service account ìƒì„± (ìµœì†Œ ê¶Œí•œ) Storage Object Admin Storage Object Creator Service account key(Json file) ìƒì„± í›„ ë‹¤ìš´ë¡œë“œ 2. K8s Secret ìƒì„± # kubectl create secret generic {secret_key_name} \\ --from-file={1ë²ˆì—ì„œ ë°œê¸‰ë°›ì€ jsoníŒŒì¼}={/path/to/your/keyfile.json} \\ -n flink # e.g. kubectl create secret generic gcp-steve-account-key \\ --from-file=squidengineer-25d36a46ab7f.json=/path/to/your/keyfile.json \\ -n flink 3. GCS Connector ì¤€ë¹„ # í•„ìš” JAR ëª©ë¡ # flink-gs-fs-hadoop-1.20.1.jar : Flinkê°€ GCSë¥¼ ì§€ì›í•˜ëŠ” í”ŒëŸ¬ê·¸ì¸ gcs-connector-hadoop2-latest.jar : GCSì™€ HDFS ì¸í„°í˜ì´ìŠ¤ë¥¼ ì—°ê²°í•˜ëŠ” Google ì œê³µ connector wget https://repo1.maven.org/maven2/org/apache/flink/flink-gs-fs-hadoop/1.20.1/flink-gs-fs-hadoop-1.20.1.jar wget https://storage.googleapis.com/hadoop-lib/gcs/gcs-connector-hadoop2-latest.jar ì°¸ê³ :\nflink-gs-fs-hadoopì€ Flink 1.20 ê³µì‹ ë¦´ë¦¬ìŠ¤ë¶€í„° ê¸°ë³¸ ì§€ì›.\në‹¨, ì—¬ì „íˆ \u0026ldquo;gcs-connector-hadoop\u0026quot;ì€ ë³„ë„ í•„ìš”í•¨ (GCP ë¼ì´ë¸ŒëŸ¬ë¦¬).\n4. Custom Flink Docker image ë§Œë“¤ê¸° # Dockerfile ì‘ì„± # FROM flink:1.20.1-scala_2.12 # GCS connector í”ŒëŸ¬ê·¸ì¸ ë° ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€ RUN mkdir -p /opt/flink/plugins/flink-gs-fs-hadoop COPY flink-gs-fs-hadoop-1.20.1.jar /opt/flink/plugins/flink-gs-fs-hadoop/ COPY gcs-connector-hadoop2-latest.jar /opt/flink/lib/ # í”ŒëŸ¬ê·¸ì¸ í™œì„±í™” RUN echo \u0026#34;plugins.enable: flink-gs-fs-hadoop\u0026#34; \u0026gt;\u0026gt; /opt/flink/conf/flink-conf.yaml RUN chmod -R 755 /opt/flink/plugins/flink-gs-fs-hadoop ì´ë¯¸ì§€ ë¹Œë“œ ë° ì—…ë¡œë“œ # docker build -t {dockerhub-username}/steve-flink-gcs:1.20.1 . docker push {dockerhub-username}/steve-flink-gcs:1.20.1 5. FlinkDeployment YAML ì‘ì„± # apiVersion: flink.apache.org/v1beta1 kind: FlinkDeployment metadata: name: {cluster-name} namespace: flink spec: image: {dockerhub-username}/steve-flink-gcs:1.20.1 flinkVersion: v1_20 serviceAccount: flink mode: standalone flinkConfiguration: taskmanager.numberOfTaskSlots: \u0026#34;2\u0026#34; jobmanager.memory.process.size: \u0026#34;1024m\u0026#34; taskmanager.memory.process.size: \u0026#34;2048m\u0026#34; kubernetes.rest-service.exposed.type: ClusterIP kubernetes.deployment.target: standalone fs.gs.project.id: {gcp-project-id} fs.gs.system.bucket: {bucket-name} fs.gs.auth.service.account.json.keyfile: /opt/flink/custom-config/{gcp-secret-key} fs.gs.impl: com.google.cloud.hadoop.fs.gcs.GoogleHadoopFileSystem fs.AbstractFileSystem.gs.impl: com.google.cloud.hadoop.fs.gcs.GoogleHadoopFS plugins.enable: flink-gs-fs-hadoop jobManager: replicas: 1 resource: memory: \u0026#34;2048m\u0026#34; cpu: 1 podTemplate: spec: volumes: - name: gcp-sa-key secret: secretName: {secret-name} containers: - name: flink-main-container env: - name: GOOGLE_APPLICATION_CREDENTIALS value: /opt/flink/custom-config/{gcp-secret-key} volumeMounts: - mountPath: /opt/flink/custom-config/{gcp-secret-key} name: gcp-sa-key subPath: {gcp-secret-key} taskManager: replicas: 2 resource: memory: \u0026#34;2048m\u0026#34; cpu: 1 podTemplate: spec: volumes: - name: gcp-sa-key secret: secretName: {secret-name} containers: - name: flink-main-container volumeMounts: - mountPath: /opt/flink/custom-config/{gcp-secret-key} name: gcp-sa-key subPath: {gcp-secret-key} env: - name: GOOGLE_APPLICATION_CREDENTIALS value: /opt/flink/custom-config/squidengineer-25d36a46ab7f.json ingress: template: \u0026#34;{ingress-name}\u0026#34; className: nginx annotations: nginx.ingress.kubernetes.io/backend-protocol: \u0026#34;HTTP\u0026#34; nginx.ingress.kubernetes.io/ssl-passthrough: \u0026#34;true\u0026#34; cert-manager.io/cluster-issuer: \u0026#34;selfsigned-cluster-issuer\u0026#34; ê¼­ envë¡œ GOOGLE_APPLICATION_CREDENTIALS ì„¤ì •ì„ í•´ì¤˜ì•¼ ê¶Œí•œ ì¸ì¦ ê°€ëŠ¥\n6. Flink SQL Clientë¡œ ë°ì´í„° ì‚½ì… # kubectl exec -it -n flink deploy/{cluster-name}-jobmanager -- /opt/flink/bin/sql-client.sh embedded ë¡œ ì ‘ì† í›„, í…ŒìŠ¤íŠ¸ ìš©ë„ë¡œ\nDROP TABLE IF EXISTS {TABLE_NAME}; CREATE TABLE {TABLE_NAME} ( id INT, name STRING ) WITH ( \u0026#39;connector\u0026#39; = \u0026#39;filesystem\u0026#39;, \u0026#39;path\u0026#39; = \u0026#39;gs://{bucket-name}/{folder-name}/\u0026#39;, \u0026#39;format\u0026#39; = \u0026#39;csv\u0026#39;, \u0026#39;sink.partition-commit.policy.kind\u0026#39; = \u0026#39;success-file\u0026#39; ); INSERT INTO {TABLE_NAME} VALUES (1, \u0026#39;steve\u0026#39;), (2, \u0026#39;chatgpt\u0026#39;), (3, \u0026#39;gpt4o\u0026#39;); ìœ„ë¥¼ ì‹¤í–‰í•œë‹¤.\n"},{"id":16,"href":"/docs/infra/kvm/vm-metadata/","title":"Hello","section":"KVM","content":"ì¸í”„ë¼ êµ¬ì„±ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.\nHome(192.168.0.19) # VMëª… Disk CPU RAM Disk ì‚¬ì´ì¦ˆ ctrl-node /mnt/kvm-pool/ctrl-node.qcow2 2 2GB 40GB k8s-m1 /mnt/kvm-pool/k8s-m1.qcow2 3 8GB 30GB k8s-m2 /mnt/kvm-pool/k8s-m2.qcow2 3 8GB 30GB k8s-w1 /mnt/kvm-pool/k8s-w1.qcow2 3 16GB 50GB + Ceph 100GB k8s-w2 /mnt/kvm-pool/k8s-w2.qcow2 4 16GB 50GB + Ceph 100GB ì´í•© 15 50GB Test(192.168.0.18) # VMëª… Disk CPU RAM Disk ì‚¬ì´ì¦ˆ k8s-m3 /mnt/kvm-pool/k8s-m3.qcow2 4 8GB 30GB k8s-w3 /mnt/kvm-pool/k8s-w3.qcow2 4 16GB 50GB + Ceph 100GB k8s-w4 /mnt/kvm-pool/k8s-w4.qcow2 4 16GB 50GB + Ceph 100GB k8s-w5 /mnt/kvm-pool/k8s-w5.qcow2 4 16GB 50GB + Ceph 100GB nfs-server /mnt/kvm-pool/nfs.qcow2 1 2GB 30GB + NFS 300GB ì´í•© 17 58GB IP # Key Value Subnet 192.168.0.0/24 Gateway 192.168.0.1 Name Servers 8.8.8.8, 1.1.1.1 Search Domains (ë¹„ì›Œë„ ë¬´ë°©) VM ì´ë¦„ Address ì…ë ¥ê°’(ê³ ì • IP) ìƒì„± ì—¬ë¶€ ctrl-node 192.168.0.100/24 O k8s-m1 192.168.0.101/24 O k8s-m2 192.168.0.102/24 O k8s-m3 192.168.0.103/24 O worker k8s-w1 192.168.0.111/24 O k8s-w2 192.168.0.112/24 O k8s-w3 192.168.0.113/24 O k8s-w4 192.168.0.114/24 O k8s-w5 192.168.0.115/24 O nfs-server 192.168.0.200/24 O GPUìˆëŠ” ì„œë²„(192.168.0.19) # VMëª… Disk CPU RAM Disk ì‚¬ì´ì¦ˆ k8s-w3 4 20 k8s-w4 4 18 k8w-w5 4 18 ì´í•©||16vcpu|62gb|\nMain(192.168.0.62) # VMëª… Disk CPU RAM Disk ì‚¬ì´ì¦ˆ k8s-m1 6 12GB 50GB k8s-w1 6 20GB k8s-w2 6 20GB IP # Key Value Subnet 192.168.0.0/24 Gateway 192.168.0.1 Name Servers 8.8.8.8, 1.1.1.1 Search Domains (ë¹„ì›Œë„ ë¬´ë°©) VM ì´ë¦„ Address ì…ë ¥ê°’(ê³ ì • IP) ìƒì„± ì—¬ë¶€ ctrl-node 192.168.0.100/24 O k8s-m1 192.168.0.101/24 O k8s-m2 192.168.0.102/24 O k8s-m3 192.168.0.103/24 O worker k8s-w1 192.168.0.111/24 O k8s-w2 192.168.0.112/24 O k8s-w3 192.168.0.113/24 O k8s-w4 192.168.0.114/24 O k8s-w5 192.168.0.115/24 O nfs-server 192.168.0.200/24 O "},{"id":17,"href":"/docs/data-integration/kafka/kafka-basic/","title":"Kafka ì‹¬í™” ê°œë…","section":"Kafka","content":" Producer Acks, Batch, Page Cache and Flush # acks ì„¤ì •ì€ ìš”ì²­ì´ ì„±ê³µí•  ë•Œë¥¼ ì •ì˜í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” Producerì— ì„¤ì •í•˜ëŠ” Parameter\nacks=0 : ackê°€ í•„ìš”í•˜ì§€ ì•ŠìŒ. ì´ ìˆ˜ì¤€ì€ ìì£¼ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ. ë©”ì‹œì§€ ì†ì‹¤ì´ ë‹¤ì†Œ ìˆë”ë¼ë„ ë¹ ë¥´ê²Œ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ì•¼ í•˜ëŠ” ê²½ìš°ì— ì‚¬ìš©ëœë‹¤. acks=1(default) : Leaderê°€ ë©”ì‹œì§€ë¥¼ ìˆ˜ì‹ í•˜ë©´ ackë¥¼ ë³´ëƒ„. Leaderê°€ Producerì—ê²Œ ACKë¥¼ ë³´ë‚¸ í›„, Followerê°€ ë³µì œí•˜ê¸°ë…ì „ì— Leaderì— ì¥ì• ê°€ ë°œìƒí•˜ë©´ ë©”ì‹œì§€ê°€ ì†ì‹¤. â€œAt most once(ìµœëŒ€ í•œ ë²ˆ)â€ ì „ì†¡ì„ ë³´ì¥ acks=-1(acks=all) : ë©”ì‹œì§€ê°€ Leaderê°€ ëª¨ë“  Replicaê¹Œì§€ Commit ë˜ë©´ ackë¥¼ ë³´ëƒ„ Leaderë¥¼ ìƒì–´ë„ ë°ì´í„°ê°€ ì‚´ì•„ë‚¨ì„ ìˆ˜ ìˆë„ë¡ ë³´ì¥. ê·¸ëŸ¬ë‚˜ ëŒ€ê¸° ì‹œê°„ì´ ë” ê¸¸ê³  íŠ¹ì • ì‹¤íŒ¨ ì‚¬ë¡€ì—ì„œ ë°˜ë³µë˜ëŠ” ë°ì´í„° ë°œìƒ ê°€ëŠ¥ì„± ìˆìŒ. â€œAt least once(ìµœì†Œ í•œ ë²ˆ)â€ ì „ì†¡ì„ ë³´ì¥ Producer Retry # retryì™€ ê´€ë ¨ëœ Parameters:\nParameter ì„¤ëª… Default ê°’ retries ë©”ì„¸ì§€ë¥¼ sendí•˜ê¸° ìœ„í•´ ì¬ì‹œë„í•˜ëŠ” íšŸìˆ˜ MAX_INT retry.backoff.ms ì¬ì‹œë„ ì‚¬ì´ì— ì¶”ê°€ë˜ëŠ” ëŒ€ê¸° ì‹œê°„ 100 request.timeout.ms Producerê°€ ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ëŠ” ìµœëŒ€ ì‹œê°„ 30,000(30ì´ˆ) delivery.timeout.ms send() í›„ ì„±ê³µ ë˜ëŠ” ì‹¤íŒ¨ë¥¼ ë³´ê³ í•˜ëŠ” ì‹œê°„ì˜ ìƒí•œ 120,000(2ë¶„) =\u0026gt; retriesë¥¼ ì¡°ì •í•˜ëŠ” ëŒ€ì‹  delivery.timeout.ms ì¡°ì •ìœ¼ë¡œ retries ì œì–´ Producer Batch ì²˜ë¦¬ # ë©”ì‹œì§€ë¥¼ ëª¨ì•„ì„œ í•œë²ˆì— ì „ì†¡ Batch ì²˜ë¦¬ëŠ” RPC(Remote Procedure Call)ìˆ˜ë¥¼ ì¤„ì—¬ì„œ Brokerê°€ ì²˜ë¦¬í•˜ëŠ” ì‘ì—…ì´ ì¤„ì–´ë“¤ê¸° ë•Œë¬¸ì— ë” ë‚˜ì€ ì²˜ë¦¬ëŸ‰ì„ ì œê³µ linger.ms : (default : 0). ë©”ì‹œì§€ê°€ í•¨ê»˜ Batch ì²˜ë¦¬ë  ë•Œê¹Œì§€ ëŒ€ê¸° ì‹œê°„ batch.size : (default : 16KB). ë³´ë‚´ê¸° ì „ Batchì˜ ìµœëŒ€ í¬ê¸° Batch ì²˜ë¦¬ì˜ ì¼ë°˜ì ì¸ ì„¤ì •ì€ linger.ms=100 ë° batch.size=1000000\nPage Cacheì™€ Flush # ë©”ì‹œì§€ëŠ” Partitionì— ê¸°ë¡ë¨ Partitionì€ Log Segment fileë¡œ êµ¬ì„± (ê¸°ë³¸ê°’ : 1GBë§ˆë‹¤ ìƒˆë¡œìš´ Segment ìƒì„±) ì„±ëŠ¥ì„ ìœ„í•´ Log SegmentëŠ” OS Page Cacheì— ê¸°ë¡ë¨ ë¡œê·¸ íŒŒì¼ì— ì €ì¥ëœ ë©”ì‹œì§€ì˜ ë°ì´í„° í˜•ì‹ì€ Brokerê°€ Producerë¡œë¶€í„° ìˆ˜ì‹ í•œ ê²ƒ, ê·¸ë¦¬ê³  Consumerì—ê²Œ ë³´ë‚´ëŠ” ê²ƒê³¼ ì •í™•íˆ ë™ì¼í•˜ë¯€ë¡œ, Zero-Copy(Zero-copy ì „ì†¡ì€ ë°ì´í„°ê°€, User Spaceì— ë³µì‚¬ë˜ì§€ ì•Šê³ , CPU ê°œì… ì—†ì´ Page Cacheì™€ Network Buffer ì‚¬ì´ì—ì„œ ì§ì ‘ ì „ì†¡ë˜ëŠ” ê²ƒì„ ì˜ë¯¸. ì´ê²ƒì„ í†µí•´ Broker Heap ë©”ëª¨ë¦¬ë¥¼ ì ˆì•½í•˜ê³  ë˜í•œ ì—„ì²­ë‚œ ì²˜ë¦¬ëŸ‰ì„ ì œê³µ)ê°€ ê°€ëŠ¥ Page CacheëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê²½ìš° ë””ìŠ¤í¬ë¡œ Flushë¨ Brokerê°€ ì™„ì „íˆ ì¢…ë£Œ OS background â€œFlusher Threadâ€ ì‹¤í–‰ Flush ì „ì— Broker ì¥ì• ê°€ ë°œìƒí•˜ë©´\u0026hellip; # OSê°€ ë°ì´í„°ë¥¼ ë””ìŠ¤í¬ë¡œ flushí•˜ê¸° ì „ brokerì˜ ì‹œìŠ¤í…œì— ì¥ì• ê°€ ë°œìƒí•˜ë©´ í•´ë‹¹ ë°ì´í„°ê°€ ì†ì‹¤ë¨ Partitionì´ Replicationë˜ì–´ ìˆë‹¤ë©´, Brokerê°€ ë‹¤ì‹œ ì˜¨ë¼ì¸ ìƒíƒœê°€ ë˜ë©´ í•„ìš”ì‹œ Leader Replicaì—ì„œ ë°ì´í„°ê°€ ë³µêµ¬ë¨ Replicationì´ ì—†ë‹¤ë©´, ë°ì´í„°ëŠ” ì˜êµ¬ì  ì†ì‹¤ ê°€ëŠ¥ Kafka ìì²´ Flush ì •ì±… # ë§ˆì§€ë§‰ Flush ì´í›„ì˜ ë©”ì‹œì§€ ìˆ˜(log.flush.interval.messages) ë˜ëŠ” ì‹œê°„(log.flush.interval.ms)ìœ¼ë¡œ Flush(fsync)ë¥¼ íŠ¸ë¦¬ê±°í•˜ë„ë¡ ì„¤ì •í•  ìˆ˜ ìˆìŒ KafkaëŠ” ìš´ì˜ ì²´ì œì˜ background Flush ê¸°ëŠ¥(ì˜ˆ: pdflush)ì„ ë” íš¨ìœ¨ì ìœ¼ë¡œ í—ˆìš©í•˜ëŠ” ê²ƒì„ ì„ í˜¸í•˜ê¸° ë•Œë¬¸ì— ì´ëŸ¬í•œ ì„¤ì •ì€ ê¸°ë³¸ì ìœ¼ë¡œ ë¬´í•œ(ê¸°ë³¸ì ìœ¼ë¡œ fsync ë¹„í™œì„±í™”)ìœ¼ë¡œ ì„¤ì • ì´ëŸ¬í•œ ì„¤ì •ì„ ê¸°ë³¸ê°’ìœ¼ë¡œ ìœ ì§€í•˜ëŠ” ê²ƒì„ ê¶Œì¥ *.log íŒŒì¼ì„ ë³´ë©´ ë””ìŠ¤í¬ë¡œ Flushëœ ë°ì´í„°ì™€ ì•„ì§ Flushë˜ì§€ ì•Šì€ Page Cache (OS Buffer)ì— ìˆëŠ” ë°ì´í„°ê°€ ëª¨ë‘ í‘œì‹œë¨ Flushëœ í•­ëª©ê³¼ Flushë˜ì§€ ì•Šì€ í•­ëª©ì„ í‘œì‹œí•˜ëŠ” Linux ë„êµ¬(ì˜ˆ: vmtouch)ë„ ìˆìŒ Replica Failure # Replica Recovery # Consumer Rebalance # Partition Assignment Strategy # Cooperative Sticky Assignor # Kafka Log File # Log Retention and Cleanup Policy # Exactly Once Semantics(EOS) # "},{"id":18,"href":"/docs/data-integration/kafka/kafka-troubleshooting-optimization/","title":"Kafka ìš´ì˜ ìš”ì†Œ","section":"Kafka","content":" Kafka Monitoring # Troubleshooting Zookeeper # Troubleshooting Broker # Troubleshooting Producer # Troubleshooting Consumer # Tuning Broker # Tuning Producer # Tuning Consumer # "},{"id":19,"href":"/docs/data-integration/kafka/kafka-data-structure/","title":"Kafkaì˜ ë°ì´í„° êµ¬ì¡°","section":"Kafka","content":"Kafkaì˜ ë©”ì„¸ì§€ ì €ì¥ êµ¬ì¡°ëŠ” ë…¼ë¦¬ì  êµ¬ì¡°ì™€ ë¬¼ë¦¬ì  êµ¬ì¡°ë¡œ ë‚˜ëˆ ì„œ ìƒê°í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. KafkaëŠ” ë‹¨ìˆœí•œ message queueë¥¼ ë„˜ì–´ì„œ Log-structured Storageë¡œ ì„¤ê³„ë˜ì–´, ë©”ì„¸ì§€ì˜ ì €ì¥ ë° ì¡°íšŒ ë°©ì‹ì´ ì¼ë°˜ì ì¸ RDBMSë‚˜ ë‹¨ìˆœ queueing systemê³¼ëŠ” ë‹¤ë¥´ë‹¤.\në…¼ë¦¬ì  êµ¬ì¡° # Kafka Cluster â””â”€ Topic â””â”€ Partition (ë³µìˆ˜ ê°œ ê°€ëŠ¥) â””â”€ Offset ê¸°ë°˜ ë©”ì‹œì§€ ë¡œê·¸ (Append-Only) ğŸ”¹ Topic\në…¼ë¦¬ì ì¸ ë©”ì‹œì§€ ìŠ¤íŠ¸ë¦¼ ë‹¨ìœ„ (ì˜ˆ: sensor-temperature, chat-logs ë“±) ì‹¤ì œ ì €ì¥ì€ partition ë‹¨ìœ„ë¡œ ì´ë£¨ì–´ì§ ğŸ”¹ Partition\në©”ì‹œì§€ì˜ ë³‘ë ¬ ì²˜ë¦¬ ë‹¨ìœ„ ê° íŒŒí‹°ì…˜ì€ ë‚´ë¶€ì ìœ¼ë¡œ append-only logë¡œ êµ¬í˜„ë¨ ê° ë©”ì‹œì§€ëŠ” Offsetì„ ê¸°ì¤€ìœ¼ë¡œ ìˆœì°¨ì ìœ¼ë¡œ ì €ì¥ë¨ í•˜ë‚˜ì˜ íŒŒí‹°ì…˜ì€ í•œ ë²ˆì— í•˜ë‚˜ì˜ consumerì—ê²Œë§Œ í• ë‹¹ë¨ (Consumer Group ê¸°ì¤€) ë¬¼ë¦¬ì  êµ¬ì¡° # /log.dirs/\u0026lt;topic\u0026gt;-\u0026lt;partition\u0026gt;/ â”œâ”€ 00000000000000000000.log â”œâ”€ 00000000000000000000.index â”œâ”€ 00000000000000000000.timeindex â”œâ”€ 00000000000000010000.log â”œâ”€ 00000000000000010000.index â”œâ”€ ... ğŸ”¹ Segment (ì„¸ê·¸ë¨¼íŠ¸)\níŒŒí‹°ì…˜ì€ ì‹¤ì œë¡œ ì—¬ëŸ¬ ê°œì˜ segment íŒŒì¼ë¡œ êµ¬ì„±ë¨ ê¸°ë³¸ì ìœ¼ë¡œ log.segment.bytes ì„¤ì • (ê¸°ë³¸ê°’: 1GB)ë§ˆë‹¤ ìƒˆë¡œìš´ ì„¸ê·¸ë¨¼íŠ¸ íŒŒì¼ ìƒì„± Partitionë‹¹ ì˜¤ì§ í•˜ë‚˜ì˜ Segmentê°€ Active ë˜ì–´ ìˆìŒ ê° ì„¸ê·¸ë¨¼íŠ¸ëŠ” ë‹¤ìŒ 3ê°€ì§€ íŒŒì¼ë¡œ êµ¬ì„±ë¨: File name Description .log ë©”ì„¸ì§€ ë³¸ë¬¸ì´ ì €ì¥ëœ íŒŒì¼ .index offset -\u0026gt; file ìœ„ì¹˜ ë§¤í•‘(binary) .timeindex timestamp -\u0026gt; offset ë§¤í•‘(ì‹œê°„ ê¸°ì¤€ ì¡°íšŒìš©) "},{"id":20,"href":"/docs/data-integration/kafka/kafka-storage-performance-test/","title":"Kafkaì˜ ì„±ëŠ¥ ì¸¡ì • (Block storage vs NFS)","section":"Kafka","content":" ê°œìš” # Kafka docsì—ëŠ” ì–´ë””ì— ë°ì´í„°ë¥¼ ì €ì¥í•´ì•¼í•œë‹¤ëŠ” ê¸€ì´ ì—†ì§€ë§Œ, Kafkaë¥¼ k8sì— ì˜¬ë¦´ ë•Œ ì‚¬ìš©í•˜ëŠ” strimzi operatorì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë¬¸êµ¬ê°€ ìˆë‹¤.\nEfficient data storage is essential for Strimzi to operate effectively, and block storage is strongly recommended. Strimzi has been tested only with block storage, and file storage solutions like NFS are not guaranteed to work.\nê¸°ì¡´ì—ëŠ” k8sì—ì„œ kafkaì˜ ì €ì¥ì†Œë¡œ nfsë¥¼ ì‚¬ìš©í–ˆë˜ í„°ë¼, block storageë¥¼ ì¶”ê°€ë¡œ ê¹”ì•„ì•¼í•œë‹¤ê³  ìƒê°í–ˆê³  ì´ì— ë”°ë¼ longhorn, openebs, ceph ì¤‘ cephê°€ ê°€ì¥ ëŒ€ì¤‘ì (?)ì´ë©´ì„œ de-factor standardë¡œ ì•Œê³ ìˆì–´ì„œ ì±„ìš”í–ˆë‹¤. ë¬¼ë¡  cephì˜ ì—¬ëŸ¬ storageê°€ ìˆì§€ë§Œ ê·¸ ì¤‘ ceph rbdë§Œì„ ì‚¬ìš©í–ˆìœ¼ë©°, nfsì™€ì˜ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ì— ëŒ€í•œ ê¸€ì´ë‹¤.\nì„±ëŠ¥ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì‹œë‚˜ë¦¬ì˜¤ëŠ” í¬ê²Œ 6ê°€ì§€ë¡œ ì¡ì•˜ë‹¤.\nì‹œë‚˜ë¦¬ì˜¤ ID í…ŒìŠ¤íŠ¸ ëª©ì  ì…ë ¥ ì¡°ê±´ ê¸°ëŒ€ ì¶œë ¥ (ì¸¡ì • ì§€í‘œ) S1 ë‹¨ì¼ Producer Throughput 1KB Ã— 10ë§Œê±´, throughput=-1 ì´ˆë‹¹ ì²˜ë¦¬ëŸ‰ (MB/s), í‰ê·  ì „ì†¡ ì§€ì—° S2 ë³‘ë ¬ Producer ì²˜ë¦¬ëŸ‰ Producer 5ê°œ ì´ ì²˜ë¦¬ëŸ‰ (MB/s), Broker ë¶€í•˜ S3 ë‹¨ì¼ Consumer ì²˜ë¦¬ ì†ë„ test-topicì˜ 10ë§Œ ë©”ì‹œì§€ ì´ ì²˜ë¦¬ ì‹œê°„, ì´ˆë‹¹ ì†Œë¹„ëŸ‰ S4 ì¥ì‹œê°„ ë¶€í•˜ â†’ ë¦¬ì†ŒìŠ¤ ëˆ„ìˆ˜ 1ì‹œê°„ ì§€ì† ì „ì†¡ (throughput=10000/s) ë©”ëª¨ë¦¬ ì¦ê°€ S5 ëŒ€ìš©ëŸ‰ ë©”ì‹œì§€ ì²˜ë¦¬ 100KB, 10ë§Œê±´, throughput ì œí•œ ì—†ìŒ ì²˜ë¦¬ëŸ‰(MB/s), ì „ì†¡/ì†Œë¹„ ì‹¤íŒ¨ìœ¨ S6 Producer latency ì¸¡ì • acks=all, linger.ms=5, batch.size=32KB í‰ê· /ìµœëŒ€ latency(ms) ì´ì œ ì½”ë“œì™€ ê²°ê³¼ ë° ë¶„ì„ ë‚´ìš©ì— ëŒ€í•´ ìˆœì°¨ì ìœ¼ë¡œ ë‚˜ì—´í•˜ê² ë‹¤.\nS1. ë‹¨ì¼ Producer Throughput ì¸¡ì • # bin/kafka-producer-perf-test.sh \\ --topic test-topic \\ --num-records 100000 \\ --record-size 1024 \\ --throughput -1 \\ --producer-props bootstrap.servers=\u0026lt;bootstrap\u0026gt; S1 - ê²°ê³¼ # ë©”ì‹œì§€ ìˆ˜ Throughput (NFS) Avg Latency (NFS) Throughput (Ceph) Avg Latency (Ceph) 100 0.06 MB/sec 270.57 ms 0.16 MB/sec 121.25 ms 500 0.25 MB/sec 678.76 ms 0.70 MB/sec 99.58 ms 1000 0.32 MB/sec 1,187.67 ms 1.00 MB/sec 258.99 ms 3000 0.39 MB/sec 3,355.14 ms 1.78 MB/sec 559.59 ms 5000 0.40 MB/sec 5,602.60 ms 2.11 MB/sec 802.07 ms 10000 0.41 MB/sec 11,196.89 ms 2.31 MB/sec 1,813.02 ms Ceph RBDëŠ” ì²˜ë¦¬ëŸ‰(Throughput)ì´ NFS ëŒ€ë¹„ 4~6ë°° ì´ìƒ ë†’ê³ , latencyë„ í˜„ì €íˆ ë‚®ìŒ NFSëŠ” ì“°ê¸° IOPS í•œê³„ì™€ fsync() ë™ê¸°í™” ì§€ì—°ìœ¼ë¡œ ì¸í•´ latencyê°€ ì„ í˜•ì ìœ¼ë¡œ ì¦ê°€ Cephì€ ë³‘ë ¬ ì“°ê¸° ì²˜ë¦¬ ëŠ¥ë ¥ì´ í›¨ì”¬ ë›°ì–´ë‚˜ throughputì„ ì¼ì • ìˆ˜ì¤€ ì´ìƒìœ¼ë¡œ ìœ ì§€í•¨ í´ëŸ¬ìŠ¤í„° | Kafka UI Topic Size | ë©”ì‹œì§€ ìˆ˜ NFS | ì•½ 63 MB | 19,000 Ceph | ì•½ 383 MB | 19,000\nS2. ë‹¤ì¤‘ Producer Throughput ì¸¡ì • # for i in {1..5}; do echo \u0026#34;[INFO] Starting producer $i\u0026#34; bin/kafka-producer-perf-test.sh \\ --topic test-topic \\ --num-records 100000 \\ --record-size 1024 \\ --throughput -1 \\ --producer-props bootstrap.servers=\u0026lt;bootstrap\u0026gt; \\ S2 - ê²°ê³¼ # Storage ë©”ì‹œì§€ ìˆ˜ Avg Throughput (MB/s) Std Avg Latency (ms) Std Ceph 100 145.41 Â±4.58 75.62 Â±10.33 Ceph 500 524.29 Â±25.50 171.46 Â±20.00 Ceph 1,000 1079.18 Â±71.19 160.37 Â±32.10 Ceph 3,000 1497.76 Â±97.84 593.03 Â±76.98 Ceph 5,000 1773.06 Â±70.65 1002.05 Â±64.60 Ceph 10,000 1117.00 Â±6.63 3967.63 Â±110.83 Ceph 50,000 1355.23 Â±4.85 14715.06 Â±182.03 - - - - - - NFS 100 65.54 Â±11.68 40.95 Â±97.09 NFS 500 106.50 Â±5.61 1,940.27 Â±122.21 NFS 1,000 399.04 Â±14.09 976.34 Â±67.71 NFS 3,000 446.17 Â±6.79 3000.52 Â±129.00 NFS 5,000 428.52 Â±3.59 5285.97 Â±107.04 NFS 10,000 439.79 Â±2.63 10777.37 Â±152.69 NFS 50,000 425.29 Â±2.34 51486.65 Â±539.49 âœ… Ceph RBDëŠ” ì „ êµ¬ê°„ì—ì„œ NFS ëŒ€ë¹„ 3~4ë°° ì´ìƒ ìš°ìˆ˜í•œ ì„±ëŠ¥\nThroughputì€ NFS ëŒ€ë¹„ 3~4ë°° ì´ìƒ ë†’ìŒ LatencyëŠ” NFS ëŒ€ë¹„ 4~10ë°° ì´ìƒ ë‚®ìŒ âœ… NFSëŠ” ë©”ì‹œì§€ ìˆ˜ ì¦ê°€ì— ë”°ë¼ Latencyê°€ ì„ í˜•ì ìœ¼ë¡œ ì•…í™”\në””ìŠ¤í¬ flush ì£¼ê¸°ì™€ fsync() ë™ê¸°í™” ì§€ì—°ì´ ëˆ„ì ë˜ì–´ ì „ì²´ ì²˜ë¦¬ ì‹œê°„ ì¦ê°€ ì´ˆë‹¹ ì²˜ë¦¬ëŸ‰ì€ ì¼ì • ìˆ˜ì¤€(400~440 MB/s)ì—ì„œ ì •ì²´, ìŠ¤ë¡œí‹€ë§ ë°œìƒ âœ… Cephì€ ë³‘ë ¬ ì“°ê¸° êµ¬ì¡°ë¡œ throughput ìœ ì§€ë ¥ ìš°ìˆ˜\në©”ì‹œì§€ ìˆ˜ ì¦ê°€ì—ë„ ì¼ì • ìˆ˜ì¤€ throughput ìœ ì§€ (íŠ¹íˆ 50,000ê±´ì—ì„œ ì•ˆì •ì ) ë³‘ë ¬ ì²˜ë¦¬, OSD ë¶„ì‚° ì €ì¥, ë¹ ë¥¸ segment flush êµ¬ì¡°ê°€ ì›ì¸ S3. Consumer ì²˜ë¦¬ ì‹œê°„ # time bin/kafka-consumer-perf-test.sh \\ --broker-list \u0026lt;bootstrap\u0026gt; \\ --topic test-topic \\ --messages 100000 \\ S3 - ê²°ê³¼ # ë©”ì‹œì§€ ìˆ˜ Ceph Throughput (msg/s) NFS Throughput (msg/s) ì°¨ì´ ë°°ìœ¨ ë¹„ê³  100 2,994.0 123.5 24.2Ã— ì´ˆê¸° ë©”ì‹œì§€ ìˆ˜ ì ìŒì—ë„ latency ì°¨ì´ í¼ 500 114.2 123.7 0.92Ã— NFSê°€ ì†Œí­ ë¹ ë¦„ 1000 124.5 44.1 2.8Ã— ì´ˆê¸° ë©”ì‹œì§€ ìˆ˜ ì ìŒì—ë„ latency ì°¨ì´ í¼ 3000 740.1 766.6 1.0Ã— ê±°ì˜ ë¹„ìŠ· 5000 1261.6 1270.3 1.0Ã— ê±°ì˜ ë¹„ìŠ· 10000 2686.9 2419.9 1.1Ã— Cephì´ ë” ë¹ ë¦„ 50000 8797.9 8732.2 1.0Ã— ë™ì¼ ìˆ˜ì¤€ 100000 13595.7 13653.5 0.99Ã— NFSê°€ ì†Œí­ ë¹ ë¦„ âœ… Ceph RBDëŠ” ì „ì²´ì ìœ¼ë¡œ ì•ˆì •ì ì´ì§€ë§Œ, Consumer í…ŒìŠ¤íŠ¸ì—ì„  Throughputì—ì„œ NFSì™€ í° ì°¨ì´ëŠ” ì—†ìŒ. ê·¸ëŸ¬ë‚˜ Fetch Timeê³¼ Rebalance Timeì—ì„œ Cephì´ ì¼ê´€ë˜ê³  ì§§ì€ ì‹œê°„ì„ ë³´ì„.\nFetch Time : Kafka Consumerê°€ Brokerë¡œë¶€í„° messageë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ê±¸ë¦¬ëŠ” ì‹œê°„ Rebalance Time : Kafka Consumer Groupì—ì„œ ìƒˆë¡œìš´ Consumerê°€ joiní•˜ê±°ë‚˜ leave í•  ë•Œ, íŒŒí‹°ì…˜ì´ ì¬í• ë‹¹ë˜ë©° ì´ ê³¼ì •ì—ì„œ ê±¸ë¦¬ëŠ” ì‹œê°„ S4. ì¥ì‹œê°„ ë¶€í•˜í…ŒìŠ¤íŠ¸ # time bin/kafka-producer-perf-test.sh \\ --topic test-topic \\ --num-records 3600000 \\ --record-size 1024 \\ --throughput 1000 \\ --producer-props bootstrap.servers=\u0026lt;bootstrap\u0026gt; \\ S4 - ê²°ê³¼ # í•­ëª© NFS Ceph RBD ì°¨ì´ ë¶„ì„ ì „ì†¡ ì´ëŸ‰ 3,600,000 records 3,600,000 records ë™ì¼ ì „ì†¡ ì†ë„ (records/sec) 405.74 999.98 Cephì´ ì•½ 2.46ë°° ë¹ ë¦„ ë°ì´í„° ì „ì†¡ëŸ‰ (MB/sec) 0.40 MB/sec 0.98 MB/sec Cephì´ 2.45ë°° ë†’ìŒ í‰ê·  Latency 75,165.08 ms 89.75 ms NFSê°€ 837ë°° ëŠë¦¼ ìµœëŒ€ Latency 83,580.00 ms 1,923.00 ms NFSê°€ 43.5ë°° ëŠë¦¼ 50th Percentile (p50) 75,989 ms 26 ms NFSê°€ 2,922ë°° ëŠë¦¼ 95th Percentile (p95) 80,636 ms 502 ms NFSê°€ 160ë°° ëŠë¦¼ 99th Percentile (p99) 82,362 ms 824 ms NFSê°€ 99.9ë°° ëŠë¦¼ 99.9th Percentile (p99.9) 82,991 ms 1,326 ms NFSê°€ 62.5ë°° ëŠë¦¼ S5. ëŒ€ìš©ëŸ‰ ë©”ì„¸ì§€ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸ # bin/kafka-producer-perf-test.sh \\ --topic test-topic-large \\ --num-records 100000 \\ --record-size 100000 \\ --throughput -1 \\ --producer-props bootstrap.servers=\u0026lt;bootstrap\u0026gt; ì´í‰ # í•­ëª© Ceph RBD NFS Throughput âœ” ìµœëŒ€ì¹˜ ê±°ì˜ ë„ë‹¬ (ì•ˆì •ì  ìœ ì§€) âŒ 400~440 records/secì—ì„œ ì •ì²´ Latency âœ” 10~20ms ìˆ˜ì¤€, ì „ êµ¬ê°„ ì•ˆì •ì  âŒ ìˆ˜ì‹­~ìˆ˜ì²œ ms, ë©”ì‹œì§€ ìˆ˜ ì¦ê°€ ì‹œ ì•…í™” ë³‘ë ¬ ì²˜ë¦¬ âœ” OSD ê¸°ë°˜ ë¶„ì‚° ì“°ê¸°, flush íš¨ìœ¨ ë†’ìŒ âŒ sync/flush ë³‘ëª©, ì„ í˜•ì  ì§€ì—° ë°œìƒ ìì› ì‚¬ìš© (CPU) âœ” ë” ë§ì´ ì“°ê³  ì„±ëŠ¥ í™•ë³´ âŒ ì ê²Œ ì“°ì§€ë§Œ ì²˜ë¦¬ ì„±ëŠ¥ ë‚®ìŒ ìš´ì˜ ì í•©ì„± âœ” ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë° / ê³ ë¶€í•˜ í™˜ê²½ âŒ dev/test ë“± ì €ë¶€í•˜ ìš©ë„ì— í•œì • Ceph RBDëŠ” ëª¨ë“  êµ¬ê°„ì—ì„œ NFS ëŒ€ë¹„ 3~10ë°° ì´ìƒ ìš°ìˆ˜ Kafkaì˜ íŠ¹ì„±ìƒ, ì €ì¥ì†Œ ì„ íƒì´ ì„±ëŠ¥ê³¼ ì•ˆì •ì„±ì— ì§ì ‘ ì˜í–¥ NFSëŠ” ì‹¤ì‹œê°„ ì²˜ë¦¬ ì‹œìŠ¤í…œì— ë¶€ì í•© ìš´ì˜ í™˜ê²½ì—ì„œëŠ” ë°˜ë“œì‹œ block ê¸°ë°˜ ê³ ì„±ëŠ¥ ìŠ¤í† ë¦¬ì§€ ì‚¬ìš© ê¶Œì¥ ì´ í…ŒìŠ¤íŠ¸ë¥¼ ë§ˆì¹  ë–„ ì¯¤ í•œê°€ì§€ ê¹¨ë‹¬ì€ê²Œ ìˆì—ˆë‹¤. k8s í´ëŸ¬ìŠ¤í„° ì™¸ë¶€ì— ë‘ëŠ”ê²Œ ê°€ì¥ ì„±ëŠ¥ì€ ì¢‹ì§€ë§Œ, \u0026ldquo;ì„±ëŠ¥\u0026quot;ë§Œ ìƒê°í•œë‹¤ë©´ êµ³ì´ block storage toolì„ ì•ˆì“°ê³ ë„ Local PVë¥¼ ì“¸ ìˆ˜ ìˆê³  ì´ë¥¼ ì˜ë§Œ ë°±ì—…í•´ë‘”ë‹¤ë©´ \u0026ldquo;ì¥ì• \u0026rdquo; ì¸¡ë©´ë„ ë¬´ë¦¬ê°€ ì—†ë‹¤ëŠ” ê²ƒì„\u0026hellip;\n"},{"id":21,"href":"/docs/data-integration/kafka/kafka-storage/","title":"Kafkaì˜ ì €ì¥ì†Œ","section":"Kafka","content":"Kubernetesì—ì„œ kafkaë¥¼ ì‚¬ìš©í• ë•Œ kafkaì˜ ë°ì´í„° ì €ì¥ì†ŒëŠ” ì–´ë–¤ ê²ƒì´ ì ì ˆí•œì§€ì— ëŒ€í•œ ê¸€ì´ë‹¤.\nEfficient data storage is essential for Strimzi to operate effectively, and block storage is strongly recommended. Strimzi has been tested only with block storage, and file storage solutions like NFS are not guaranteed to work.\nStrimziëŠ” block storageë§Œì„ ëŒ€ìƒìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ë° ì¸ì¦í–ˆìœ¼ë©°, NFS ê¸°ë°˜ ìŠ¤í† ë¦¬ì§€ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì´ìœ ë¡œ ì‚¬ìš©ì„ ê¶Œì¥í•˜ì§€ ì•ŠìŒ\në™ì‹œ ì ‘ê·¼ ì‹œ locking ì´ìŠˆ ë°œìƒ rename, append ë“± Kafkaê°€ ìš”êµ¬í•˜ëŠ” íŒŒì¼ ì‹œìŠ¤í…œ íŠ¹ì„±ê³¼ ì¶©ëŒ ê°€ëŠ¥ Latency ë° Throughput ë¶ˆì•ˆì •ì„± (íŠ¹íˆ segment flush, recovery ì‹œ ì‹¬ê°) File handle ëˆ„ìˆ˜ë‚˜ lease ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŒ Kafkaì˜ ì €ì¥ ë°©ì‹ ìˆœì„œ # log messageë¥¼ segment fileì— append memory flush â†’ fsync to disk segmentê°€ ì¼ì • í¬ê¸° ë„ë‹¬ ì‹œ rename(segment.000.log â†’ segment.001.log) index íŒŒì¼ ë™ê¸°í™” ë° offset í™•ì¸ restart ì‹œ íŒŒì¼ ì •í•©ì„± ì²´í¬ â†’ ìœ„ ì‘ì—…ë“¤ì€ block-level consistencyì™€ atomic operation ë³´ì¥ì„ ì „ì œë¡œ ì„¤ê³„ë¨\nì¦‰, KafkaëŠ” log-segment ê¸°ë°˜ìœ¼ë¡œ\në°ì´í„°ëŠ” ì§€ì†ì ìœ¼ë¡œ append-write ë˜ê³  ì£¼ê¸°ì ìœ¼ë¡œ fsync, flush, segment íŒŒì¼ rename ì‘ì—…ì´ ë°œìƒ ì¬ì‹œì‘ ì‹œ segment recoveryë¥¼ ìœ„í•´ .log, .index íŒŒì¼ì˜ ì •í•©ì„±ì´ ë§¤ìš° ì¤‘ìš” í•˜ì§€ë§Œâ€¦ NFSëŠ”\nclientë§ˆë‹¤ lock ë™ì‘ ë°©ì‹ ë‹¤ë¦„ â†’ flockì´ë‚˜ fcntl ë¬´ë ¥í™” ê°€ëŠ¥ íŒŒì¼ lockingê³¼ renameì— ì œì•½ì´ ìˆìœ¼ë©° KafkaëŠ” ì¬ì‹œì‘ ì‹œ log/index íŒŒì¼ì„ ë³µêµ¬ â†’ NFSëŠ” file handle ëˆ„ë½, incomplete renameìœ¼ë¡œ ì¸í•´ fail ê°€ëŠ¥ write latencyê°€ ë†’ê³ , IOPSê°€ ë‚®ì€ ê²½ìš°ê°€ ë§ìŒ -\u0026gt; Kafkaì˜ ì•ˆì •ì„±ê³¼ ì„±ëŠ¥ì— ì¹˜ëª…ì ì¼ ìˆ˜ ìˆìŒ "},{"id":22,"href":"/docs/infra/kubernetes/install-with-kubespray/","title":"Kubesprayë¡œ ì‰½ê²Œ êµ¬ì¶•í•˜ê¸°","section":"Kubernetes","content":" ğŸ•’ ì‘ì„±ì¼: 2025-04-15T17:35:26+09:00 âœï¸ ì‘ì„±ì: SteveArseneLee\nëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê³³ì—ì„œ ë‹¤ìŒê³¼ ê°™ì€ ì‘ì—…ì„ ì‹¤í–‰í•œë‹¤. In my case, it\u0026rsquo;s control node.\nKubespray Downlaod \u0026amp; venv setting # í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜ sudo apt update sudo apt install -y git python3-venv python3-pip # Kubespray ë‹¤ìš´ë¡œë“œ git clone https://github.com/kubernetes-sigs/kubespray.git cd kubespray # Python ê°€ìƒí™˜ê²½ ì„¤ì • python3 -m venv k8s-venv source k8s-venv/bin/activate # ì˜ì¡´ì„± ì„¤ì¹˜ pip install -r requirements.txt Inventory êµ¬ì„± # ìƒ˜í”Œ inventory ë³µì‚¬ cp -rfp inventory/sample inventory/mycluster # í¸ì§‘ê¸°ë¡œ inventory êµ¬ì„± íŒŒì¼ ìˆ˜ì • vim inventory/mycluster/inventory.ini inventory.iniëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.\n[kube_control_plane] k8s-m1 ansible_host=192.168.0.101 ip=192.168.0.101 k8s-m2 ansible_host=192.168.0.102 ip=192.168.0.102 k8s-m3 ansible_host=192.168.0.103 ip=192.168.0.103 [etcd] k8s-m1 k8s-m2 k8s-m3 [kube_node] k8s-w1 ansible_host=192.168.0.104 ip=192.168.0.104 k8s-w2 ansible_host=192.168.0.105 ip=192.168.0.105 k8s-w3 ansible_host=192.168.0.106 ip=192.168.0.106 k8s-w4 ansible_host=192.168.0.107 ip=192.168.0.107 k8s-w5 ansible_host=192.168.0.108 ip=192.168.0.108 k8s-w6 ansible_host=192.168.0.109 ip=192.168.0.109 k8s-w7 ansible_host=192.168.0.110 ip=192.168.0.110 [k8s_cluster:children] kube_control_plane kube_node [all:vars] ansible_user=ubuntu ssh ì ‘ì† í™•ì¸ ë° ping test # passwordless ssh ì ‘ì† ê°€ëŠ¥í•œì§€ í™•ì¸ ansible -i inventory/mycluster/inventory.ini all -m ping ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ì— ë‹¤ìŒ ëª…ë ¹ì–´ ì‹¤í–‰ ubuntu ì‚¬ìš©ìì—ê²Œ sudo ë¹„ë°€ë²ˆí˜¸ ì—†ì´ ì‹¤í–‰ í—ˆìš© echo \u0026#39;ubuntu ALL=(ALL) NOPASSWD:ALL\u0026#39; | sudo tee /etc/sudoers.d/ubuntu Cluster install ansible-playbook -i inventory/mycluster/inventory.ini cluster.yml -b --become-user=root "},{"id":23,"href":"/docs/infra/kvm/storage-settings/","title":"KVMì—ì„œ ì‚¬ìš©í•  Storage ì„¤ì •","section":"KVM","content":" 1. Logical Volume ìƒì„± # ë¬¼ë¦¬ ì €ì¥ì†Œì— ë…¼ë¦¬ ë³¼ë¥¨ì„ ë¨¼ì € í• ë‹¹í•´ì¤€ë‹¤\nsudo lvcreate -L {í¬ê¸° e.g. 300G} -n {LVì´ë¦„ e.g. kvm-pool-lv} {Volume Group ì´ë¦„ e.g. ubuntu-vg} 2. íŒŒì¼ ì‹œìŠ¤í…œ ìƒì„± (ext4) # sudo mkfs.ext4 /dev/ubuntu-vg/kvm-pool-lv 3. ë§ˆìš´íŠ¸ dir ìƒì„± # sudo mkdir -p /mnt/kvm-pool 4. fstab ë“±ë¡ (ìë™ ë§ˆìš´íŠ¸ ì„¤ì •) # echo \u0026#39;/dev/ubuntu-vg/ceph-pool-lv /mnt/ceph-pool ext4 defaults 0 2\u0026#39; | sudo tee -a /etc/fstab sudo mount -a 5. ê¶Œí•œ ë³€ê²½(libvirtê°€ ì ‘ê·¼ ê°€ëŠ¥í•˜ê²Œ) # sudo chown libvirt-qemu:kvm /mnt/ceph-pool sudo chmod 770 /mnt/ceph-pool 6. libvirt Storage Pool ë“±ë¡ (virsh) # sudo virsh pool-define-as ceph-pool dir - - - - /mnt/ceph-pool sudo virsh pool-build ceph-pool sudo virsh pool-start ceph-pool sudo virsh pool-autostart ceph-pool "},{"id":24,"href":"/docs/observability/metrics/prom-test/","title":"Prom","section":"Metrics","content":" Producer Acks, Batch, Page Cache and Flush # acks ì„¤ì •ì€ ìš”ì²­ì´ ì„±ê³µí•  ë•Œë¥¼ ì •ì˜í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” Producerì— ì„¤ì •í•˜ëŠ” Parameter\nacks=0 : ackê°€ í•„ìš”í•˜ì§€ ì•ŠìŒ. ì´ ìˆ˜ì¤€ì€ ìì£¼ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ. ë©”ì‹œì§€ ì†ì‹¤ì´ ë‹¤ì†Œ ìˆë”ë¼ë„ ë¹ ë¥´ê²Œ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ì•¼ í•˜ëŠ” ê²½ìš°ì— ì‚¬ìš©ëœë‹¤. acks=1(default) : Leaderê°€ ë©”ì‹œì§€ë¥¼ ìˆ˜ì‹ í•˜ë©´ ackë¥¼ ë³´ëƒ„. Leaderê°€ Producerì—ê²Œ ACKë¥¼ ë³´ë‚¸ í›„, Followerê°€ ë³µì œí•˜ê¸°ë…ì „ì— Leaderì— ì¥ì• ê°€ ë°œìƒí•˜ë©´ ë©”ì‹œì§€ê°€ ì†ì‹¤. â€œAt most once(ìµœëŒ€ í•œ ë²ˆ)â€ ì „ì†¡ì„ ë³´ì¥ acks=-1(acks=all) : ë©”ì‹œì§€ê°€ Leaderê°€ ëª¨ë“  Replicaê¹Œì§€ Commit ë˜ë©´ ackë¥¼ ë³´ëƒ„ Leaderë¥¼ ìƒì–´ë„ ë°ì´í„°ê°€ ì‚´ì•„ë‚¨ì„ ìˆ˜ ìˆë„ë¡ ë³´ì¥. ê·¸ëŸ¬ë‚˜ ëŒ€ê¸° ì‹œê°„ì´ ë” ê¸¸ê³  íŠ¹ì • ì‹¤íŒ¨ ì‚¬ë¡€ì—ì„œ ë°˜ë³µë˜ëŠ” ë°ì´í„° ë°œìƒ ê°€ëŠ¥ì„± ìˆìŒ. â€œAt least once(ìµœì†Œ í•œ ë²ˆ)â€ ì „ì†¡ì„ ë³´ì¥ Producer Retry # retryì™€ ê´€ë ¨ëœ Parameters:\nParameter ì„¤ëª… Default ê°’ retries ë©”ì„¸ì§€ë¥¼ sendí•˜ê¸° ìœ„í•´ ì¬ì‹œë„í•˜ëŠ” íšŸìˆ˜ MAX_INT retry.backoff.ms ì¬ì‹œë„ ì‚¬ì´ì— ì¶”ê°€ë˜ëŠ” ëŒ€ê¸° ì‹œê°„ 100 request.timeout.ms Producerê°€ ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ëŠ” ìµœëŒ€ ì‹œê°„ 30,000(30ì´ˆ) delivery.timeout.ms send() í›„ ì„±ê³µ ë˜ëŠ” ì‹¤íŒ¨ë¥¼ ë³´ê³ í•˜ëŠ” ì‹œê°„ì˜ ìƒí•œ 120,000(2ë¶„) =\u0026gt; retriesë¥¼ ì¡°ì •í•˜ëŠ” ëŒ€ì‹  delivery.timeout.ms ì¡°ì •ìœ¼ë¡œ retries ì œì–´ Producer Batch ì²˜ë¦¬ # ë©”ì‹œì§€ë¥¼ ëª¨ì•„ì„œ í•œë²ˆì— ì „ì†¡ Batch ì²˜ë¦¬ëŠ” RPC(Remote Procedure Call)ìˆ˜ë¥¼ ì¤„ì—¬ì„œ Brokerê°€ ì²˜ë¦¬í•˜ëŠ” ì‘ì—…ì´ ì¤„ì–´ë“¤ê¸° ë•Œë¬¸ì— ë” ë‚˜ì€ ì²˜ë¦¬ëŸ‰ì„ ì œê³µ linger.ms : (default : 0). ë©”ì‹œì§€ê°€ í•¨ê»˜ Batch ì²˜ë¦¬ë  ë•Œê¹Œì§€ ëŒ€ê¸° ì‹œê°„ batch.size : (default : 16KB). ë³´ë‚´ê¸° ì „ Batchì˜ ìµœëŒ€ í¬ê¸° Batch ì²˜ë¦¬ì˜ ì¼ë°˜ì ì¸ ì„¤ì •ì€ linger.ms=100 ë° batch.size=1000000\nPage Cacheì™€ Flush # ë©”ì‹œì§€ëŠ” Partitionì— ê¸°ë¡ë¨ Partitionì€ Log Segment fileë¡œ êµ¬ì„± (ê¸°ë³¸ê°’ : 1GBë§ˆë‹¤ ìƒˆë¡œìš´ Segment ìƒì„±) ì„±ëŠ¥ì„ ìœ„í•´ Log SegmentëŠ” OS Page Cacheì— ê¸°ë¡ë¨ ë¡œê·¸ íŒŒì¼ì— ì €ì¥ëœ ë©”ì‹œì§€ì˜ ë°ì´í„° í˜•ì‹ì€ Brokerê°€ Producerë¡œë¶€í„° ìˆ˜ì‹ í•œ ê²ƒ, ê·¸ë¦¬ê³  Consumerì—ê²Œ ë³´ë‚´ëŠ” ê²ƒê³¼ ì •í™•íˆ ë™ì¼í•˜ë¯€ë¡œ, Zero-Copy(Zero-copy ì „ì†¡ì€ ë°ì´í„°ê°€, User Spaceì— ë³µì‚¬ë˜ì§€ ì•Šê³ , CPU ê°œì… ì—†ì´ Page Cacheì™€ Network Buffer ì‚¬ì´ì—ì„œ ì§ì ‘ ì „ì†¡ë˜ëŠ” ê²ƒì„ ì˜ë¯¸. ì´ê²ƒì„ í†µí•´ Broker Heap ë©”ëª¨ë¦¬ë¥¼ ì ˆì•½í•˜ê³  ë˜í•œ ì—„ì²­ë‚œ ì²˜ë¦¬ëŸ‰ì„ ì œê³µ)ê°€ ê°€ëŠ¥ Page CacheëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê²½ìš° ë””ìŠ¤í¬ë¡œ Flushë¨ Brokerê°€ ì™„ì „íˆ ì¢…ë£Œ OS background â€œFlusher Threadâ€ ì‹¤í–‰ Flush ì „ì— Broker ì¥ì• ê°€ ë°œìƒí•˜ë©´\u0026hellip; # OSê°€ ë°ì´í„°ë¥¼ ë””ìŠ¤í¬ë¡œ flushí•˜ê¸° ì „ brokerì˜ ì‹œìŠ¤í…œì— ì¥ì• ê°€ ë°œìƒí•˜ë©´ í•´ë‹¹ ë°ì´í„°ê°€ ì†ì‹¤ë¨ Partitionì´ Replicationë˜ì–´ ìˆë‹¤ë©´, Brokerê°€ ë‹¤ì‹œ ì˜¨ë¼ì¸ ìƒíƒœê°€ ë˜ë©´ í•„ìš”ì‹œ Leader Replicaì—ì„œ ë°ì´í„°ê°€ ë³µêµ¬ë¨ Replicationì´ ì—†ë‹¤ë©´, ë°ì´í„°ëŠ” ì˜êµ¬ì  ì†ì‹¤ ê°€ëŠ¥ Kafka ìì²´ Flush ì •ì±… # ë§ˆì§€ë§‰ Flush ì´í›„ì˜ ë©”ì‹œì§€ ìˆ˜(log.flush.interval.messages) ë˜ëŠ” ì‹œê°„(log.flush.interval.ms)ìœ¼ë¡œ Flush(fsync)ë¥¼ íŠ¸ë¦¬ê±°í•˜ë„ë¡ ì„¤ì •í•  ìˆ˜ ìˆìŒ KafkaëŠ” ìš´ì˜ ì²´ì œì˜ background Flush ê¸°ëŠ¥(ì˜ˆ: pdflush)ì„ ë” íš¨ìœ¨ì ìœ¼ë¡œ í—ˆìš©í•˜ëŠ” ê²ƒì„ ì„ í˜¸í•˜ê¸° ë•Œë¬¸ì— ì´ëŸ¬í•œ ì„¤ì •ì€ ê¸°ë³¸ì ìœ¼ë¡œ ë¬´í•œ(ê¸°ë³¸ì ìœ¼ë¡œ fsync ë¹„í™œì„±í™”)ìœ¼ë¡œ ì„¤ì • ì´ëŸ¬í•œ ì„¤ì •ì„ ê¸°ë³¸ê°’ìœ¼ë¡œ ìœ ì§€í•˜ëŠ” ê²ƒì„ ê¶Œì¥ *.log íŒŒì¼ì„ ë³´ë©´ ë””ìŠ¤í¬ë¡œ Flushëœ ë°ì´í„°ì™€ ì•„ì§ Flushë˜ì§€ ì•Šì€ Page Cache (OS Buffer)ì— ìˆëŠ” ë°ì´í„°ê°€ ëª¨ë‘ í‘œì‹œë¨ Flushëœ í•­ëª©ê³¼ Flushë˜ì§€ ì•Šì€ í•­ëª©ì„ í‘œì‹œí•˜ëŠ” Linux ë„êµ¬(ì˜ˆ: vmtouch)ë„ ìˆìŒ Replica Failure # Replica Recovery # Consumer Rebalance # Partition Assignment Strategy # Cooperative Sticky Assignor # Kafka Log File # Log Retention and Cleanup Policy # Exactly Once Semantics(EOS) # "},{"id":25,"href":"/docs/others/todolist/","title":"Todo List","section":"Others","content":" Todo\u0026hellip; # Ingress ì„¤ì • Test Kafka ì˜¬ë¦¬ê¸° Done # Ceph ì˜¬ë¦¬ê¸° "},{"id":26,"href":"/docs/observability/traces/tracing/","title":"Tracingì— ëŒ€í•´ì„œ...","section":"Traces","content":" Tracingì´ë€? # microserviceê°€ ì‹œìŠ¤í…œì„ ê²½ìœ í•˜ë©° transaction ì„ ì²˜ë¦¬í•˜ëŠ” ê³¼ì •ì—ì„œ ë°œìƒí•˜ëŠ” ì„¸ë¶€ì ì¸ ì •ë³´ ë˜í•œ, íŠ¸ëœì­ì…˜ì´ ì´ë™í•œ ê²½ë¡œ, íŠ¸ëœì­ì…˜ì„ ì²˜ë¦¬í•˜ëŠ” ê³¼ì •ì—ì„œ ë°œìƒí•˜ëŠ” ëŒ€ê¸°ì‹œê°„ê³¼ ì§€ì—°ì‹œê°„, ë³‘ëª©í˜„ìƒì´ë‚˜ ì—ëŸ¬ë¥¼ ì¼ìœ¼í‚¤ëŠ” ì›ì¸ì„ ë¬¸ë§¥(context)ê³¼ ë¡œê·¸, íƒœê·¸ ë“±ì˜ metadataì— ì¶œë ¥í•¨\nTracingê³¼ ê´€ë ¨ëœ ìš©ì–´ # Span # ì „ë°˜ì ì¸ ìˆ˜í–‰ ì‹œê°„ ì •ë³´ë¿ë§Œ ì•„ë‹ˆë¼, ê°ê¸° í•˜ìœ„ ë™ì‘ì˜ ì‹œì‘ê³¼ ì†Œìš” ì‹œê°„ ì •ë³´ë¥¼ ì•Œ ìˆ˜ ìˆìŒ. Spanì€ ë™ì‘ ì •ë³´, íƒ€ì„ë¼ì¸ê³¼ ë¶€ëª¨ ìŠ¤íŒ¬ê³¼ì˜ ì˜ì¡´ì„±ì„ ëª¨ë‘ í¬í•¨í•˜ëŠ” ìˆ˜í–‰ ì‹œê°„ì„ ë‹´ê³  ìˆìŒ. Span Context # ìƒˆë¡œìš´ spanì„ ìƒì„±í•˜ê¸° ìœ„í•´ì„  ë‹¤ë¥¸ ìŠ¤íŒ¬ì„ ì°¸ì¡°í•´ì•¼ í•˜ëŠ”ë°, span context ëŠ” ì´ë•Œ í•„ìš”í•œ ì •ë³´ë¥¼ ì œê³µí•¨. Span context ë¡œ í‘œí˜„ëœ ë©”íƒ€ë°ì´í„°ë¥¼ ì“¸ ìˆ˜ ìˆëŠ” Inject ì™€ ì½ì„ ìˆ˜ ìˆëŠ” Extract ë©”ì„œë“œë¥¼ ì œê³µí•¨. ì¦‰, Span context ëŠ” ì£¼ì…ê³¼ ì¶”ì¶œì„ í†µí•´ í—¤ë”ì— ì „ë‹¬ë˜ë©°, ì „ë‹¬ëœ Span context ì—ì„œ ì¶”ì¶œí•œ ìŠ¤íŒ¬ ì •ë³´ë¡œ ìƒˆë¡œìš´ ìì‹ ìŠ¤íŒ¬ì„ ìƒì„±í•  ìˆ˜ ìˆìŒ. Span Reference # ë‘ ìŠ¤íŒ¬ ì‚¬ì´ì˜ ì¸ê³¼ê´€ê³„ë¥¼ ê°€ë¦¬í‚´ ìŠ¤íŒ¬ ì‚¬ì´ì˜ ì¸ê³¼ê´€ê³„ë¥¼ ì •ì˜í•˜ê³ , ìŠ¤íŒ¬ë“¤ì´ ë™ì¼í•œ ì¶”ì ì— ì†í•œë‹¤ëŠ” ê²ƒì„ tracerê°€ ì•Œ ìˆ˜ ìˆê²Œ í•˜ëŠ” ê²ƒ. ì´ë ‡ë‚˜ ê´€ê³„ëŠ” span reference ë¡œ ë‚˜íƒ€ë‚¨. Span reference ì—ëŠ” child ofì™€ following fromì˜ ë‘ ê°€ì§€ ìœ í˜•ì´ ìˆìŒ. e.g. Span BëŠ” Span Aì˜ child ofì´ê±°ë‚˜, Span Aì˜ following fromì´ë¼ê³  ì •ì˜í•  ìˆ˜ ìˆìŒ. "},{"id":27,"href":"/docs/infra/kvm/vm-calc/","title":"VM ì‚¬ì´ì¦ˆ ë³€ê²½...","section":"KVM","content":"vmë“¤ì„ k8së¡œ ì˜¬ë ¤ë†¨ëŠ”ë°, ë„ˆë¬´ ë¶€í•˜ê°€ í°ë“¯í•˜ë‹¤\u0026hellip; ëª¨ë“ ê±¸ ë‹¤ì‹œ ê³„ì‚°í•´ë´ì•¼ê² ë‹¤.\nMain server # cpu 16, memory 64gb, ssd 1tb master 2ëŒ€, worker 2ëŒ€,\ntest server # cpu 22, memory 64gb, ssd 1tb master 1ëŒ€, worker 3ëŒ€, nfs 1ëŒ€\n"},{"id":28,"href":"/docs/infra/kvm/vm-creattion-guide/","title":"VM ìƒì„±","section":"KVM","content":"[ì¤€ë¹„ ë‹¨ê³„]\nos image ë‹¤ìš´ë¡œë“œ ë°›ì•„ë†“ê¸° Resource ìš©ëŸ‰ ì‚°ì • (cpu, memory, disk) ip ì„¤ê³„ (ì„ íƒ) ë¬¼ë¦¬ ì„œë²„ê°€ nëŒ€ë¼ë©´ VM ë¶„ë°° ê³„íš [ì‹¤ìŠµ ë‹¨ê³„]\nstorage pool \u0026amp; volume ìƒì„± cockpitì—ì„œ vm ìƒì„±(ì´ë•Œ ì•ì„œ ê³„íší•œ ip ë° ìì› í• ë‹¹) # 1. ë””ë ‰í† ë¦¬ ìƒì„± ë° ê¶Œí•œ ì„¤ì • sudo mkdir -p /mnt/kvm-pool sudo chown libvirt-qemu:kvm /mnt/kvm-pool sudo chmod 770 /mnt/kvm-pool # 2. ìŠ¤í† ë¦¬ì§€ í’€ ì •ì˜ ë° ë“±ë¡ sudo virsh pool-define-as kvm-pool dir - - - - /mnt/kvm-pool sudo virsh pool-build kvm-pool sudo virsh pool-start kvm-pool sudo virsh pool-autostart kvm-pool Pool ì‚­ì œí•˜ëŠ” ë²• # # ìŠ¤í† ë¦¬ì§€ í’€ ì¡°íšŒ sudo virsh pool-list --all # ìŠ¤í† ë¦¬ì§€ í’€ ì¤‘ì§€ sudo virsh pool-destroy {poolëª…} # ìŠ¤í† ë¦¬ì§€ í’€ ì •ì˜ ì‚­ì œ sudo virsh pool-undefine {poolëª…} Home # VMëª… CPU RAM ctrl-node 2 2GB k8s-m1 2 4 k8s-m2 2 4 k8s-w1 2 8 k8s-w2 2 8 k8s-w3 2 8 VMëª… Disk CPU RAM ctrl-node /mnt/kvm-pool/ctrl-node.qcow2 2 2GB k8s-m1 /mnt/kvm-pool/k8s-m1.qcow2 2 4GB k8s-m2 /mnt/kvm-pool/k8s-m2.qcow2 2 4GB k8s-w3 /mnt/kvm-pool/k8s-w3.qcow2 2 4GB Test # VMëª… CPU RAM k8s-m3 2 4GB k8s-w4 2 8GB k8s-w5 2 8GB k8s-w6 2 8GB k8s-w7 2 8GB nfs-server 1 2GB VMëª… Disk CPU RAM HOST k8s-m3 /mnt/kvm-pool/k8s-m3.qcow2 2 4GB k8s-w1 /mnt/kvm-pool/k8s-w1.qcow2 2 4GB k8s-w2 /mnt/kvm-pool/k8s-w2.qcow2 2 4GB nfs-server /mnt/kvm-pool/nfs.qcow2 1 2GB "},{"id":29,"href":"/docs/infra/kvm/vm-install-simple/","title":"VM ìƒì„± ê°„ë‹¨","section":"KVM","content":"Homeì—ëŠ”\n#!/bin/bash set -e echo \u0026#34;[HOME SERVER - STORAGE POOL \u0026amp; VOLUME SETUP]\u0026#34; # [1] Storage Pools ìƒì„± echo \u0026#34;[1] Creating storage pools...\u0026#34; sudo mkdir -p /mnt/kvm-pool /mnt/ceph-pool sudo chown libvirt-qemu:kvm /mnt/kvm-pool /mnt/ceph-pool sudo chmod 770 /mnt/kvm-pool /mnt/ceph-pool sudo virsh pool-define-as --name kvm-pool --type dir --target /mnt/kvm-pool sudo virsh pool-build kvm-pool sudo virsh pool-start kvm-pool sudo virsh pool-autostart kvm-pool sudo virsh pool-define-as --name ceph-pool --type dir --target /mnt/ceph-pool sudo virsh pool-build ceph-pool sudo virsh pool-start ceph-pool sudo virsh pool-autostart ceph-pool # [2] Volume ìƒì„± echo \u0026#34;[2] Creating VM OS disks...\u0026#34; cd /mnt/kvm-pool sudo qemu-img create -f qcow2 ctrl-node.qcow2 40G sudo qemu-img create -f qcow2 k8s-m1.qcow2 30G sudo qemu-img create -f qcow2 k8s-m2.qcow2 30G sudo qemu-img create -f qcow2 k8s-w1.qcow2 50G sudo qemu-img create -f qcow2 k8s-w2.qcow2 50G echo \u0026#34;[3] Creating Ceph raw disks...\u0026#34; cd /mnt/ceph-pool sudo qemu-img create -f raw k8s-w1-ceph.img 100G sudo qemu-img create -f raw k8s-w2-ceph.img 100G echo \u0026#34;[HOME SERVER SETUP COMPLETE]\u0026#34; Testì—ëŠ”\n#!/bin/bash set -e echo \u0026#34;[TEST SERVER - STORAGE POOL \u0026amp; VOLUME SETUP]\u0026#34; # [1] Storage Pools ìƒì„± echo \u0026#34;[1] Creating storage pools...\u0026#34; sudo mkdir -p /mnt/kvm-pool /mnt/ceph-pool /mnt/nfs-pool sudo chown libvirt-qemu:kvm /mnt/kvm-pool /mnt/ceph-pool /mnt/nfs-pool sudo chmod 770 /mnt/kvm-pool /mnt/ceph-pool /mnt/nfs-pool # kvm-pool (OSìš©) sudo virsh pool-define-as --name kvm-pool --type dir --target /mnt/kvm-pool sudo virsh pool-build kvm-pool sudo virsh pool-start kvm-pool sudo virsh pool-autostart kvm-pool # ceph-pool (Cephìš©) sudo virsh pool-define-as --name ceph-pool --type dir --target /mnt/ceph-pool sudo virsh pool-build ceph-pool sudo virsh pool-start ceph-pool sudo virsh pool-autostart ceph-pool # kvm-nfs-pool (NFS ì„œë²„ìš©) sudo virsh pool-define-as --name kvm-nfs-pool --type dir --target /mnt/kvm-nfs-pool sudo virsh pool-build kvm-nfs-pool sudo virsh pool-start kvm-nfs-pool sudo virsh pool-autostart kvm-nfs-pool # [2] Volume ìƒì„± echo \u0026#34;[2] Creating VM OS disks...\u0026#34; cd /mnt/kvm-pool sudo qemu-img create -f qcow2 k8s-m3.qcow2 30G sudo qemu-img create -f qcow2 k8s-w3.qcow2 50G sudo qemu-img create -f qcow2 k8s-w4.qcow2 50G sudo qemu-img create -f qcow2 k8s-w5.qcow2 50G sudo qemu-img create -f qcow2 nfs.qcow2 30G echo \u0026#34;[3] Creating Ceph raw disks...\u0026#34; cd /mnt/ceph-pool sudo qemu-img create -f raw k8s-w3-ceph.img 100G sudo qemu-img create -f raw k8s-w4-ceph.img 100G sudo qemu-img create -f raw k8s-w5-ceph.img 100G echo \u0026#34;[4] Creating NFS data disk...\u0026#34; cd /mnt/nfs-pool sudo qemu-img create -f qcow2 nfs-data.qcow2 300G echo \u0026#34;[TEST SERVER SETUP COMPLETE]\u0026#34; "},{"id":30,"href":"/docs/troubleshooting/resource-issue/","title":"ë¦¬ì†ŒìŠ¤ ì´ìŠˆ ì¸í•œ ì¸í”„ë¼ ì¬êµ¬ì¶•","section":"íŠ¸ëŸ¬ë¸”ìŠˆíŒ…","content":" ìƒí™© # ë‹¤ìŒê³¼ ê°™ì€ ì´ìŠˆê°€ ë°œìƒí–ˆë‹¤. í˜„ì¬ êµ¬ì¶•ëœ ìŠ¤íƒì€ ceph, minio, kafka, kafka-uië¿ì¸ë°, request\u0026amp;limitì„ ìµœì í™”í–ˆìŒì—ë„ ë‚´ í™˜ê²½ì—ì„œëŠ” ë‹¤ì†Œ ë²„ê±°ìš´ ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤. ë”°ë¼ì„œ ë‹¤ìŒê³¼ ê°™ì€ ê²°ì •ì„ í•˜ê²Œëë‹¤.\në¬¸ì œ ì›ì¸ # ìœ„ ìŠ¤íƒë“¤ì˜ requestë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ìµœì†Œí™”í–ˆì„ë•Œ\ní•­ëª© Before After Ceph OSD 5ê°œ CPU ìš”ì²­ 2.5ì½”ì–´ 1.5ì½”ì–´ Kafka Pod 3ê°œ CPU ìš”ì²­ 1.5ì½”ì–´ 0.9ì½”ì–´ Kafka-UI ì—†ìŒ 0.1ì½”ì–´ ì´í•© ê°ì†ŒëŸ‰ ì•½ 2.5~3ì½”ì–´ 1.5ì½”ì–´ ì´ìƒ í™•ë³´ ì•„ë˜ì™€ ê°™ì´ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•œë‹¤.\nubuntu@ctrl-node:~/kafka$ kubectl describe nodes | grep -A5 \u0026#34;Allocated resources\u0026#34; Allocated resources: (Total limits may be over 100 percent, i.e., overcommitted.) Resource Requests Limits -------- -------- ------ cpu 1050m (43%) 1 (41%) memory 370760Ki (5%) 1280288k (17%) -- Allocated resources: (Total limits may be over 100 percent, i.e., overcommitted.) Resource Requests Limits -------- -------- ------ cpu 900m (37%) 0 (0%) memory 210800640 (2%) 1024288k (13%) -- Allocated resources: (Total limits may be over 100 percent, i.e., overcommitted.) Resource Requests Limits -------- -------- ------ cpu 800m (23%) 0 (0%) memory 137400320 (1%) 709715200 (9%) -- Allocated resources: (Total limits may be over 100 percent, i.e., overcommitted.) Resource Requests Limits -------- -------- ------ cpu 1675m (69%) 1700m (70%) memory 2987972608 (18%) 6346859776 (40%) -- Allocated resources: (Total limits may be over 100 percent, i.e., overcommitted.) Resource Requests Limits -------- -------- ------ cpu 2625m (77%) 2800m (82%) memory 4957750Ki (32%) 9165432064 (57%) -- Allocated resources: (Total limits may be over 100 percent, i.e., overcommitted.) Resource Requests Limits -------- -------- ------ cpu 2675m (78%) 2300m (67%) memory 4752950Ki (30%) 10104956160 (63%) -- Allocated resources: (Total limits may be over 100 percent, i.e., overcommitted.) Resource Requests Limits -------- -------- ------ cpu 2625m (77%) 2800m (82%) memory 4884022Ki (31%) 10373391616 (65%) -- Allocated resources: (Total limits may be over 100 percent, i.e., overcommitted.) Resource Requests Limits -------- -------- ------ cpu 2375m (69%) 1400m (41%) memory 3835446Ki (24%) 8494343424 (53%) í˜„ì‹¤ì ìœ¼ë¡œ í„±ì—†ì´ ë¶€ì¡±í•œ ë¦¬ì†ŒìŠ¤ë‹¤.\ní•´ê²° ë°©ë²• # ì‚¬ì‹¤ í•´ê²°ì„ í–ˆë‹¤ê¸°ë³´ë‹¨, í˜„ì‹¤ì ì¸ ëŒ€ì•ˆì„ ì°¾ê²Œëë‹¤.\nWorker node ê°œìˆ˜ë¥¼ 4ëŒ€ë¡œ ì¤„ì´ê³  ë¦¬ì†ŒìŠ¤ ì¶”ê°€ í• ë‹¹ Cloud Storage ë„ì… í•­ëª© AWS GCP Azure Block Storage EBS (ê°€ì¥ ì•ˆì •ì , ì˜µì…˜ ë‹¤ì–‘) Persistent Disk (ì†ë„ ì¢‹ìŒ, ê°€ê²© ì €ë ´) Managed Disk (ë¬´ë‚œí•¨) Object Storage S3 (ì—…ê³„ í‘œì¤€, ìƒíƒœê³„ ìµœê°•) GCS (ê°€ê²© ì €ë ´, ì„±ëŠ¥ ë¹ ë¦„) Blob Storage (ë¬´ë‚œ) File Storage EFS (ë¹„ìŒˆ) Filestore (ê°€ê²© ì ë‹¹, ì„±ëŠ¥ ë¹ ë¦„) Azure Files (ê°€ì¥ ì €ë ´) ì´í‰ \u0026ldquo;ê¸°ì—…í‘œì¤€\u0026rdquo; \u0026amp; ë¹„ìŒˆ \u0026ldquo;ê°€ê²©/ì„±ëŠ¥ ê· í˜•\u0026rdquo; ìµœê³  \u0026ldquo;ë¹„ìš© ìµœì €\u0026rdquo; ëª©ì ì´ë©´ ê³ ë ¤ ë¹„ìš©ë§Œ ìƒê°í•œë‹¤ë©´ Azureê°€ ìµœì„ ì´ì§€ë§Œ, í¸ì˜ì„±ì„ ê³ ë ¤í•˜ë©´ AWSë‚˜ GCPë¥¼ ì„ íƒí•´ì•¼í•œë‹¤. ë”°ë¼ì„œ GCPì˜ ìŠ¤í† ë¦¬ì§€ë“¤ì„ ì±„íƒí–ˆë‹¤.\nStorage Type Product Block Storage Balanced Persistent Disk (pd-balanced) Object Storage GCS Standard File Storage Filestore Basic HDD "},{"id":31,"href":"/docs/infra/kubernetes/context-switch/","title":"ì—¬ëŸ¬ í™˜ê²½ì˜ í´ëŸ¬ìŠ¤í„°ë¥¼ ì†ì‰½ê²Œ ê´€ë¦¬í•˜ê¸°","section":"Kubernetes","content":" 1. ì›ê²© í´ëŸ¬ìŠ¤í„°ì˜ kubeconfig ë°›ì•„ì˜¤ê¸° # sudo cat /etc/kubernetes/admin.conf 2. ë¡œì»¬ íŒŒì¼ì— ì €ì¥ ë‚´ ê²½ìš° # ~/kubeconfig |- kubeconfig-cluster1 |- kubeconfig-cluster2 |- ... ì´ëŸ°ì‹ìœ¼ë¡œ ì €ì¥í–ˆìŒ.\n3. context, cluster, nameì´ ì¤‘ë³µë˜ë©´ ì•ˆë¼ì„œ ë³€í™˜í•´ì£¼ëŠ” ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš© # auto-context.sh\n#!/bin/bash set -e if [ $# -ne 1 ]; theì› echo \u0026#34;â— ì‚¬ìš©ë²•: $0 \u0026lt;kubeconfig-íŒŒì¼ ê²½ë¡œ\u0026gt;\u0026#34; exit 1 fi INPUT_PATH=\u0026#34;$1\u0026#34; FILENAME=$(basename \u0026#34;$INPUT_PATH\u0026#34;) CLUSTER_ID=\u0026#34;${FILENAME#kubeconfig-}\u0026#34; echo \u0026#34;ğŸ“Œ í´ëŸ¬ìŠ¤í„° ID: $CLUSTER_ID\u0026#34; echo \u0026#34;ğŸ“‚ ëŒ€ìƒ kubeconfig: $INPUT_PATH\u0026#34; # ğŸ”„ ê¸°ì¡´ ë“±ë¡ ì‚­ì œ kubectl config delete-context ${CLUSTER_ID}-context 2\u0026gt;/dev/null || true kubectl config delete-cluster ${CLUSTER_ID}-cluster 2\u0026gt;/dev/null || true kubectl config delete-user ${CLUSTER_ID}-user 2\u0026gt;/dev/null || true # ğŸ” ì •ë³´ ì¶”ì¶œ SERVER=$(KUBECONFIG=$INPUT_PATH kubectl config view -o jsonpath=\u0026#34;{.clusters[0].cluster.server}\u0026#34;) CERT_AUTH_DATA=$(KUBECONFIG=$INPUT_PATH kubectl config view -o jsonpath=\u0026#34;{.clusters[0].cluster.certificate-authority-data}\u0026#34;) CLIENT_CERT_DATA=$(KUBECONFIG=$INPUT_PATH kubectl config view -o jsonpath=\u0026#34;{.users[0].user.client-certificate-data}\u0026#34;) CLIENT_KEY_DATA=$(KUBECONFIG=$INPUT_PATH kubectl config view -o jsonpath=\u0026#34;{.users[0].user.client-key-data}\u0026#34;) # ğŸ”§ base64 decode â†’ temp íŒŒì¼ CA_FILE=$(mktemp) CERT_FILE=$(mktemp) KEY_FILE=$(mktemp) echo \u0026#34;$CERT_AUTH_DATA\u0026#34; | base64 -d \u0026gt; \u0026#34;$CA_FILE\u0026#34; echo \u0026#34;$CLIENT_CERT_DATA\u0026#34; | base64 -d \u0026gt; \u0026#34;$CERT_FILE\u0026#34; echo \u0026#34;$CLIENT_KEY_DATA\u0026#34; | base64 -d \u0026gt; \u0026#34;$KEY_FILE\u0026#34; # âœ… ì™„ì „ ë“±ë¡ (PEM íŒŒì¼ ë°©ì‹) kubectl config set-cluster ${CLUSTER_ID}-cluster \\ --server=\u0026#34;$SERVER\u0026#34; \\ --certificate-authority=\u0026#34;$CA_FILE\u0026#34; \\ --embed-certs=true kubectl config set-credentials ${CLUSTER_ID}-user \\ --client-certificate=\u0026#34;$CERT_FILE\u0026#34; \\ --client-key=\u0026#34;$KEY_FILE\u0026#34; \\ --embed-certs=true kubectl config set-context ${CLUSTER_ID}-context \\ --cluster=${CLUSTER_ID}-cluster \\ --user=${CLUSTER_ID}-user # ğŸ” ë³‘í•© echo \u0026#34;ğŸ” ë³‘í•© ì¤‘...\u0026#34; MERGE_TARGETS=$(find ~/kubeconfig -type f -name \u0026#39;kubeconfig-*\u0026#39; | tr \u0026#39;\\n\u0026#39; \u0026#39;:\u0026#39; | sed \u0026#39;s/:$//\u0026#39;) KUBECONFIG=$MERGE_TARGETS kubectl config view --flatten \u0026gt; ~/.kube/config chmod 600 ~/.kube/config # ğŸ§¹ ì„ì‹œ íŒŒì¼ ì •ë¦¬ rm -f \u0026#34;$CA_FILE\u0026#34; \u0026#34;$CERT_FILE\u0026#34; \u0026#34;$KEY_FILE\u0026#34; echo \u0026#34;âœ… ë³‘í•© ì™„ë£Œ: ~/.kube/config ê°±ì‹ ë¨\u0026#34; 4. config íŒŒì¼ ìˆ˜ì • # config íŒŒì¼ì„ ì²˜ìŒ ë°›ì•„ì˜¤ë©´ certificate-authority-data ë“±ì˜ ë°ì´í„°ì— DATA+OMITTEDë¼ê³  ì¨ìˆëŠ” ê²½ìš°ê°€ ìˆë‹¤. ì´ëŸ° ê²½ìš° ì‹¤ì œ ë°ì´í„°ë¡œ ë°”ê¿”ì¤€ë‹¤.\nbase64 -w 0 /etc/kubernetes/pki/ca.crt # ì„œë²„ì—ì„œ ì¶”ì¶œí•´ì„œ 5. ì´ì œ ìœ„ configë¥¼ ì‚¬ìš©í•´ ìë™ìœ¼ë¡œ contextë¥¼ ë°”ê¾¸ê¸° # /usr/local/bin/usrì— scë¼ëŠ” íŒŒì¼ì„ ë§Œë“¤ì–´ì£¼ê³ \n#!/bin/zsh autoload -Uz colors \u0026amp;\u0026amp; colors typeset -A CLUSTERS CLUSTERS=( 1 context1 2 context2 3 context3 ) typeset -A DESCRIPTIONS DESCRIPTIONS=( 1 \u0026#34;ğŸ¯ Description of context1\u0026#34; 2 \u0026#34;ğŸ§ª Description of context2\u0026#34; 3 \u0026#34;ğŸ’» Description of context3\u0026#34; ) ORDER=(1 2 3) # ìˆœì„œ ê³ ì • current_context=$(kubectl config current-context 2\u0026gt;/dev/null) echo \u0026#34;\u0026#34; echo \u0026#34;${fg[cyan]}ğŸŒ Kubernetes Context Switcher v3.0${reset_color}\u0026#34; echo \u0026#34;${fg[white]}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${reset_color}\u0026#34; for key in \u0026#34;${ORDER[@]}\u0026#34;; do ctx=${CLUSTERS[$key]} desc=${DESCRIPTIONS[$key]} if [[ \u0026#34;$ctx\u0026#34; == \u0026#34;$current_context\u0026#34; ]]; then printf \u0026#34; %s) ${fg[green]}%s${reset_color} %s ${fg[yellow]}(í˜„ì¬ ì„ íƒë¨)${reset_color}\\n\u0026#34; \u0026#34;$key\u0026#34; \u0026#34;$ctx\u0026#34; \u0026#34;$desc\u0026#34; else printf \u0026#34; %s) ${fg[white]}%s${reset_color} %s\\n\u0026#34; \u0026#34;$key\u0026#34; \u0026#34;$ctx\u0026#34; \u0026#34;$desc\u0026#34; fi done echo \u0026#34;${fg[white]}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${reset_color}\u0026#34; echo \u0026#34;\u0026#34; read \u0026#34;choice?ğŸ”¢ ë²ˆí˜¸ ì…ë ¥: \u0026#34; context=\u0026#34;${CLUSTERS[$choice]}\u0026#34; if [[ -n \u0026#34;$context\u0026#34; ]]; then echo \u0026#34;\u0026#34; echo \u0026#34;${fg[blue]}ğŸ” ì „í™˜ ì¤‘...${reset_color}\u0026#34; kubectl config use-context \u0026#34;$context\u0026#34; echo \u0026#34;${fg[blue]}ğŸ“¡ í´ëŸ¬ìŠ¤í„° ìƒíƒœ í™•ì¸ ì¤‘...${reset_color}\u0026#34; if kubectl get nodes \u0026amp;\u0026gt;/dev/null; then echo \u0026#34;${fg[green]}âœ… ì—°ê²° ì„±ê³µ!${reset_color}\u0026#34; else echo \u0026#34;${fg[red]}âŒ ì—°ê²° ì‹¤íŒ¨. VPNì´ë‚˜ ë„¤íŠ¸ì›Œí¬ ìƒíƒœë¥¼ í™•ì¸í•˜ì„¸ìš”.${reset_color}\u0026#34; fi else echo \u0026#34;${fg[red]}âŒ ìœ íš¨í•˜ì§€ ì•Šì€ ì„ íƒì…ë‹ˆë‹¤.${reset_color}\u0026#34; exit 1 fi "},{"id":32,"href":"/docs/%EC%BB%B4%ED%93%A8%ED%84%B0%EC%9D%B4%EB%A1%A0/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4/normalization/","title":"ì •ê·œí™” - 1NF, 2NF, 3NF, BCNF","section":"ë°ì´í„°ë² ì´ìŠ¤","content":" ì •ê·œí™”ë€? # ë°ì´í„°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê¸° ìœ„í•´ ë°ì´í„°ë¥¼ ì—¬ëŸ¬ í…Œì´ë¸”ë¡œ ë‚˜ëˆ„ê³ , ë°ì´í„° ì¤‘ë³µê³¼ ì´ìƒ í˜„ìƒì„ ìµœì†Œí™”í•´ ë°ì´í„°ì˜ ì¼ê´€ì„±ì„ ìœ ì§€í•˜ëŠ” ê³¼ì •\nì •ê·œí™”ì˜ ëª©í‘œë¥¼ ì •ë¦¬í•˜ìë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.\në°ì´í„° ì¤‘ë³µ ì¤„ì´ê¸° : ë¶ˆí•„ìš”í•˜ê²Œ ë°˜ë³µí•´ì„œ ì €ì¥í•˜ì§€ ì•Šê²Œ í•¨ ë°ì´í„° ë¬´ê²°ì„± ìœ ì§€ : ì‚½ì…, ì‚­ì œ, ê°±ì‹  ì‹œ ì¼ê´€ì„± ìˆê²Œ ë°ì´í„°ê°€ ìœ ì§€ë¨ ì´ìƒ í˜„ìƒ ë°©ì§€ : ì‚½ì…, ì‚­ì œ, ê°±ì‹  ì‹œ ë°œìƒ ê°€ëŠ¥í•œ Anomalies ë°©ì§€ DB ì„±ëŠ¥ ìµœì í™” : í•„ìš”í•œ ë°ì´í„°ë§Œ ì €ì¥í•˜ê³ , ë°ì´í„°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ê²€ìƒ‰í•˜ê³  ìˆ˜ì • ê°€ëŠ¥í•¨ ì´ìƒ í˜„ìƒì´ë€..? # ì •ê·œí™”ë¥¼ í†µí•´ ë°©ì§€í•˜ë ¤ëŠ” ì£¼ìš” ì´ìƒ í˜„ìƒë“¤ì´ë‹¤.\nì‚½ì… ì´ìƒ(Insertion Anomaly) : ë°ì´í„° ì‚½ì… ì‹œ ë¶ˆí•„ìš”í•œ ë°ì´í„°ë¥¼ í•¨ê»˜ ì‚½ì…í•´ì•¼ í•˜ëŠ” ë¬¸ì œ ê°±ì‹  ì´ìƒ(Update Anomaly) : ë°ì´í„°ì˜ ì¼ë¶€ë§Œ ê°±ì‹ í•´ ë°ì´í„° ë¶ˆì¼ì¹˜ê°€ ë°œìƒ ê°€ëŠ¥í•œ ë¬¸ì œ ì‚­ì œ ì´ìƒ(Deletion Anomaly) : ë°ì´í„°ë¥¼ ì‚­ì œí•  ë•Œ ì˜ë„ì¹˜ ì•Šì€ ì •ë³´ë„ í•¨ê»˜ ì‚­ì œë˜ëŠ” ë¬¸ì œ ì •ê·œí˜• # 1NF - \u0026lt;ë°˜ë³µë˜ëŠ” ì†ì„± ë° ê·¸ë£¹ ì†ì„± ì œê±°\u0026gt; # ëª©ì  : ê° ì»¬ëŸ¼ì´ _Atomic Value_ë§Œì„ ê°€ì§€ë„ë¡ í•˜ì—¬, ì»¬ëŸ¼ì— ì—¬ëŸ¬ ê°’ì´ ë“¤ì–´ê°€ëŠ” ê²ƒì„ ë°©ì§€í•œë‹¤. ì¡°ê±´ ëª¨ë“  ì»¬ëŸ¼ ê°’ì´ ì›ìê°’ì´ì–´ì•¼ í•˜ë©°, ê° ì…€ì— ë‹¨ì¼ ê°’ë§Œ í¬í•¨ë˜ì–´ì•¼ í•œë‹¤. ë°˜ë³µ ê·¸ë£¹(í•œ ì»¬ëŸ¼ì— ì—¬ëŸ¬ ê°œì˜ ê°’ì´ ìˆëŠ” ê²½ìš°)ì´ë‚˜ ì¤‘ì²©ëœ ì§‘í•©ì´ ì—†ì–´ì•¼ í•œë‹¤. í•™ìƒID ì´ë¦„ ì „í™”ë²ˆí˜¸ 1 ê¹€ì² ìˆ˜ 010-111-222, 010-333-444 2 ì´ì˜í¬ 010-555-666 ì „í™”ë²ˆí˜¸ ì»¬ëŸ¼ì— ì—¬ëŸ¬ ê°’ì´ í¬í•¨ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ë‹¤ìŒê³¼ ê°™ì´ ë³€ê²½í•œë‹¤.\ní•™ìƒID ì´ë¦„ ì „í™”ë²ˆí˜¸ 1 ê¹€ì² ìˆ˜ 010-111-222 1 ê¹€ì² ìˆ˜ 010-333-444 2 ì´ì˜í¬ 010-555-666 ì „í™”ë²ˆí˜¸ ì»¬ëŸ¼ì„ ì—¬ëŸ¬ í–‰ìœ¼ë¡œ ë‚˜ëˆ  ê° í–‰ì´ í•˜ë‚˜ì˜ ì „í™”ë²ˆí˜¸ë§Œ í¬í•¨í•˜ë„ë¡ í•´ ì›ìê°’ì„ ê°–ë„ë¡ í•œë‹¤.\n2NF - \u0026lt;ë¶€ë¶„ í•¨ìˆ˜ ì¢…ì†ì„± ì œê±°\u0026gt; # ëª©ì  : ë¶€ë¶„ í•¨ìˆ˜ ì¢…ì†ì„±ì„ ì œê±°í•´ ë°ì´í„°ì˜ ì¤‘ë³µì„ ì¤„ì´ê³ , ë°ì´í„°ì˜ ì¼ê´€ì„±ì„ ìœ ì§€í•œë‹¤. ê¸°ë³¸ í‚¤ì˜ ì¼ë¶€ê°€ ì•„ë‹Œ ì „ì²´ì— ì¢…ì†ë˜ë„ë¡ í•´ ë°ì´í„° ë³€ê²½ ì‹œ ì¼ê´€ì„±ì„ ë†’ì¸ë‹¤. ì¡°ê±´ 1NFë¥¼ ë§Œì¡±í•œë‹¤. ê¸°ë³¸ í‚¤ê°€ ë³µí•© í‚¤ì¸ ê²½ìš°, ë¶€ë¶„ í•¨ìˆ˜ ì¢…ì†ì„±ì´ ì—†ì–´ì•¼ í•œë‹¤. ì¦‰, ë¹„ê¸°ë³¸ í‚¤ ì†ì„±ì´ ê¸°ë³¸ í‚¤ ì „ì²´ì— ì¢…ì†ë˜ì–´ì•¼ í•œë‹¤. 1NFë§Œ ë§Œì¡±í•œ Table\ní•™ìƒID ê³¼ëª©ID ê³¼ëª©ëª… êµìˆ˜ëª… 1 A101 ìˆ˜í•™ ê¹€êµìˆ˜ 1 B202 ì˜ì–´ ë°•êµìˆ˜ 2 A101 ìˆ˜í•™ ê¹€êµìˆ˜ 2 B202 ì˜ì–´ ë°•êµìˆ˜ ê³¼ëª©ëª…ê³¼ êµìˆ˜ëª…ì€ ê³¼ëª©IDì— ì¢…ì†ë˜ë©°, í•™ìƒIDì™€ëŠ” ë¬´ê´€í•˜ë‹¤.\nì¦‰, ë¶€ë¶„ í•¨ìˆ˜ ì¢…ì†ì´ ë°œìƒí•´ 2NFë¥¼ ë§Œì¡±í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ë‹¤ìŒê³¼ ê°™ì´ ë³€ê²½í•œë‹¤.\ní•™ìƒ-ê³¼ëª© ê´€ê³„ Table\ní•™ìƒID ê³¼ëª©ID 1 A101 1 B202 2 A101 2 B202 ê³¼ëª© Table\nê³¼ëª©ID ê³¼ëª©ëª… êµìˆ˜ëª… A101 ìˆ˜í•™ ê¹€êµìˆ˜ B202 ì˜ì–´ ë°•êµìˆ˜ ê³¼ëª©IDê°€ ê³¼ëª©ëª…ê³¼ êµìˆ˜ëª…ì„ ê²°ì •í•˜ë„ë¡ í…Œì´ë¸”ì„ ë¶„ë¦¬í•´ ë¶€ë¶„ í•¨ìˆ˜ ì¢…ì†ì„±ì„ ì œê±°í–ˆë‹¤. ê³¼ëª©ëª…ê³¼ êµìˆ˜ëª… ì •ë³´ê°€ ì¤‘ë³µë˜ì§€ ì•ŠìŒìœ¼ë¡œì¨ ë³€ê²½ ì‹œ í•œ ê³³ì—ì„œë§Œ ìˆ˜ì •í•  ìˆ˜ ìˆë‹¤.\n3NF - \u0026lt;ì´í–‰ í•¨ìˆ˜ ì¢…ì†ì„± ì œê±°\u0026gt; # ëª©ì  : ì´í–‰ì  ì¢…ì†ì„±ì„ ì œê±°í•´ ë°ì´í„°ì˜ ì¼ê´€ì„±ì„ ë†’ì´ê³ , ë°ì´í„° ì¤‘ë³µì„ ì¤„ì¸ë‹¤. ë¹„ê¸°ë³¸ í‚¤ ì†ì„±ì´ ë‹¤ë¥¸ ë¹„ê¸°ë³¸ í‚¤ ì†ì„±ì— ì˜ì¡´í•˜ì§€ ì•Šë„ë¡ í•œë‹¤. ì¡°ê±´ 2NFë¥¼ ë§Œì¡±í•œë‹¤. ë¹„ê¸°ë³¸ í‚¤ ì†ì„±ì´ ë‹¤ë¥¸ ë¹„ê¸°ë³¸ í‚¤ ì†ì„±ì— ì´í–‰ì  ì¢…ì†ì„±ì„ ê°€ì§€ë©´ ì•ˆëœë‹¤. ê³¼ëª©ID êµìˆ˜ëª… êµìˆ˜ì—°ë½ì²˜ A101 ê¹€êµìˆ˜ 010-111-222 B202 ë°•êµìˆ˜ 010-333-444 êµìˆ˜ì—°ë½ì²˜ëŠ” êµìˆ˜ëª…ì— ì¢…ì†ë˜ì–´ ìˆìœ¼ë©°, ê³¼ëª©IDë¥¼ í†µí•´ ê°„ì ‘ì ìœ¼ë¡œ ê²°ì •ëœë‹¤.\nì¦‰, ì´í–‰ì  ì¢…ì†ì´ ë°œìƒí–ˆìœ¼ë¯€ë¡œ ë‹¤ìŒê³¼ ê°™ì´ ë³€ê²½í•œë‹¤.\nê³¼ëª© Table\nê³¼ëª©ID êµìˆ˜ëª… A101 ê¹€êµìˆ˜ B202 ë°•êµìˆ˜ êµìˆ˜ Table\nêµìˆ˜ëª… êµìˆ˜ì—°ë½ì²˜ ê¹€êµìˆ˜ 010-111-222 ë°•êµìˆ˜ 010-333-444 BCNF - \u0026lt;ê²°ì •ìê°€ í›„ë³´í‚¤ê°€ ì•„ë‹Œ í•¨ìˆ˜ ì¢…ì†ì„±(FD) ì œê±°\u0026gt; # ëª©ì  : í›„ë³´ í‚¤ê°€ ì•„ë‹Œ ì†ì„±ì˜ ì˜í•´ ê²°ì •ë˜ëŠ” ë¬¸ì œë¥¼ ì œê±°í•´ ë°ì´í„° ë¬´ê²°ì„±ì„ ë³´ì¥í•œë‹¤. ì¡°ê±´ 3NFë¥¼ ë§Œì¡±í•œë‹¤. ëª¨ë“  ê²°ì •ìê°€ í›„ë³´ í‚¤ê°€ ë˜ë„ë¡ ë§Œë“ ë‹¤. ë¹„í›„ë³´ í‚¤ê°€ ê²°ì •ì ì—­í• ì„ í•˜ëŠ” ìƒí™©ì„ ë°©ì§€í•œë‹¤. ë³µí•©í‚¤ë¥¼ ì‚¬ìš©í•˜ëŠ” í…Œì´ë¸”ì—ì„œ ë°œìƒí•˜ëŠ” ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ë° í™œìš©ëœë‹¤ ê°•ì˜ID êµìˆ˜ID í•™ìƒID L101 P01 S01 L102 P02 S01 L101 P01 S02 L103 P03 S03 ê°•ì˜IDê°€ êµìˆ˜IDë¥¼ ê²°ì •í•˜ì§€ë§Œ, ê°•ì˜IDì™€ í•™ìƒIDì˜ ì¡°í•©ì´ ê¸°ë³¸ í‚¤ë¡œ ì‚¬ìš©ë˜ê³  ìˆë‹¤.\në”°ë¼ì„œ ë¹„í›„ë³´ í‚¤ì¸ ê°•ì˜IDê°€ êµìˆ˜IDë¥¼ ê²°ì •í•˜ëŠ” ì¢…ì†ì„±ì´ ë°œìƒí•´ ë‹¤ìŒê³¼ ê°™ì´ ë³€ê²½í•œë‹¤.\nê°•ì˜-êµìˆ˜ Table [ê° ê°•ì˜ì— ëŒ€í•œ ê³ ì •ëœ êµìˆ˜ ì •ë³´ë¥¼ ì €ì¥]\nê°•ì˜ID êµìˆ˜ID L101 P01 L102 P02 L103 P03 ê°•ì˜-í•™ìƒ Table [ê° í•™ìƒì´ ìˆ˜ê°•í•˜ëŠ” ê°•ì˜ ì •ë³´ë¥¼ ì €ì¥]\nê°•ì˜ID í•™ìƒID L101 S01 L101 S02 L102 S01 L103 S03 "},{"id":33,"href":"/docs/troubleshooting/kafka-one-operator-multi-kafka/","title":"í•˜ë‚˜ì˜ operatorì™€ ì—¬ëŸ¬ namespaceì˜ ì—¬ëŸ¬ kafka cluster","section":"íŠ¸ëŸ¬ë¸”ìŠˆíŒ…","content":" ìƒí™© # Strimzi Kafka Operatorë¥¼ í•˜ë‚˜ë§Œ ì„¤ì¹˜í•œ ë’¤, ì—¬ëŸ¬ namespaceì— Kafka í´ëŸ¬ìŠ¤í„°ë¥¼ ê°ê° ë°°í¬í•˜ë ¤ëŠ” êµ¬ì¡°ë¡œ ìš´ì˜í•˜ê³ ì í–ˆìŒ.\nOperatorëŠ” kafka ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ì„¤ì¹˜ë¨ ìƒˆ Kafka í´ëŸ¬ìŠ¤í„°ëŠ” kafka2 ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ë°°í¬ë¨ KafkaNodePool + Kafka CR (KRaft ëª¨ë“œ) ì‚¬ìš© Kafka UIë„ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë³„ë¡œ í•¨ê»˜ ë°°í¬ ë¬¸ì œ ì›ì¸ # KafkaNodePool ê¸°ë°˜ ë°°í¬ë¥¼ ì‹œë„í–ˆì„ ë•Œ ë‹¤ìŒê³¼ ê°™ì€ ì˜¤ë¥˜ê°€ ë°œìƒ:\nKafkaNodePoolì´ Kafka ë¦¬ì†ŒìŠ¤ì™€ ì—°ê²°ë˜ì§€ ì•ŠìŒ strimzipodsets ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ ì‹¤íŒ¨ (list/create ê¶Œí•œ ì—†ìŒ) Kafka ë° KafkaNodePoolì˜ status í•„ë“œ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨ (403 Forbidden) ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ìŒ:\nClusterRole strimzi-cluster-operator-namespacedê°€ ê¸°ë³¸ì ìœ¼ë¡œ kafka2ì˜ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ê¶Œí•œì„ ê°€ì§€ì§€ ì•ŠìŒ kafka2 ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì—ëŠ” RoleBindingë§Œ ìƒì„±ë˜ì–´ ìˆê³ , ClusterRoleì—ëŠ” í•„ìš”í•œ ë¦¬ì†ŒìŠ¤ ê¶Œí•œì´ ë¹ ì ¸ ìˆìŒ Kafkaì™€ KafkaNodePoolì˜ ì´ë¦„ ë¶ˆì¼ì¹˜ë¡œ ì—°ê²° ì‹¤íŒ¨ í•´ê²° ë°©ë²• # ë‹¤ìŒê³¼ ê°™ì€ ì¡°ì¹˜ë¥¼ í†µí•´ ë¬¸ì œë¥¼ í•´ê²°í•¨:\nKafkaNodePool.labels.strimzi.io/cluster ê°’ê³¼ Kafka.metadata.name ê°’ì„ ì¼ì¹˜ì‹œí‚´ ClusterRole(strimzi-cluster-operator-namespaced)ì— ë‹¤ìŒ ê¶Œí•œì„ ì¶”ê°€: - apiGroups: [\u0026#34;kafka.strimzi.io\u0026#34;] resources: [\u0026#34;kafkas/status\u0026#34;] verbs: [\u0026#34;update\u0026#34;] - apiGroups: [\u0026#34;kafka.strimzi.io\u0026#34;] resources: [\u0026#34;kafkanodepools/status\u0026#34;] verbs: [\u0026#34;update\u0026#34;] - apiGroups: [\u0026#34;core.strimzi.io\u0026#34;] resources: [\u0026#34;strimzipodsets\u0026#34;] verbs: [\u0026#34;get\u0026#34;, \u0026#34;list\u0026#34;, \u0026#34;watch\u0026#34;, \u0026#34;create\u0026#34;, \u0026#34;update\u0026#34;, \u0026#34;patch\u0026#34;, \u0026#34;delete\u0026#34;] kubectl patch clusterrole strimzi-cluster-operator-namespaced --type=\u0026#39;json\u0026#39; -p=\u0026#39;[ { \u0026#34;op\u0026#34;: \u0026#34;add\u0026#34;, \u0026#34;path\u0026#34;: \u0026#34;/rules/-\u0026#34;, \u0026#34;value\u0026#34;: { \u0026#34;apiGroups\u0026#34;: [\u0026#34;kafka.strimzi.io\u0026#34;], \u0026#34;resources\u0026#34;: [\u0026#34;kafkas/status\u0026#34;], \u0026#34;verbs\u0026#34;: [\u0026#34;update\u0026#34;] } }, { \u0026#34;op\u0026#34;: \u0026#34;add\u0026#34;, \u0026#34;path\u0026#34;: \u0026#34;/rules/-\u0026#34;, \u0026#34;value\u0026#34;: { \u0026#34;apiGroups\u0026#34;: [\u0026#34;kafka.strimzi.io\u0026#34;], \u0026#34;resources\u0026#34;: [\u0026#34;kafkanodepools/status\u0026#34;], \u0026#34;verbs\u0026#34;: [\u0026#34;update\u0026#34;] } }, { \u0026#34;op\u0026#34;: \u0026#34;add\u0026#34;, \u0026#34;path\u0026#34;: \u0026#34;/rules/-\u0026#34;, \u0026#34;value\u0026#34;: { \u0026#34;apiGroups\u0026#34;: [\u0026#34;core.strimzi.io\u0026#34;], \u0026#34;resources\u0026#34;: [\u0026#34;strimzipodsets\u0026#34;], \u0026#34;verbs\u0026#34;: [\u0026#34;get\u0026#34;, \u0026#34;list\u0026#34;, \u0026#34;watch\u0026#34;, \u0026#34;create\u0026#34;, \u0026#34;update\u0026#34;, \u0026#34;patch\u0026#34;, \u0026#34;delete\u0026#34;] } } ] kafka ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ strimzi-cluster-operator ì„œë¹„ìŠ¤ ê³„ì •ì´ kafka2 ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ RoleBinding êµ¬ì„±: apiVersion: rbac.authorization.k8s.io/v1 kind: RoleBinding metadata: name: strimzi-cluster-operator-binding namespace: kafka2 subjects: - kind: ServiceAccount name: strimzi-cluster-operator namespace: kafka roleRef: kind: ClusterRole name: strimzi-cluster-operator-namespaced apiGroup: rbac.authorization.k8s.io STRIMZI_NAMESPACE í™˜ê²½ë³€ìˆ˜ì— kafka2 ì¶”ê°€ kubectl set env deployment/strimzi-cluster-operator -n kafka STRIMZI_NAMESPACE=\u0026#34;kafka,kafka2\u0026#34; ìš”ì•½ëœ ìŠ¤í¬ë¦½íŠ¸ # install-kafka-on-new-ns.sh #!/bin/bash set -e # ê¸°ì¡´ Operator ë„¤ì„ìŠ¤í˜ì´ìŠ¤ OPERATOR_NS=\u0026#34;kafka\u0026#34; # ìƒˆë¡œ ë°°í¬í•  ë„¤ì„ìŠ¤í˜ì´ìŠ¤ TARGET_NS=\u0026#34;$1\u0026#34; # Kafka í´ëŸ¬ìŠ¤í„° ì´ë¦„ KAFKA_CLUSTER=\u0026#34;$2\u0026#34; # Kafka UI ì •ë³´ KAFKA_UI_DEPLOYMENT=\u0026#34;kafka-ui-${KAFKA_CLUSTER}\u0026#34; KAFKA_UI_SERVICE=\u0026#34;kafka-ui-${KAFKA_CLUSTER}\u0026#34; KAFKA_UI_PORT=30640 KAFKA_TIMEOUT=300s UI_TIMEOUT=60s if [[ -z \u0026#34;$TARGET_NS\u0026#34; || -z \u0026#34;$KAFKA_CLUSTER\u0026#34; ]]; then echo \u0026#34;[ERROR] Usage: $0 \u0026lt;target-namespace\u0026gt; \u0026lt;kafka-cluster-name\u0026gt;\u0026#34; exit 1 fi echo \u0026#34;ğŸš€ Deploying Kafka cluster \u0026#39;${KAFKA_CLUSTER}\u0026#39; in namespace \u0026#39;${TARGET_NS}\u0026#39;...\u0026#34; ### [1] ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„± ### kubectl get namespace ${TARGET_NS} \u0026gt; /dev/null 2\u0026gt;\u0026amp;1 || kubectl create namespace ${TARGET_NS} ### [2] ê¸°ì¡´ STRIMZI_NAMESPACE í™˜ê²½ë³€ìˆ˜ì— target NS ì¶”ê°€ ### CURRENT_NAMESPACES=$(kubectl get deployment strimzi-cluster-operator -n ${OPERATOR_NS} -o jsonpath=\u0026#39;{.spec.template.spec.containers[0].env[?(@.name==\u0026#34;STRIMZI_NAMESPACE\u0026#34;)].value}\u0026#39;) if [[ \u0026#34;$CURRENT_NAMESPACES\u0026#34; != *\u0026#34;$TARGET_NS\u0026#34;* ]]; then echo \u0026#34;ğŸ”§ Adding ${TARGET_NS} to STRIMZI_NAMESPACE\u0026#34; kubectl set env deployment/strimzi-cluster-operator -n ${OPERATOR_NS} STRIMZI_NAMESPACE=\u0026#34;${CURRENT_NAMESPACES},${TARGET_NS}\u0026#34; else echo \u0026#34;âœ… STRIMZI_NAMESPACE already includes ${TARGET_NS}\u0026#34; fi ### [3] ê¸°ì¡´ ClusterRoleBinding ê·œì¹™ í™•ì¸ ë° ë³µì‚¬ ì ìš© ### echo \u0026#34;ğŸ”‘ Creating RoleBindings from existing ones in ${OPERATOR_NS}\u0026#34; for role in strimzi-cluster-operator-namespaced strimzi-entity-operator strimzi-kafka-broker; do kubectl create rolebinding strimzi-${role}-binding \\ --namespace ${TARGET_NS} \\ --clusterrole ${role} \\ --serviceaccount ${OPERATOR_NS}:strimzi-cluster-operator \\ --dry-run=client -o yaml | kubectl apply -f - done ### [4] Kafka í´ëŸ¬ìŠ¤í„° ë°°í¬ ### cat \u0026lt;\u0026lt;EOF | kubectl apply -f - apiVersion: kafka.strimzi.io/v1beta2 kind: KafkaNodePool metadata: name: dual-role namespace: ${TARGET_NS} labels: strimzi.io/cluster: ${KAFKA_CLUSTER} spec: replicas: 3 roles: - controller - broker storage: type: jbod volumes: - id: 0 type: persistent-claim size: 100Gi deleteClaim: false class: nfs-client --- apiVersion: kafka.strimzi.io/v1beta2 kind: Kafka metadata: name: ${KAFKA_CLUSTER} namespace: ${TARGET_NS} annotations: strimzi.io/node-pools: enabled strimzi.io/kraft: enabled spec: kafka: version: 3.7.0 metadataVersion: 3.7-IV4 replicas: 3 listeners: - name: plain port: 9092 type: internal tls: false - name: tls port: 9093 type: internal tls: true - name: external port: 9094 type: nodeport tls: false configuration: bootstrap: nodePort: 31000 brokers: - broker: 0 nodePort: 31001 - broker: 1 nodePort: 31002 - broker: 2 nodePort: 31003 config: offsets.topic.replication.factor: 3 transaction.state.log.replication.factor: 3 transaction.state.log.min.isr: 2 default.replication.factor: 3 min.insync.replicas: 2 entityOperator: topicOperator: {} userOperator: {} kafkaExporter: groupRegex: \u0026#34;.*\u0026#34; topicRegex: \u0026#34;.*\u0026#34; EOF ### [5] Kafka ì¤€ë¹„ ëŒ€ê¸° ### echo \u0026#34;â³ Waiting for Kafka cluster to be ready...\u0026#34; kubectl wait --for=condition=ready kafka/${KAFKA_CLUSTER} -n ${TARGET_NS} --timeout=${KAFKA_TIMEOUT} || echo \u0026#34;âš ï¸ Kafka cluster wait timed out.\u0026#34; ### [6] Kafka UI ë°°í¬ ### cat \u0026lt;\u0026lt;EOF | kubectl apply -f - apiVersion: apps/v1 kind: Deployment metadata: name: ${KAFKA_UI_DEPLOYMENT} namespace: ${TARGET_NS} spec: replicas: 1 selector: matchLabels: app: ${KAFKA_UI_DEPLOYMENT} template: metadata: labels: app: ${KAFKA_UI_DEPLOYMENT} spec: containers: - name: kafka-ui image: provectuslabs/kafka-ui:latest ports: - containerPort: 8080 env: - name: KAFKA_CLUSTERS_0_NAME value: \u0026#34;${KAFKA_CLUSTER}\u0026#34; - name: KAFKA_CLUSTERS_0_BOOTSTRAPSERVERS value: \u0026#34;${KAFKA_CLUSTER}-kafka-bootstrap.${TARGET_NS}:9092\u0026#34; --- apiVersion: v1 kind: Service metadata: name: ${KAFKA_UI_SERVICE} namespace: ${TARGET_NS} spec: type: NodePort ports: - port: 80 targetPort: 8080 nodePort: ${KAFKA_UI_PORT} selector: app: ${KAFKA_UI_DEPLOYMENT} EOF ### [7] Kafka UI ì¤€ë¹„ ëŒ€ê¸° ë° ì ‘ì† ì •ë³´ ì¶œë ¥ ### kubectl wait --for=condition=ready pod -l app=${KAFKA_UI_DEPLOYMENT} -n ${TARGET_NS} --timeout=${UI_TIMEOUT} || echo \u0026#34;âš ï¸ Kafka UI wait timed out.\u0026#34; NODE_IP=$(kubectl get nodes -o jsonpath=\u0026#39;{.items[0].status.addresses[?(@.type==\u0026#34;InternalIP\u0026#34;)].address}\u0026#39;) echo \u0026#34;============================================================\u0026#34; echo \u0026#34;âœ… Kafka cluster \u0026#39;${KAFKA_CLUSTER}\u0026#39; deployed in \u0026#39;${TARGET_NS}\u0026#39;\u0026#34; echo \u0026#34;ğŸŒ Kafka UI URL: http://$NODE_IP:$KAFKA_UI_PORT\u0026#34; echo \u0026#34;============================================================\u0026#34; ìœ„ ìŠ¤í¬ë¦½íŠ¸ëŠ” ./install-kafka-on-new-ns.sh kafka-new-ns new-kafka-cluster-nameì²˜ëŸ¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.\n"}]